import{c as l,a as d,n as i,V as c,b as g,a1 as m,g as u,P as f,K as p,T as L,aB as x,t as h}from"./mapSource-aa63c091.js";const T=(o=d,t)=>{const e=new l({imgSource:o,demSource:t,lon0:90,minLevel:2,maxLevel:20});return e.rotateX(-Math.PI/2),e},F=(o,t,e=new c(110,30,0),n=new c(110,0,1e4))=>{const a=t.localToWorld(t.geo2pos(e)),s=t.localToWorld(t.geo2pos(n)),r=new i.GLViewer(o,{centerPostion:a,cameraPosition:s});return r.scene.add(t),r},M=(o,t="#load-state")=>{const e=document.querySelector(t);e&&(o.addEventListener("loading-start",n=>{e.innerHTML="Started: "+n.itemsLoaded+" of "+n.itemsTotal+" files."}),o.addEventListener("loading-progress",n=>{e.innerHTML="Loading: "+n.itemsLoaded+" of "+n.itemsTotal+" files."}),o.addEventListener("loading-complete",()=>{e.innerHTML="Loading complete!"}),o.addEventListener("loading-error",n=>{e.innerHTML="There was an error loading "+n}))},S=(o,t="#camera")=>{const e=document.querySelector(t);e&&o.controls.addEventListener("change",()=>{e.innerHTML=`摄像机:(${o.camera.position.x.toFixed(2)},
                               ${o.camera.position.y.toFixed(2)},
                               ${o.camera.position.z.toFixed(2)}) 
                           焦点:(${o.controls.target.x.toFixed(2)},
                                ${o.controls.target.y.toFixed(2)},
                                ${o.controls.target.z.toFixed(2)}) 
                          方位角:${o.controls.getAzimuthalAngle().toFixed(2)}° 
                          俯仰角:${o.controls.getPolarAngle().toFixed(2)}°`})},$=(o,t,e="#location")=>{const n=document.querySelector(e);if(n){const a=new g;o.container.addEventListener("pointermove",s=>{a.x=s.clientX/o.container.clientWidth*2-1,a.y=-(s.clientY/o.container.clientHeight)*2+1;const r=t.getLocalInfoFromScreen(o.camera,a);r?n.innerHTML=`经度:${r.location.x.toFixed(3)}°  
                            纬度:${r.location.y.toFixed(3)}°  
                            海拔:${(r.location.z*1e3).toFixed(1)}m
                            离摄像机距离:${r.distance.toFixed(3)}km `:n.innerHTML=""})}},E=(o,t="#attribution")=>{const e=document.querySelector(t);if(e){const n=()=>e.innerHTML="© "+o.attributions.join(" | © ");o.addEventListener("source-changed",n),n()}},k=o=>{o.scene.background=new m().setPath("../image/skybox/").load(["px.png","nx.png","py.png","ny.png","pz.png","nz.png"])},b=o=>{const t=new u(new f,new p({map:new L().load("../image/tile0.png",e=>e.colorSpace=x)}));t.name="background",t.material.polygonOffsetFactor=10,t.material.polygonOffsetUnits=1,t.material.polygonOffset=!0,t.renderOrder=-1,t.translateZ(-.1),t.applyMatrix4(o.rootTile.matrix),o.add(t)};function H(o,t){var n;const e=new i.FakeEarth(((n=o.scene.fog)==null?void 0:n.color)||new h(0));e.name="fakeearth",e.applyMatrix4(t.rootTile.matrix),o.controls.addEventListener("change",()=>{e.visible=o.controls.getDistance()>3e3}),t.add(e)}function z(o){o.addEventListener("update",()=>{const t=document.querySelector("#compass-plane");t&&(t.style.transform=`rotateX(${o.controls.getPolarAngle()}rad)`);const e=document.querySelector("#compass-text");e&&(e.style.transform=`rotate(${o.controls.getAzimuthalAngle()}rad)`)})}function P(o,t){function e(){const n=o.camera.near,a=o.camera.localToWorld(new c(0,0,-n)),s=t.getLocalInfoFromWorld(a);return s?t.worldToLocal(a).z-t.worldToLocal(s.point).z:10}o.controls.addEventListener("change",()=>{const n=e();if(n<.2){const a=t.localToWorld(t.up.clone()).multiplyScalar(.201-n);o.camera.position.add(a)}})}export{F as a,M as b,T as c,b as d,H as e,k as f,E as g,S as h,P as l,$ as s,z as u};
