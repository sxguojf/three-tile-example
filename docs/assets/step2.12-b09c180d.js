var xc=Object.defineProperty;var Uc=(e,t,r)=>t in e?xc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ot=(e,t,r)=>(Uc(e,typeof t!="symbol"?t+"":t,r),r);import"./modulepreload-polyfill-3cfb730f.js";import{E as Oc,v as Nc,V as W,w as Eo,s as D,F as gn,W as mo,y as Pc,c as Hc,z as Jc,H as kc,ah as qc,ai as gs,aj as Kc,ak as jc,al as po,am as We,an as yo,ao as ne,ap as Qo,aq as Vc,ar as Yc,as as Wc,at as Xc,au as zc,av as Zc,aw as $c,ax as th,ay as eh,Q as Kt,az as ye,aA as De,aB as rh,aC as sh,aD as ih,aE as nh,aF as Bn,aG as Ne,aH as Pe,aI as dn,aJ as Ti,ac as wo,aK as _i,r as Ah,aL as fn,G as Mr,b as bo,I as si,e as it,ad as Bs,f as ii,Y as Do,aa as Or,a5 as Ro,aM as oh,P as ah,d as ch,B as hh,aN as uh,aO as lh,a9 as gh,aP as Bh,aQ as Cn,aR as In,aS as dh,a8 as fh,m as Ch,a as Ih}from"./mapSource-dadc50e7.js";import{c as Eh,d as mh,b as ph,s as yh,g as Qh,h as wh,f as bh}from"./util-530f400c.js";import{M as Dh}from"./MapControls-a8d4d528.js";import{G as Rh}from"./GLTFLoader-df224738.js";import{D as Sh}from"./DRACOLoader-5ec7768c.js";class Th extends Oc{constructor(r,s={centerPostion:new W(0,0,-3e3),cameraPosition:new W(0,3e4,0)}){super();Ot(this,"scene");Ot(this,"renderer");Ot(this,"camera");Ot(this,"controls");Ot(this,"ambLight");Ot(this,"dirLight");Ot(this,"container");Ot(this,"_clock",new Nc);Ot(this,"_fogFactor",1);const i=typeof r=="string"?document.querySelector(r):r;if(i instanceof HTMLElement)this.container=i,this.renderer=this._createRenderer(),this.scene=this._createScene(),this.camera=this._createCamera(s.cameraPosition),this.controls=this._createControls(s.centerPostion),this.ambLight=this._createAmbLight(),this.scene.add(this.ambLight),this.dirLight=this._createDirLight(s.centerPostion),this.scene.add(this.dirLight),this.container.appendChild(this.renderer.domElement),window.addEventListener("resize",this.resize.bind(this)),this.resize(),this.renderer.setAnimationLoop(this.animate.bind(this));else throw`${r} not found!}`}get fogFactor(){return this._fogFactor}set fogFactor(r){this._fogFactor=r,this.controls.dispatchEvent({type:"change"})}get width(){return this.container.clientWidth}get height(){return this.container.clientHeight}_createScene(){const r=new Eo,s=14414079;return r.background=new D(s),r.fog=new gn(s,0),r}_createRenderer(){const r=new mo({antialias:!1,alpha:!0,precision:"highp"});return r.debug.checkShaderErrors=!0,r.sortObjects=!0,r.setPixelRatio(window.devicePixelRatio),r}_createCamera(r){const s=new Pc(70,1,.1,5e4);return s.position.copy(r),s}_createControls(r){const s=new Dh(this.camera,this.container);return s.target.copy(r),s.screenSpacePanning=!1,s.minDistance=.1,s.maxDistance=3e6,s.enableDamping=!0,s.keyPanSpeed=5,s.listenToKeyEvents(window),s.addEventListener("change",()=>{const i=Math.max(this.controls.getPolarAngle(),.1),n=Math.max(this.controls.getDistance(),.1);s.zoomSpeed=Math.max(Math.log(n),1.8),this.camera.far=Hc.clamp(n/i*8e3,100,5e7),this.camera.near=this.camera.far/1e5,this.camera.updateProjectionMatrix(),this.scene.fog instanceof gn&&(this.scene.fog.density=i/n*this.fogFactor*.06)}),s}_createAmbLight(){return new Jc(16777215,1)}_createDirLight(r){const s=new kc(16777215,1);return s.position.set(0,2e3,1e3),s.target.position.copy(r),s}resize(){const r=this.width,s=this.height;return this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(r,s),this.camera.aspect=r/s,this.camera.updateProjectionMatrix(),this}animate(){this.dispatchEvent({type:"update",delta:this._clock.getDelta()}),this.controls.update(),this.renderer.render(this.scene,this.camera)}}class _h{constructor(t=4){this.pool=t,this.queue=[],this.workers=[],this.workersResolve=[],this.workerStatus=0}_initWorker(t){if(!this.workers[t]){const r=this.workerCreator();r.addEventListener("message",this._onMessage.bind(this,t)),this.workers[t]=r}}_getIdleWorker(){for(let t=0;t<this.pool;t++)if(!(this.workerStatus&1<<t))return t;return-1}_onMessage(t,r){const s=this.workersResolve[t];if(s&&s(r),this.queue.length){const{resolve:i,msg:n,transfer:A}=this.queue.shift();this.workersResolve[t]=i,this.workers[t].postMessage(n,A)}else this.workerStatus^=1<<t}setWorkerCreator(t){this.workerCreator=t}setWorkerLimit(t){this.pool=t}postMessage(t,r){return new Promise(s=>{const i=this._getIdleWorker();i!==-1?(this._initWorker(i),this.workerStatus|=1<<i,this.workersResolve[i]=s,this.workers[i].postMessage(t,r)):this.queue.push({resolve:s,msg:t,transfer:r})})}dispose(){this.workers.forEach(t=>t.terminate()),this.workersResolve.length=0,this.workers.length=0,this.queue.length=0,this.workerStatus=0}}const Mh=0,En=2,Fh=1,mn=2,Gh=0,vh=1,Lh=10,xh=0,So=9,To=15,_o=16,Mo=22,Fo=37,Go=43,vo=76,Lo=83,xo=97,Uo=100,Oo=103,No=109,Po=165,Ho=166,Mi=1000066e3;let Uh=class{constructor(){this.vkFormat=0,this.typeSize=1,this.pixelWidth=0,this.pixelHeight=0,this.pixelDepth=0,this.layerCount=0,this.faceCount=1,this.supercompressionScheme=0,this.levels=[],this.dataFormatDescriptor=[{vendorId:0,descriptorType:0,descriptorBlockSize:0,versionNumber:2,colorModel:0,colorPrimaries:1,transferFunction:2,flags:0,texelBlockDimension:[0,0,0,0],bytesPlane:[0,0,0,0,0,0,0,0],samples:[]}],this.keyValue={},this.globalData=null}},Me=class{constructor(t,r,s,i){this._dataView=void 0,this._littleEndian=void 0,this._offset=void 0,this._dataView=new DataView(t.buffer,t.byteOffset+r,s),this._littleEndian=i,this._offset=0}_nextUint8(){const t=this._dataView.getUint8(this._offset);return this._offset+=1,t}_nextUint16(){const t=this._dataView.getUint16(this._offset,this._littleEndian);return this._offset+=2,t}_nextUint32(){const t=this._dataView.getUint32(this._offset,this._littleEndian);return this._offset+=4,t}_nextUint64(){const t=this._dataView.getUint32(this._offset,this._littleEndian)+4294967296*this._dataView.getUint32(this._offset+4,this._littleEndian);return this._offset+=8,t}_nextInt32(){const t=this._dataView.getInt32(this._offset,this._littleEndian);return this._offset+=4,t}_nextUint8Array(t){const r=new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+this._offset,t);return this._offset+=t,r}_skip(t){return this._offset+=t,this}_scan(t,r){r===void 0&&(r=0);const s=this._offset;let i=0;for(;this._dataView.getUint8(this._offset)!==r&&i<t;)i++,this._offset++;return i<t&&this._offset++,new Uint8Array(this._dataView.buffer,this._dataView.byteOffset+s,i)}};const gt=[171,75,84,88,32,50,48,187,13,10,26,10];function pn(e){return new TextDecoder().decode(e)}function Oh(e){const t=new Uint8Array(e.buffer,e.byteOffset,gt.length);if(t[0]!==gt[0]||t[1]!==gt[1]||t[2]!==gt[2]||t[3]!==gt[3]||t[4]!==gt[4]||t[5]!==gt[5]||t[6]!==gt[6]||t[7]!==gt[7]||t[8]!==gt[8]||t[9]!==gt[9]||t[10]!==gt[10]||t[11]!==gt[11])throw new Error("Missing KTX 2.0 identifier.");const r=new Uh,s=17*Uint32Array.BYTES_PER_ELEMENT,i=new Me(e,gt.length,s,!0);r.vkFormat=i._nextUint32(),r.typeSize=i._nextUint32(),r.pixelWidth=i._nextUint32(),r.pixelHeight=i._nextUint32(),r.pixelDepth=i._nextUint32(),r.layerCount=i._nextUint32(),r.faceCount=i._nextUint32();const n=i._nextUint32();r.supercompressionScheme=i._nextUint32();const A=i._nextUint32(),o=i._nextUint32(),a=i._nextUint32(),c=i._nextUint32(),h=i._nextUint64(),u=i._nextUint64(),g=new Me(e,gt.length+s,3*n*8,!0);for(let j=0;j<n;j++)r.levels.push({levelData:new Uint8Array(e.buffer,e.byteOffset+g._nextUint64(),g._nextUint64()),uncompressedByteLength:g._nextUint64()});const l=new Me(e,A,o,!0),B={vendorId:l._skip(4)._nextUint16(),descriptorType:l._nextUint16(),versionNumber:l._nextUint16(),descriptorBlockSize:l._nextUint16(),colorModel:l._nextUint8(),colorPrimaries:l._nextUint8(),transferFunction:l._nextUint8(),flags:l._nextUint8(),texelBlockDimension:[l._nextUint8(),l._nextUint8(),l._nextUint8(),l._nextUint8()],bytesPlane:[l._nextUint8(),l._nextUint8(),l._nextUint8(),l._nextUint8(),l._nextUint8(),l._nextUint8(),l._nextUint8(),l._nextUint8()],samples:[]},d=(B.descriptorBlockSize/4-6)/4;for(let j=0;j<d;j++){const V={bitOffset:l._nextUint16(),bitLength:l._nextUint8(),channelType:l._nextUint8(),samplePosition:[l._nextUint8(),l._nextUint8(),l._nextUint8(),l._nextUint8()],sampleLower:-1/0,sampleUpper:1/0};64&V.channelType?(V.sampleLower=l._nextInt32(),V.sampleUpper=l._nextInt32()):(V.sampleLower=l._nextUint32(),V.sampleUpper=l._nextUint32()),B.samples[j]=V}r.dataFormatDescriptor.length=0,r.dataFormatDescriptor.push(B);const C=new Me(e,a,c,!0);for(;C._offset<c;){const j=C._nextUint32(),V=C._scan(j),At=pn(V);if(r.keyValue[At]=C._nextUint8Array(j-V.byteLength-1),At.match(/^ktx/i)){const tt=pn(r.keyValue[At]);r.keyValue[At]=tt.substring(0,tt.lastIndexOf("\0"))}C._skip(j%4?4-j%4:0)}if(u<=0)return r;const m=new Me(e,h,u,!0),w=m._nextUint16(),E=m._nextUint16(),p=m._nextUint32(),R=m._nextUint32(),y=m._nextUint32(),T=m._nextUint32(),G=[];for(let j=0;j<n;j++)G.push({imageFlags:m._nextUint32(),rgbSliceByteOffset:m._nextUint32(),rgbSliceByteLength:m._nextUint32(),alphaSliceByteOffset:m._nextUint32(),alphaSliceByteLength:m._nextUint32()});const _=h+m._offset,v=_+p,N=v+R,q=N+y,K=new Uint8Array(e.buffer,e.byteOffset+_,p),L=new Uint8Array(e.buffer,e.byteOffset+v,R),$=new Uint8Array(e.buffer,e.byteOffset+N,y),ct=new Uint8Array(e.buffer,e.byteOffset+q,T);return r.globalData={endpointCount:w,selectorCount:E,imageDescs:G,endpointsData:K,selectorsData:L,tablesData:$,extendedData:ct},r}let ds,jt,ni;const fs={env:{emscripten_notify_memory_growth:function(e){ni=new Uint8Array(jt.exports.memory.buffer)}}};class Nh{init(){return ds||(ds=typeof fetch<"u"?fetch("data:application/wasm;base64,"+yn).then(t=>t.arrayBuffer()).then(t=>WebAssembly.instantiate(t,fs)).then(this._init):WebAssembly.instantiate(Buffer.from(yn,"base64"),fs).then(this._init),ds)}_init(t){jt=t.instance,fs.env.emscripten_notify_memory_growth(0)}decode(t,r=0){if(!jt)throw new Error("ZSTDDecoder: Await .init() before decoding.");const s=t.byteLength,i=jt.exports.malloc(s);ni.set(t,i),r=r||Number(jt.exports.ZSTD_findDecompressedSize(i,s));const n=jt.exports.malloc(r),A=jt.exports.ZSTD_decompress(n,r,i,s),o=ni.slice(n,n+A);return jt.exports.free(i),jt.exports.free(n),o}}const yn="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IAMNACAEQQNxBEADQCACRQ0FIAAgAkF/aiICaiIDIAEgAmotAAA6AAAgA0EDcQ0ACwsgAkEDTQ0AA0AgACACQXxqIgJqIAEgAmooAgA2AgAgAkEDSw0ACwsgAkUNAgNAIAAgAkF/aiICaiABIAJqLQAAOgAAIAINAAsMAgsgAkEDTQ0AIAIhBANAIAMgASgCADYCACABQQRqIQEgA0EEaiEDIARBfGoiBEEDSw0ACyACQQNxIQILIAJFDQADQCADIAEtAAA6AAAgA0EBaiEDIAFBAWohASACQX9qIgINAAsLIAAL8wICAn8BfgJAIAJFDQAgACACaiIDQX9qIAE6AAAgACABOgAAIAJBA0kNACADQX5qIAE6AAAgACABOgABIANBfWogAToAACAAIAE6AAIgAkEHSQ0AIANBfGogAToAACAAIAE6AAMgAkEJSQ0AIABBACAAa0EDcSIEaiIDIAFB/wFxQYGChAhsIgE2AgAgAyACIARrQXxxIgRqIgJBfGogATYCACAEQQlJDQAgAyABNgIIIAMgATYCBCACQXhqIAE2AgAgAkF0aiABNgIAIARBGUkNACADIAE2AhggAyABNgIUIAMgATYCECADIAE2AgwgAkFwaiABNgIAIAJBbGogATYCACACQWhqIAE2AgAgAkFkaiABNgIAIAQgA0EEcUEYciIEayICQSBJDQAgAa0iBUIghiAFhCEFIAMgBGohAQNAIAEgBTcDGCABIAU3AxAgASAFNwMIIAEgBTcDACABQSBqIQEgAkFgaiICQR9LDQALCyAACy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAIajYCACADCy8BAn8gACgCBCAAKAIAQQJ0aiICLQACIQMgACACLwEAIAEgAi0AAxAFajYCACADCx8AIAAgASACKAIEEAg2AgAgARAEGiAAIAJBCGo2AgQLCAAgAGdBH3MLugUBDX8jAEEQayIKJAACfyAEQQNNBEAgCkEANgIMIApBDGogAyAEEAsaIAAgASACIApBDGpBBBAVIgBBbCAAEAMbIAAgACAESxsMAQsgAEEAIAEoAgBBAXRBAmoQECENQVQgAygAACIGQQ9xIgBBCksNABogAiAAQQVqNgIAIAMgBGoiAkF8aiEMIAJBeWohDiACQXtqIRAgAEEGaiELQQQh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ASIDNgLE4AEgACgCvOABIQQgACABNgK84AEgACABIAJqNgK44AEgACABIAQgA2tqNgLA4AELpgEBAX8gACAAKALs4QEQFjYCyOABIABCADcD+OABIABCADcDuOABIABBwOABakIANwMAIABBqNAAaiIBQYyAgOAANgIAIABBADYCmOIBIABCADcDiOEBIABCAzcDgOEBIABBrNABakHgEikCADcCACAAQbTQAWpB6BIoAgA2AgAgACABNgIMIAAgAEGYIGo2AgggACAAQaAwajYCBCAAIABBEGo2AgALYQEBf0G4fyEDAkAgAUEDSQ0AIAIgABAhIgFBA3YiADYCCCACIAFBAXE2AgQgAiABQQF2QQNxIgM2AgACQCADQX9qIgFBAksNAAJAIAFBAWsOAgEAAgtBbA8LIAAhAwsgAwsMACAAIAEgAkEAEC4LiAQCA38CfiADEBYhBCAAQQBBKBAQIQAgBCACSwRAIAQPCyABRQRAQX8PCwJAAkAgA0EBRg0AIAEoAAAiBkGo6r5pRg0AQXYhAyAGQXBxQdDUtMIBRw0BQQghAyACQQhJDQEgAEEAQSgQECEAIAEoAAQhASAAQQE2AhQgACABrTcDAEEADwsgASACIAMQLyIDIAJLDQAgACADNgIYQXIhAyABIARqIgVBf2otAAAiAkEIcQ0AIAJBIHEiBkUEQEFwIQMgBS0AACIFQacBSw0BIAVBB3GtQgEgBUEDdkEKaq2GIgdCA4h+IAd8IQggBEEBaiEECyACQQZ2IQMgAkECdiEFAkAgAkEDcUF/aiICQQJLBEBBACECDAELAkACQAJAIAJBAWsOAgECAAsgASAEai0AACECIARBAWohBAwCCyABIARqLwAAIQIgBEECaiEEDAELIAEgBGooAAAhAiAEQQRqIQQLIAVBAXEhBQJ+AkACQAJAIANBf2oiA0ECTQRAIANBAWsOAgIDAQtCfyAGRQ0DGiABIARqMQAADAMLIAEgBGovAACtQoACfAwCCyABIARqKAAArQwBCyABIARqKQAACyEHIAAgBTYCICAAIAI2AhwgACAHNwMAQQAhAyAAQQA2AhQgACAHIAggBhsiBzcDCCAAIAdCgIAIIAdCgIAIVBs+AhALIAMLWwEBf0G4fyEDIAIQFiICIAFNBH8gACACakF/ai0AACIAQQNxQQJ0QaAeaigC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C0Egak8NAQsgByAHKQNoNwMQIAcgBykDYDcDCCAEIA0gB0EIaiAHQdwAaiAPIA4gESAQEB4hCwwBCyACIARqIQggBCAKEAcgAkERTwRAIARBEGohAgNAIAIgCkEQaiIKEAcgAkEQaiICIAhJDQALCyAIIAlrIQIgByATNgJcIAkgCCAOa0sEQCAJIAggEWtLBEBBbCELDAILIBAgAiAOayICaiIKIANqIBBNBEAgCCAKIAMQDxoMAgsgCCAKQQAgAmsQDyEIIAcgAiADaiIDNgJkIAggAmshCCAOIQILIAlBEE8EQCADIAhqIQMDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALDAELAkAgCUEHTQRAIAggAi0AADoAACAIIAItAAE6AAEgCCACLQACOgACIAggAi0AAzoAAyAIQQRqIAIgCUECdCIDQcAeaigCAGoiAhAXIAIgA0HgHmooAgBrIQIgBygCZCEDDAELIAggAhAMCyADQQlJDQAgAyAIaiEDIAhBCGoiCCACQQhqIgJrQQ9MBEADQCAIIAIQDCACQQhqIQIgCEEIaiIIIANJDQAMAgALAAsDQCAIIAIQByACQRBqIQIgCEEQaiIIIANJDQALCyAHQRhqEAQaIAsgDCALEAMiAhshDCAEIAQgC2ogAhshBCAFQX9qIgUNAAsgDBADDQFBbCEMIAdBGGoQBEECSQ0BQQAhCANAIAhBA0cEQCAAIAhBAnQiAmpBrNABaiACIAdqKAJENgIAIAhBAWohCAwBCwsgBygCXCEIC0G6fyEMIA8gCGsiACANIARrSw0AIAQEfyAEIAggABALIABqBUEACyABayEMCyAHQfAAaiQAIAwLkRcCFn8FfiMAQdABayIHJAAgByAAKALw4QEiCDYCvAEgASACaiESIAggACgCgOIBaiETAkACQCAFRQRAIAEhAwwBCyAAKALE4AEhESAAKALA4AEhFSAAKAK84AEhDyAAQQE2AozhAUEAIQgDQCAIQQNHBEAgByAIQQJ0IgJqIAAgAmpBrNABaigCADYCVCAIQQFqIQgMAQsLIAcgETYCZCAHIA82AmAgByABIA9rNgJoQWwhECAHQShqIAMgBBAGEAMNASAFQQQgBUEESBshFyAHQTxqIAdBKGogACgCABATIAdBxABqIAdBKGogACgCCBATIAdBzABqIAdB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IAdB0AFqJAAgEAslACAAQgA3AgAgAEEAOwEIIABBADoACyAAIAE2AgwgACACOgAKC7QFAQN/IwBBMGsiBCQAIABB/wFqIgVBfWohBgJAIAMvAQIEQCAEQRhqIAEgAhAGIgIQAw0BIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahASOgAAIAMgBEEIaiAEQRhqEBI6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0FIAEgBEEQaiAEQRhqEBI6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBSABIARBCGogBEEYahASOgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEjoAACABIAJqIABrIQIMAwsgAyAEQRBqIARBGGoQEjoAAiADIARBCGogBEEYahASOgADIANBBGohAwwAAAsACyAEQRhqIAEgAhAGIgIQAw0AIARBEGogBEEYaiADEBwgBEEIaiAEQRhqIAMQHCAAIQMDQAJAIARBGGoQBCADIAZPckUEQCADIARBEGogBEEYahAROgAAIAMgBEEIaiAEQRhqEBE6AAEgBEEYahAERQ0BIANBAmohAwsgBUF+aiEFAn8DQEG6fyECIAMiASAFSw0EIAEgBEEQaiAEQRhqEBE6AAAgAUEBaiEDIARBGGoQBEEDRgRAQQIhAiAEQQhqDAILIAMgBUsNBCABIARBCGogBEEYahAROgABIAFBAmohA0EDIQIgBEEYahAEQQNHDQALIARBEGoLIQUgAyAFIARBGGoQEToAACABIAJqIABrIQIMAgsgAyAEQRBqIARBGGoQEToAAiADIARBCGogBEEYahAROgADIANBBGohAwwAAAsACyAEQTBqJAAgAgtpAQF/An8CQAJAIAJBB00NACABKAAAQbfIwuF+Rw0AIAAgASgABDYCmOIBQWIgAEEQaiABIAIQPiIDEAMNAhogAEKBgICAEDcDiOEBIAAgASADaiACIANrECoMAQsgACABIAIQKgtBAAsLrQMBBn8jAEGAAWsiAyQAQWIhCAJAIAJBCUkNACAAQZjQAGogAUEIaiIEIAJBeGogAEGY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wOABCwutAgIEfwF+IwBBQGoiBCQAAkACQCACQQhJDQAgASgAAEFwcUHQ1LTCAUcNACABIAIQIiEBIABCADcDCCAAQQA2AgQgACABNgIADAELIARBGGogASACEC0iAxADBEAgACADEBoMAQsgAwRAIABBuH8QGgwBCyACIAQoAjAiA2shAiABIANqIQMDQAJAIAAgAyACIARBCGoQLCIFEAMEfyAFBSACIAVBA2oiBU8NAUG4fwsQGgwCCyAGQQFqIQYgAiAFayECIAMgBWohAyAEKAIMRQ0ACyAEKAI4BEAgAkEDTQRAIABBuH8QGgwCCyADQQRqIQMLIAQoAighAiAEKQMYIQcgAEEANgIEIAAgAyABazYCACAAIAIgBmytIAcgB0J/URs3AwgLIARBQGskAAslAQF/IwBBEGsiAiQAIAIgACABEFEgAigCACEAIAJBEGokACAAC30BBH8jAEGQBGsiBCQAIARB/wE2AggCQCAEQRBqIARBCGogBEEMaiABIAIQFSIGEAMEQCAGIQUMAQtBVCEFIAQoAgwiB0EGSw0AIAMgBEEQaiAEKAIIIAcQQSIFEAMNACAAIAEgBmogAiAGayADEDwhBQsgBEGQBGokACAFC4cBAgJ/An5BABAWIQMCQANAIAEgA08EQAJAIAAoAABBcHFB0NS0wgFGBEAgACABECIiAhADRQ0BQn4PCyAAIAEQVSIEQn1WDQMgBCAFfCIFIARUIQJCfiEEIAINAyAAIAEQUiICEAMNAwsgASACayEBIAAgAmohAAwBCwtCfiAFIAEbIQQLIAQLPwIBfwF+IwBBMGsiAiQAAn5CfiACQQhqIAAgARAtDQAaQgAgAigCHEEBRg0AGiACKQMICyEDIAJBMGokACADC40BAQJ/IwBBMGsiASQAAkAgAEUNACAAKAKI4gENACABIABB/OEBaigCADYCKCABIAApAvThATcDICAAEDAgACgCqOIBIQIgASABKAIoNgIYIAEgASkDIDcDECACIAFBEGoQGyAAQQA2AqjiASABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALKgECfyMAQRBrIgAkACAAQQA2AgggAEIANwMAIAAQWCEBIABBEGokACABC4cBAQN/IwBBEGsiAiQAAkAgACgCAEUgACgCBEVzDQAgAiAAKAIINgIIIAIgACkCADcDAAJ/IAIoAgAiAQRAIAIoAghBqOMJIAERBQAMAQtBqOMJECgLIgFFDQAgASAAKQIANwL04QEgAUH84QFqIAAoAgg2AgAgARBZIAEhAwsgAkEQaiQAIAMLywEBAn8jAEEgayIBJAAgAEGBgIDAADYCtOIBIABBADYCiOIBIABBADYC7OEBIABCADcDkOIBIABBADYCpOMJIABBADYC3OIBIABCADcCzOIBIABBADYCvOIBIABBADYCxOABIABCADcCnOIBIABBpOIBakIANwIAIABBrOIBakEANgIAIAFCADcCECABQgA3AhggASABKQMYNwMIIAEgASkDEDcDACABKAIIQQh2QQFxIQIgAEEANgLg4gEgACACNgKM4gEgAUEgaiQAC3YBA38jAEEwayIBJAAgAARAIAEgAEHE0AFqIgIoAgA2AiggASAAKQK80AE3AyAgACgCACEDIAEgAigCADYCGCABIAApArzQATcDECADIAFBEGoQGyABIAEoAig2AgggASABKQMgNwMAIAAgARAbCyABQTBqJAALzAEBAX8gACABKAK00AE2ApjiASAAIAEoAgQiAjYCwOABIAAgAjYCvOABIAAgAiABKAIIaiICNgK44AEgACACNgLE4AEgASgCuNABBEAgAEKBgICAEDcDiOEBIAAgAUGk0ABqNgIMIAAgAUGUIGo2AgggACABQZwwajYCBCAAIAFBDGo2AgAgAEGs0AFqIAFBqNABaigCADYCACAAQbDQAWogAUGs0AFqKAIANgIAIABBtNABaiABQbDQAWooAgA2AgAPCyAAQgA3A4jhAQs7ACACRQRAQbp/DwsgBEUEQEFsDwsgAiAEEGAEQCAAIAEgAiADIAQgBRBhDwsgACABIAIgAyAEIAUQZQtGAQF/IwBBEGsiBSQAIAVBCGogBBAOAn8gBS0ACQRAIAAgASACIAMgBBAyDAELIAAgASACIAMgBBA0CyEAIAVBEGokACAACzQAIAAgAyAEIAUQNiIFEAMEQCAFDwsgBSAESQR/IAEgAiADIAVqIAQgBWsgABA1BUG4fwsLRgEBfyMAQRBrIgUkACAFQQhqIAQQDgJ/IAUtAAkEQCAAIAEgAiADIAQQYgwBCyAAIAEgAiADIAQQNQshACAFQRBqJAAgAAtZAQF/QQ8hAiABIABJBEAgAUEE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",Ph="display-p3",Hh="display-p3-linear",Cs=new WeakMap;let Is=0,Es;class Rt extends qc{constructor(t){super(t),this.transcoderPath="",this.transcoderBinary=null,this.transcoderPending=null,this.workerPool=new _h,this.workerSourceURL="",this.workerConfig=null,typeof MSC_TRANSCODER<"u"&&console.warn('THREE.KTX2Loader: Please update to latest "basis_transcoder". "msc_basis_transcoder" is no longer supported in three.js r125+.')}setTranscoderPath(t){return this.transcoderPath=t,this}setWorkerLimit(t){return this.workerPool.setWorkerLimit(t),this}async detectSupportAsync(t){return this.workerConfig={astcSupported:await t.hasFeatureAsync("texture-compression-astc"),astcHDRSupported:!1,etc1Supported:await t.hasFeatureAsync("texture-compression-etc1"),etc2Supported:await t.hasFeatureAsync("texture-compression-etc2"),dxtSupported:await t.hasFeatureAsync("texture-compression-bc"),bptcSupported:await t.hasFeatureAsync("texture-compression-bptc"),pvrtcSupported:await t.hasFeatureAsync("texture-compression-pvrtc")},this}detectSupport(t){return t.isWebGPURenderer===!0?this.workerConfig={astcSupported:t.hasFeature("texture-compression-astc"),astcHDRSupported:!1,etc1Supported:t.hasFeature("texture-compression-etc1"),etc2Supported:t.hasFeature("texture-compression-etc2"),dxtSupported:t.hasFeature("texture-compression-bc"),bptcSupported:t.hasFeature("texture-compression-bptc"),pvrtcSupported:t.hasFeature("texture-compression-pvrtc")}:this.workerConfig={astcSupported:t.extensions.has("WEBGL_compressed_texture_astc"),astcHDRSupported:t.extensions.has("WEBGL_compressed_texture_astc")&&t.extensions.get("WEBGL_compressed_texture_astc").getSupportedProfiles().includes("hdr"),etc1Supported:t.extensions.has("WEBGL_compressed_texture_etc1"),etc2Supported:t.extensions.has("WEBGL_compressed_texture_etc"),dxtSupported:t.extensions.has("WEBGL_compressed_texture_s3tc"),bptcSupported:t.extensions.has("EXT_texture_compression_bptc"),pvrtcSupported:t.extensions.has("WEBGL_compressed_texture_pvrtc")||t.extensions.has("WEBKIT_WEBGL_compressed_texture_pvrtc")},this}init(){if(!this.transcoderPending){const t=new gs(this.manager);t.setPath(this.transcoderPath),t.setWithCredentials(this.withCredentials);const r=t.loadAsync("basis_transcoder.js"),s=new gs(this.manager);s.setPath(this.transcoderPath),s.setResponseType("arraybuffer"),s.setWithCredentials(this.withCredentials);const i=s.loadAsync("basis_transcoder.wasm");this.transcoderPending=Promise.all([r,i]).then(([n,A])=>{const o=Rt.BasisWorker.toString(),a=["/* constants */","let _EngineFormat = "+JSON.stringify(Rt.EngineFormat),"let _EngineType = "+JSON.stringify(Rt.EngineType),"let _TranscoderFormat = "+JSON.stringify(Rt.TranscoderFormat),"let _BasisFormat = "+JSON.stringify(Rt.BasisFormat),"/* basis_transcoder.js */",n,"/* worker */",o.substring(o.indexOf("{")+1,o.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([a])),this.transcoderBinary=A,this.workerPool.setWorkerCreator(()=>{const c=new Worker(this.workerSourceURL),h=this.transcoderBinary.slice(0);return c.postMessage({type:"init",config:this.workerConfig,transcoderBinary:h},[h]),c})}),Is>0&&console.warn("THREE.KTX2Loader: Multiple active KTX2 loaders may cause performance issues. Use a single KTX2Loader instance, or call .dispose() on old instances."),Is++}return this.transcoderPending}load(t,r,s,i){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");const n=new gs(this.manager);n.setResponseType("arraybuffer"),n.setWithCredentials(this.withCredentials),n.load(t,A=>{this.parse(A,r,i)},s,i)}parse(t,r,s){if(this.workerConfig===null)throw new Error("THREE.KTX2Loader: Missing initialization with `.detectSupport( renderer )`.");if(Cs.has(t))return Cs.get(t).promise.then(r).catch(s);this._createTexture(t).then(i=>r?r(i):null).catch(s)}_createTextureFrom(t,r){const{type:s,error:i,data:{faces:n,width:A,height:o,format:a,type:c,dfdFlags:h}}=t;if(s==="error")return Promise.reject(i);let u;if(r.faceCount===6)u=new Kc(n,a,c);else{const g=n[0].mipmaps;u=r.layerCount>1?new jc(g,A,o,r.layerCount,a,c):new po(g,A,o,a,c)}return u.minFilter=n[0].mipmaps.length===1?We:yo,u.magFilter=We,u.generateMipmaps=!1,u.needsUpdate=!0,u.colorSpace=Jo(r),u.premultiplyAlpha=!!(h&Fh),u}async _createTexture(t,r={}){const s=Oh(new Uint8Array(t)),i=s.vkFormat===Mi&&s.dataFormatDescriptor[0].colorModel===167;if(!(s.vkFormat===xh||i&&!this.workerConfig.astcHDRSupported))return kh(s);const A=r,o=this.init().then(()=>this.workerPool.postMessage({type:"transcode",buffer:t,taskConfig:A},[t])).then(a=>this._createTextureFrom(a.data,s));return Cs.set(t,{promise:o}),o}dispose(){return this.workerPool.dispose(),this.workerSourceURL&&URL.revokeObjectURL(this.workerSourceURL),Is--,this}}Rt.BasisFormat={ETC1S:0,UASTC:1,UASTC_HDR:2};Rt.TranscoderFormat={ETC1:0,ETC2:1,BC1:2,BC3:3,BC4:4,BC5:5,BC7_M6_OPAQUE_ONLY:6,BC7_M5:7,PVRTC1_4_RGB:8,PVRTC1_4_RGBA:9,ASTC_4x4:10,ATC_RGB:11,ATC_RGBA_INTERPOLATED_ALPHA:12,RGBA32:13,RGB565:14,BGR565:15,RGBA4444:16,BC6H:22,RGB_HALF:24,RGBA_HALF:25};Rt.EngineFormat={RGBAFormat:ne,RGBA_ASTC_4x4_Format:Qo,RGB_BPTC_UNSIGNED_Format:Vc,RGBA_BPTC_Format:Yc,RGBA_ETC2_EAC_Format:Wc,RGBA_PVRTC_4BPPV1_Format:Xc,RGBA_S3TC_DXT5_Format:zc,RGB_ETC1_Format:Zc,RGB_ETC2_Format:$c,RGB_PVRTC_4BPPV1_Format:th,RGBA_S3TC_DXT1_Format:eh};Rt.EngineType={UnsignedByteType:Kt,HalfFloatType:ye,FloatType:De};Rt.BasisWorker=function(){let e,t,r;const s=_EngineFormat,i=_EngineType,n=_TranscoderFormat,A=_BasisFormat;self.addEventListener("message",function(B){const d=B.data;switch(d.type){case"init":e=d.config,o(d.transcoderBinary);break;case"transcode":t.then(()=>{try{const{faces:C,buffers:m,width:w,height:E,hasAlpha:p,format:R,type:y,dfdFlags:T}=a(d.buffer);self.postMessage({type:"transcode",id:d.id,data:{faces:C,width:w,height:E,hasAlpha:p,format:R,type:y,dfdFlags:T}},m)}catch(C){console.error(C),self.postMessage({type:"error",id:d.id,error:C.message})}});break}});function o(B){t=new Promise(d=>{r={wasmBinary:B,onRuntimeInitialized:d},BASIS(r)}).then(()=>{r.initializeBasis(),r.KTX2File===void 0&&console.warn("THREE.KTX2Loader: Please update Basis Universal transcoder.")})}function a(B){const d=new r.KTX2File(new Uint8Array(B));function C(){d.close(),d.delete()}if(!d.isValid())throw C(),new Error("THREE.KTX2Loader:	Invalid or unsupported .ktx2 file");let m;if(d.isUASTC())m=A.UASTC;else if(d.isETC1S())m=A.ETC1S;else if(d.isHDR())m=A.UASTC_HDR;else throw new Error("THREE.KTX2Loader: Unknown Basis encoding");const w=d.getWidth(),E=d.getHeight(),p=d.getLayers()||1,R=d.getLevels(),y=d.getFaces(),T=d.getHasAlpha(),G=d.getDFDFlags(),{transcoderFormat:_,engineFormat:v,engineType:N}=u(m,w,E,T);if(!w||!E||!R)throw C(),new Error("THREE.KTX2Loader:	Invalid texture");if(!d.startTranscoding())throw C(),new Error("THREE.KTX2Loader: .startTranscoding failed");const q=[],K=[];for(let L=0;L<y;L++){const $=[];for(let ct=0;ct<R;ct++){const j=[];let V,At;for(let Bt=0;Bt<p;Bt++){const _t=d.getImageLevelInfo(ct,Bt,L);L===0&&ct===0&&Bt===0&&(_t.origWidth%4!==0||_t.origHeight%4!==0)&&console.warn("THREE.KTX2Loader: ETC1S and UASTC textures should use multiple-of-four dimensions."),R>1?(V=_t.origWidth,At=_t.origHeight):(V=_t.width,At=_t.height);let Ut=new Uint8Array(d.getImageTranscodedSizeInBytes(ct,Bt,0,_));const _e=d.transcodeImage(Ut,ct,Bt,L,_,0,-1,-1);if(N===i.HalfFloatType&&(Ut=new Uint16Array(Ut.buffer,Ut.byteOffset,Ut.byteLength/Uint16Array.BYTES_PER_ELEMENT)),!_e)throw C(),new Error("THREE.KTX2Loader: .transcodeImage failed.");j.push(Ut)}const tt=l(j);$.push({data:tt,width:V,height:At}),K.push(tt.buffer)}q.push({mipmaps:$,width:w,height:E,format:v,type:N})}return C(),{faces:q,buffers:K,width:w,height:E,hasAlpha:T,dfdFlags:G,format:v,type:N}}const c=[{if:"astcSupported",basisFormat:[A.UASTC],transcoderFormat:[n.ASTC_4x4,n.ASTC_4x4],engineFormat:[s.RGBA_ASTC_4x4_Format,s.RGBA_ASTC_4x4_Format],engineType:[i.UnsignedByteType],priorityETC1S:1/0,priorityUASTC:1,needsPowerOfTwo:!1},{if:"bptcSupported",basisFormat:[A.ETC1S,A.UASTC],transcoderFormat:[n.BC7_M5,n.BC7_M5],engineFormat:[s.RGBA_BPTC_Format,s.RGBA_BPTC_Format],engineType:[i.UnsignedByteType],priorityETC1S:3,priorityUASTC:2,needsPowerOfTwo:!1},{if:"dxtSupported",basisFormat:[A.ETC1S,A.UASTC],transcoderFormat:[n.BC1,n.BC3],engineFormat:[s.RGBA_S3TC_DXT1_Format,s.RGBA_S3TC_DXT5_Format],engineType:[i.UnsignedByteType],priorityETC1S:4,priorityUASTC:5,needsPowerOfTwo:!1},{if:"etc2Supported",basisFormat:[A.ETC1S,A.UASTC],transcoderFormat:[n.ETC1,n.ETC2],engineFormat:[s.RGB_ETC2_Format,s.RGBA_ETC2_EAC_Format],engineType:[i.UnsignedByteType],priorityETC1S:1,priorityUASTC:3,needsPowerOfTwo:!1},{if:"etc1Supported",basisFormat:[A.ETC1S,A.UASTC],transcoderFormat:[n.ETC1],engineFormat:[s.RGB_ETC1_Format],engineType:[i.UnsignedByteType],priorityETC1S:2,priorityUASTC:4,needsPowerOfTwo:!1},{if:"pvrtcSupported",basisFormat:[A.ETC1S,A.UASTC],transcoderFormat:[n.PVRTC1_4_RGB,n.PVRTC1_4_RGBA],engineFormat:[s.RGB_PVRTC_4BPPV1_Format,s.RGBA_PVRTC_4BPPV1_Format],engineType:[i.UnsignedByteType],priorityETC1S:5,priorityUASTC:6,needsPowerOfTwo:!0},{if:"bptcSupported",basisFormat:[A.UASTC_HDR],transcoderFormat:[n.BC6H],engineFormat:[s.RGB_BPTC_UNSIGNED_Format],engineType:[i.HalfFloatType],priorityHDR:1,needsPowerOfTwo:!1},{basisFormat:[A.ETC1S,A.UASTC],transcoderFormat:[n.RGBA32,n.RGBA32],engineFormat:[s.RGBAFormat,s.RGBAFormat],engineType:[i.UnsignedByteType,i.UnsignedByteType],priorityETC1S:100,priorityUASTC:100,needsPowerOfTwo:!1},{basisFormat:[A.UASTC_HDR],transcoderFormat:[n.RGBA_HALF],engineFormat:[s.RGBAFormat],engineType:[i.HalfFloatType],priorityHDR:100,needsPowerOfTwo:!1}],h={[A.ETC1S]:c.filter(B=>B.basisFormat.includes(A.ETC1S)).sort((B,d)=>B.priorityUASTC-d.priorityUASTC),[A.UASTC]:c.filter(B=>B.basisFormat.includes(A.UASTC)).sort((B,d)=>B.priorityUASTC-d.priorityUASTC),[A.UASTC_HDR]:c.filter(B=>B.basisFormat.includes(A.UASTC_HDR)).sort((B,d)=>B.priorityHDR-d.priorityHDR)};function u(B,d,C,m){const w=h[B];for(let E=0;E<w.length;E++){const p=w[E];if(p.if&&!e[p.if]||!p.basisFormat.includes(B)||m&&p.transcoderFormat.length<2||p.needsPowerOfTwo&&!(g(d)&&g(C)))continue;const R=p.transcoderFormat[m?1:0],y=p.engineFormat[m?1:0],T=p.engineType[0];return{transcoderFormat:R,engineFormat:y,engineType:T}}throw new Error("THREE.KTX2Loader: Failed to identify transcoding target.")}function g(B){return B<=2?!0:(B&B-1)===0&&B!==0}function l(B){if(B.length===1)return B[0];let d=0;for(let w=0;w<B.length;w++){const E=B[w];d+=E.byteLength}const C=new Uint8Array(d);let m=0;for(let w=0;w<B.length;w++){const E=B[w];C.set(E,m),m+=E.byteLength}return C}};const Jh=new Set([ne,Ne,Pe]),ms={[No]:ne,[xo]:ne,[Fo]:ne,[Go]:ne,[Oo]:Ne,[Lo]:Ne,[_o]:Ne,[Mo]:Ne,[Uo]:Pe,[vo]:Pe,[To]:Pe,[So]:Pe,[Mi]:Qo,[Ho]:dn,[Po]:dn},ps={[No]:De,[xo]:ye,[Fo]:Kt,[Go]:Kt,[Oo]:De,[Lo]:ye,[_o]:Kt,[Mo]:Kt,[Uo]:De,[vo]:ye,[To]:Kt,[So]:Kt,[Mi]:ye,[Ho]:Kt,[Po]:Kt};async function kh(e){const{vkFormat:t}=e;if(ms[t]===void 0)throw new Error("THREE.KTX2Loader: Unsupported vkFormat.");let r;e.supercompressionScheme===En&&(Es||(Es=new Promise(async n=>{const A=new Nh;await A.init(),n(A)})),r=await Es);const s=[];for(let n=0;n<e.levels.length;n++){const A=Math.max(1,e.pixelWidth>>n),o=Math.max(1,e.pixelHeight>>n),a=e.pixelDepth?Math.max(1,e.pixelDepth>>n):0,c=e.levels[n];let h;if(e.supercompressionScheme===Mh)h=c.levelData;else if(e.supercompressionScheme===En)h=r.decode(c.levelData,c.uncompressedByteLength);else throw new Error("THREE.KTX2Loader: Unsupported supercompressionScheme.");let u;ps[t]===De?u=new Float32Array(h.buffer,h.byteOffset,h.byteLength/Float32Array.BYTES_PER_ELEMENT):ps[t]===ye?u=new Uint16Array(h.buffer,h.byteOffset,h.byteLength/Uint16Array.BYTES_PER_ELEMENT):u=h,s.push({data:u,width:A,height:o,depth:a})}let i;if(Jh.has(ms[t]))i=e.pixelDepth===0?new rh(s[0].data,e.pixelWidth,e.pixelHeight):new sh(s[0].data,e.pixelWidth,e.pixelHeight,e.pixelDepth);else{if(e.pixelDepth>0)throw new Error("THREE.KTX2Loader: Unsupported pixelDepth.");i=new po(s,e.pixelWidth,e.pixelHeight),i.minFilter=s.length===1?We:yo,i.magFilter=We}return i.mipmaps=s,i.type=ps[t],i.format=ms[t],i.colorSpace=Jo(e),i.needsUpdate=!0,Promise.resolve(i)}function Jo(e){const t=e.dataFormatDescriptor[0];return t.colorPrimaries===vh?t.transferFunction===mn?ih:nh:t.colorPrimaries===Lh?t.transferFunction===mn?Ph:Hh:t.colorPrimaries===Gh?Bn:(console.warn(`THREE.KTX2Loader: Unsupported color primaries, "${t.colorPrimaries}"`),Bn)}var qh=Object.defineProperty,Kh=(e,t,r)=>t in e?qh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,I=(e,t,r)=>Kh(e,typeof t!="symbol"?t+"":t,r);async function ir(e,t,r,s){return s._parse(e,t,r,s)}function X(e,t){if(!e)throw new Error(t||"loader assertion failed.")}const $r=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),Qn=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);Qn&&parseFloat(Qn[1]);function jh(e,t){return ko(e||{},t)}function ko(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;if(r>3)return t;const s={...e};for(const[i,n]of Object.entries(t))n&&typeof n=="object"&&!Array.isArray(n)?s[i]=ko(s[i]||{},t[i],r+1):s[i]=t[i];return s}const Vh="latest";function Yh(){var e;return(e=globalThis._loadersgl_)!==null&&e!==void 0&&e.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.1.1"),globalThis._loadersgl_.version}const qo=Yh();function Xt(e,t){if(!e)throw new Error(t||"loaders.gl assertion failed.")}const kt=typeof process!="object"||String(process)!=="[object process]"||process.browser,Fi=typeof importScripts=="function",Wh=typeof window<"u"&&typeof window.orientation<"u",wn=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);wn&&parseFloat(wn[1]);class Xh{constructor(t,r){this.name=void 0,this.workerThread=void 0,this.isRunning=!0,this.result=void 0,this._resolve=()=>{},this._reject=()=>{},this.name=t,this.workerThread=r,this.result=new Promise((s,i)=>{this._resolve=s,this._reject=i})}postMessage(t,r){this.workerThread.postMessage({source:"loaders.gl",type:t,payload:r})}done(t){Xt(this.isRunning),this.isRunning=!1,this._resolve(t)}error(t){Xt(this.isRunning),this.isRunning=!1,this._reject(t)}}class ys{terminate(){}}const Qs=new Map;function zh(e){Xt(e.source&&!e.url||!e.source&&e.url);let t=Qs.get(e.source||e.url);return t||(e.url&&(t=Zh(e.url),Qs.set(e.url,t)),e.source&&(t=Ko(e.source),Qs.set(e.source,t))),Xt(t),t}function Zh(e){if(!e.startsWith("http"))return e;const t=$h(e);return Ko(t)}function Ko(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}function $h(e){return`try {
  importScripts('${e}');
} catch (error) {
  console.error(error);
  throw error;
}`}function jo(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,r=arguments.length>2?arguments[2]:void 0;const s=r||new Set;if(e){if(bn(e))s.add(e);else if(bn(e.buffer))s.add(e.buffer);else if(!ArrayBuffer.isView(e)&&t&&typeof e=="object")for(const i in e)jo(e[i],t,s)}return r===void 0?Array.from(s):[]}function bn(e){return e?e instanceof ArrayBuffer||typeof MessagePort<"u"&&e instanceof MessagePort||typeof ImageBitmap<"u"&&e instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas:!1}const ws=()=>{};class Ai{static isSupported(){return typeof Worker<"u"&&kt||typeof ys<"u"&&!kt}constructor(t){this.name=void 0,this.source=void 0,this.url=void 0,this.terminated=!1,this.worker=void 0,this.onMessage=void 0,this.onError=void 0,this._loadableURL="";const{name:r,source:s,url:i}=t;Xt(s||i),this.name=r,this.source=s,this.url=i,this.onMessage=ws,this.onError=n=>console.log(n),this.worker=kt?this._createBrowserWorker():this._createNodeWorker()}destroy(){this.onMessage=ws,this.onError=ws,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(t,r){r=r||jo(t),this.worker.postMessage(t,r)}_getErrorFromErrorEvent(t){let r="Failed to load ";return r+=`worker ${this.name} from ${this.url}. `,t.message&&(r+=`${t.message} in `),t.lineno&&(r+=`:${t.lineno}:${t.colno}`),new Error(r)}_createBrowserWorker(){this._loadableURL=zh({source:this.source,url:this.url});const t=new Worker(this._loadableURL,{name:this.name});return t.onmessage=r=>{r.data?this.onMessage(r.data):this.onError(new Error("No data received"))},t.onerror=r=>{this.onError(this._getErrorFromErrorEvent(r)),this.terminated=!0},t.onmessageerror=r=>console.error(r),t}_createNodeWorker(){let t;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;t=new ys(r,{eval:!1})}else if(this.source)t=new ys(this.source,{eval:!0});else throw new Error("no worker");return t.on("message",r=>{this.onMessage(r)}),t.on("error",r=>{this.onError(r)}),t.on("exit",r=>{}),t}}class tu{static isSupported(){return Ai.isSupported()}constructor(t){this.name="unnamed",this.source=void 0,this.url=void 0,this.maxConcurrency=1,this.maxMobileConcurrency=1,this.onDebug=()=>{},this.reuseWorkers=!0,this.props={},this.jobQueue=[],this.idleQueue=[],this.count=0,this.isDestroyed=!1,this.source=t.source,this.url=t.url,this.setProps(t)}destroy(){this.idleQueue.forEach(t=>t.destroy()),this.isDestroyed=!0}setProps(t){this.props={...this.props,...t},t.name!==void 0&&(this.name=t.name),t.maxConcurrency!==void 0&&(this.maxConcurrency=t.maxConcurrency),t.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=t.maxMobileConcurrency),t.reuseWorkers!==void 0&&(this.reuseWorkers=t.reuseWorkers),t.onDebug!==void 0&&(this.onDebug=t.onDebug)}async startJob(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:(n,A,o)=>n.done(o),s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:(n,A)=>n.error(A);const i=new Promise(n=>(this.jobQueue.push({name:t,onMessage:r,onError:s,onStart:n}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const t=this._getAvailableWorker();if(!t)return;const r=this.jobQueue.shift();if(r){this.onDebug({message:"Starting job",name:r.name,workerThread:t,backlog:this.jobQueue.length});const s=new Xh(r.name,t);t.onMessage=i=>r.onMessage(s,i.type,i.payload),t.onError=i=>r.onError(s,i),r.onStart(s);try{await s.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(t)}}}returnWorkerToQueue(t){!kt||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(t.destroy(),this.count--):this.idleQueue.push(t),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const t=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Ai({name:t,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return Wh?this.maxMobileConcurrency:this.maxConcurrency}}const eu={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}};class Vt{static isSupported(){return Ai.isSupported()}static getWorkerFarm(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Vt._workerFarm=Vt._workerFarm||new Vt({}),Vt._workerFarm.setProps(t),Vt._workerFarm}constructor(t){this.props=void 0,this.workerPools=new Map,this.props={...eu},this.setProps(t),this.workerPools=new Map}destroy(){for(const t of this.workerPools.values())t.destroy();this.workerPools=new Map}setProps(t){this.props={...this.props,...t};for(const r of this.workerPools.values())r.setProps(this._getWorkerPoolProps())}getWorkerPool(t){const{name:r,source:s,url:i}=t;let n=this.workerPools.get(r);return n||(n=new tu({name:r,source:s,url:i}),n.setProps(this._getWorkerPoolProps()),this.workerPools.set(r,n)),n}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}}Vt._workerFarm=void 0;function ru(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=t[e.id]||{},s=kt?`${e.id}-worker.js`:`${e.id}-worker-node.js`;let i=r.workerUrl;if(!i&&e.id==="compression"&&(i=t.workerUrl),t._workerType==="test"&&(kt?i=`modules/${e.module}/dist/${s}`:i=`modules/${e.module}/src/workers/${e.id}-worker-node.ts`),!i){let n=e.version;n==="latest"&&(n=Vh);const A=n?`@${n}`:"";i=`https://unpkg.com/@loaders.gl/${e.module}${A}/dist/${s}`}return Xt(i),i}function su(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:qo;Xt(e,"no worker provided");const r=e.version;return!(!t||!r)}const iu={},nu=Object.freeze(Object.defineProperty({__proto__:null,default:iu},Symbol.toStringTag,{value:"Module"})),bs={};async function ae(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;return t&&(e=Au(e,t,r,s)),bs[e]=bs[e]||ou(e),await bs[e]}function Au(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!r.useLocalLibraries&&e.startsWith("http"))return e;s=s||e;const i=r.modules||{};return i[s]?i[s]:kt?r.CDN?(Xt(r.CDN.startsWith("http")),`${r.CDN}/${t}@${qo}/dist/libs/${s}`):Fi?`../src/libs/${s}`:`modules/${t}/src/libs/${s}`:`modules/${t}/dist/libs/${s}`}async function ou(e){if(e.endsWith("wasm"))return await cu(e);if(!kt)try{return nu&&void 0}catch(r){return console.error(r),null}if(Fi)return importScripts(e);const t=await hu(e);return au(t,e)}function au(e,t){if(!kt)return;if(Fi)return eval.call(globalThis,e),null;const r=document.createElement("script");r.id=t;try{r.appendChild(document.createTextNode(e))}catch{r.text=e}return document.body.appendChild(r),null}async function cu(e){return await(await fetch(e)).arrayBuffer()}async function hu(e){return await(await fetch(e)).text()}function uu(e,t){return!Vt.isSupported()||!kt&&!(t!=null&&t._nodeWorkers)?!1:e.worker&&(t==null?void 0:t.worker)}async function lu(e,t,r,s,i){const n=e.id,A=ru(e,r),o=Vt.getWorkerFarm(r).getWorkerPool({name:n,url:A});r=JSON.parse(JSON.stringify(r)),s=JSON.parse(JSON.stringify(s||{}));const a=await o.startJob("process-on-worker",gu.bind(null,i));return a.postMessage("process",{input:t,options:r,context:s}),await(await a.result).result}async function gu(e,t,r,s){switch(r){case"done":t.done(s);break;case"error":t.error(new Error(s.error));break;case"process":const{id:i,input:n,options:A}=s;try{const o=await e(n,A);t.postMessage("done",{id:i,result:o})}catch(o){const a=o instanceof Error?o.message:"unknown error";t.postMessage("error",{id:i,error:a})}break;default:console.warn(`parse-with-worker unknown message ${r}`)}}function Bu(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof e=="string"?e.slice(0,t):ArrayBuffer.isView(e)?Dn(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?Dn(e,0,t):""}function Dn(e,t,r){if(e.byteLength<=t+r)return"";const s=new DataView(e);let i="";for(let n=0;n<r;n++)i+=String.fromCharCode(s.getUint8(t+n));return i}function du(e){try{return JSON.parse(e)}catch{throw new Error(`Failed to parse JSON from data starting with "${Bu(e)}"`)}}function fu(e,t,r){if(r=r||e.byteLength,e.byteLength<r||t.byteLength<r)return!1;const s=new Uint8Array(e),i=new Uint8Array(t);for(let n=0;n<s.length;++n)if(s[n]!==i[n])return!1;return!0}function Cu(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return Iu(t)}function Iu(e){const t=e.map(n=>n instanceof ArrayBuffer?new Uint8Array(n):n),r=t.reduce((n,A)=>n+A.byteLength,0),s=new Uint8Array(r);let i=0;for(const n of t)s.set(n,i),i+=n.byteLength;return s.buffer}function Gi(e,t,r){const s=r!==void 0?new Uint8Array(e).subarray(t,t+r):new Uint8Array(e).subarray(t);return new Uint8Array(s).buffer}function nr(e,t){return X(e>=0),X(t>0),e+(t-1)&~(t-1)}function Eu(e,t,r){let s;if(e instanceof ArrayBuffer)s=new Uint8Array(e);else{const i=e.byteOffset,n=e.byteLength;s=new Uint8Array(e.buffer||e.arrayBuffer,i,n)}return t.set(s,r),r+nr(s.byteLength,4)}async function mu(e){const t=[];for await(const r of e)t.push(r);return Cu(...t)}function Rn(){let e;if(typeof window<"u"&&window.performance)e=window.performance.now();else if(typeof process<"u"&&process.hrtime){const t=process.hrtime();e=t[0]*1e3+t[1]/1e6}else e=Date.now();return e}class Sn{constructor(t,r){this.name=void 0,this.type=void 0,this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=t,this.type=r,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(t){return this.sampleSize=t,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(t){return this._count+=t,this._samples++,this._checkSampling(),this}subtractCount(t){return this._count-=t,this._samples++,this._checkSampling(),this}addTime(t){return this._time+=t,this.lastTiming=t,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=Rn(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(Rn()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Vo{constructor(t){this.id=void 0,this.stats={},this.id=t.id,this.stats={},this._initializeStats(t.stats),Object.seal(this)}get(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"count";return this._getOrCreate({name:t,type:r})}get size(){return Object.keys(this.stats).length}reset(){for(const t of Object.values(this.stats))t.reset();return this}forEach(t){for(const r of Object.values(this.stats))t(r)}getTable(){const t={};return this.forEach(r=>{t[r.name]={time:r.time||0,count:r.count||0,average:r.getAverageTime()||0,hz:r.getHz()||0}}),t}_initializeStats(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:[]).forEach(t=>this._getOrCreate(t))}_getOrCreate(t){const{name:r,type:s}=t;let i=this.stats[r];return i||(t instanceof Sn?i=t:i=new Sn(r,s),this.stats[r]=i),i}}let pu="";const Tn={};function yu(e){for(const t in Tn)if(e.startsWith(t)){const r=Tn[t];e=e.replace(t,r)}return!e.startsWith("http://")&&!e.startsWith("https://")&&(e=`${pu}${e}`),e}function Qu(e){return e&&typeof e=="object"&&e.isBuffer}function Yo(e){if(Qu(e)||e instanceof ArrayBuffer)return e;if(ArrayBuffer.isView(e))return e.byteOffset===0&&e.byteLength===e.buffer.byteLength?e.buffer:e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength);if(typeof e=="string"){const t=e;return new TextEncoder().encode(t).buffer}if(e&&typeof e=="object"&&e._toArrayBuffer)return e._toArrayBuffer();throw new Error("toArrayBuffer")}function wu(){var e;if(typeof process<"u"&&typeof process.cwd<"u")return process.cwd();const t=(e=window.location)===null||e===void 0?void 0:e.pathname;return(t==null?void 0:t.slice(0,t.lastIndexOf("/")+1))||""}function Wo(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(t+1):""}function Xo(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}function bu(){const e=[];for(let i=0;i<arguments.length;i++)e[i]=i<0||arguments.length<=i?void 0:arguments[i];let t="",r=!1,s;for(let i=e.length-1;i>=-1&&!r;i--){let n;i>=0?n=e[i]:(s===void 0&&(s=wu()),n=s),n.length!==0&&(t=`${n}/${t}`,r=n.charCodeAt(0)===He)}return t=Du(t,!r),r?`/${t}`:t.length>0?t:"."}const He=47,Ds=46;function Du(e,t){let r="",s=-1,i=0,n,A=!1;for(let o=0;o<=e.length;++o){if(o<e.length)n=e.charCodeAt(o);else{if(n===He)break;n=He}if(n===He){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(r.length<2||!A||r.charCodeAt(r.length-1)!==Ds||r.charCodeAt(r.length-2)!==Ds){if(r.length>2){const a=r.length-1;let c=a;for(;c>=0&&r.charCodeAt(c)!==He;--c);if(c!==a){r=c===-1?"":r.slice(0,c),s=o,i=0,A=!1;continue}}else if(r.length===2||r.length===1){r="",s=o,i=0,A=!1;continue}}t&&(r.length>0?r+="/..":r="..",A=!0)}else{const a=e.slice(s+1,o);r.length>0?r+=`/${a}`:r=a,A=!1}s=o,i=0}else n===Ds&&i!==-1?++i:i=-1}return r}const Ru=e=>typeof e=="boolean",ke=e=>typeof e=="function",Ar=e=>e!==null&&typeof e=="object",_n=e=>Ar(e)&&e.constructor==={}.constructor,Su=e=>!!e&&typeof e[Symbol.iterator]=="function",Tu=e=>e&&typeof e[Symbol.asyncIterator]=="function",le=e=>typeof Response<"u"&&e instanceof Response||e&&e.arrayBuffer&&e.text&&e.json,ge=e=>typeof Blob<"u"&&e instanceof Blob,_u=e=>e&&typeof e=="object"&&e.isBuffer,Mu=e=>typeof ReadableStream<"u"&&e instanceof ReadableStream||Ar(e)&&ke(e.tee)&&ke(e.cancel)&&ke(e.getReader),Fu=e=>Ar(e)&&ke(e.read)&&ke(e.pipe)&&Ru(e.readable),zo=e=>Mu(e)||Fu(e),Gu=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,vu=/^([-\w.]+\/[-\w.+]+)/;function Lu(e){const t=vu.exec(e);return t?t[1]:e}function Mn(e){const t=Gu.exec(e);return t?t[1]:""}const Zo=/\?.*/;function xu(e){const t=e.match(Zo);return t&&t[0]}function vi(e){return e.replace(Zo,"")}function ts(e){return le(e)?e.url:ge(e)?e.name||"":typeof e=="string"?e:""}function Li(e){if(le(e)){const t=e,r=t.headers.get("content-type")||"",s=vi(t.url);return Lu(r)||Mn(s)}return ge(e)?e.type||"":typeof e=="string"?Mn(e):""}function Uu(e){return le(e)?e.headers["content-length"]||-1:ge(e)?e.size:typeof e=="string"?e.length:e instanceof ArrayBuffer||ArrayBuffer.isView(e)?e.byteLength:-1}async function $o(e){if(le(e))return e;const t={},r=Uu(e);r>=0&&(t["content-length"]=String(r));const s=ts(e),i=Li(e);i&&(t["content-type"]=i);const n=await Pu(e);n&&(t["x-first-bytes"]=n),typeof e=="string"&&(e=new TextEncoder().encode(e));const A=new Response(e,{headers:t});return Object.defineProperty(A,"url",{value:s}),A}async function Ou(e){if(!e.ok){const t=await Nu(e);throw new Error(t)}}async function Nu(e){let t=`Failed to fetch resource ${e.url} (${e.status}): `;try{const r=e.headers.get("Content-Type");let s=e.statusText;r!=null&&r.includes("application/json")&&(s+=` ${await e.text()}`),t+=s,t=t.length>60?`${t.slice(0,60)}...`:t}catch{}return t}async function Pu(e){if(typeof e=="string")return`data:,${e.slice(0,5)}`;if(e instanceof Blob){const t=e.slice(0,5);return await new Promise(r=>{const s=new FileReader;s.onload=i=>{var n;return r(i==null||(n=i.target)===null||n===void 0?void 0:n.result)},s.readAsDataURL(t)})}if(e instanceof ArrayBuffer){const t=e.slice(0,5);return`data:base64,${Hu(t)}`}return null}function Hu(e){let t="";const r=new Uint8Array(e);for(let s=0;s<r.byteLength;s++)t+=String.fromCharCode(r[s]);return btoa(t)}function Ju(e){return!ku(e)&&!qu(e)}function ku(e){return e.startsWith("http:")||e.startsWith("https:")}function qu(e){return e.startsWith("data:")}async function Xe(e,t){if(typeof e=="string"){const i=yu(e);if(Ju(i)){var r;if((r=globalThis.loaders)!==null&&r!==void 0&&r.fetchNode){var s;return(s=globalThis.loaders)===null||s===void 0?void 0:s.fetchNode(i,t)}}return await fetch(i,t)}return await $o(e)}const Rs=globalThis,hr=globalThis.process||{};function Ku(e){var t,r;if(typeof window<"u"&&((t=window.process)==null?void 0:t.type)==="renderer"||typeof process<"u"&&(r=process.versions)!=null&&r.electron)return!0;const s=typeof navigator<"u"&&navigator.userAgent;return!!(s&&s.indexOf("Electron")>=0)}function xi(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||Ku()}const ta="4.0.7";function ju(e){try{const t=window[e],r="__storage_test__";return t.setItem(r,r),t.removeItem(r),t}catch{return null}}class Vu{constructor(t,r,s="sessionStorage"){this.storage=ju(s),this.id=t,this.config=r,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(t){if(Object.assign(this.config,t),this.storage){const r=JSON.stringify(this.config);this.storage.setItem(this.id,r)}}_loadConfiguration(){let t={};if(this.storage){const r=this.storage.getItem(this.id);t=r?JSON.parse(r):{}}return Object.assign(this.config,t),this}}function Yu(e){let t;return e<10?t=`${e.toFixed(2)}ms`:e<100?t=`${e.toFixed(1)}ms`:e<1e3?t=`${e.toFixed(0)}ms`:t=`${(e/1e3).toFixed(2)}s`,t}function Wu(e,t=8){const r=Math.max(t-e.length,0);return`${" ".repeat(r)}${e}`}var Nr;(function(e){e[e.BLACK=30]="BLACK",e[e.RED=31]="RED",e[e.GREEN=32]="GREEN",e[e.YELLOW=33]="YELLOW",e[e.BLUE=34]="BLUE",e[e.MAGENTA=35]="MAGENTA",e[e.CYAN=36]="CYAN",e[e.WHITE=37]="WHITE",e[e.BRIGHT_BLACK=90]="BRIGHT_BLACK",e[e.BRIGHT_RED=91]="BRIGHT_RED",e[e.BRIGHT_GREEN=92]="BRIGHT_GREEN",e[e.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",e[e.BRIGHT_BLUE=94]="BRIGHT_BLUE",e[e.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",e[e.BRIGHT_CYAN=96]="BRIGHT_CYAN",e[e.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Nr||(Nr={}));const Xu=10;function Fn(e){return typeof e!="string"?e:(e=e.toUpperCase(),Nr[e]||Nr.WHITE)}function zu(e,t,r){return!xi&&typeof e=="string"&&(t&&(e=`\x1B[${Fn(t)}m${e}\x1B[39m`),r&&(e=`\x1B[${Fn(r)+Xu}m${e}\x1B[49m`)),e}function Zu(e,t=["constructor"]){const r=Object.getPrototypeOf(e),s=Object.getOwnPropertyNames(r),i=e;for(const n of s){const A=i[n];typeof A=="function"&&(t.find(o=>n===o)||(i[n]=A.bind(e)))}}function Ui(e,t){if(!e)throw new Error("Assertion failed")}function de(){var e,t,r;let s;if(xi()&&Rs.performance)s=(t=(e=Rs==null?void 0:Rs.performance)==null?void 0:e.now)==null?void 0:t.call(e);else if("hrtime"in hr){const i=(r=hr==null?void 0:hr.hrtime)==null?void 0:r.call(hr);s=i[0]*1e3+i[1]/1e6}else s=Date.now();return s}const fe={debug:xi()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},$u={enabled:!0,level:0};function Ce(){}const Gn={},vn={once:!0};class es{constructor({id:t}={id:""}){this.VERSION=ta,this._startTs=de(),this._deltaTs=de(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=t,this.userData={},this._storage=new Vu(`__probe-${this.id}__`,$u),this.timeStamp(`${this.id} started`),Zu(this),Object.seal(this)}set level(t){this.setLevel(t)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((de()-this._startTs).toPrecision(10))}getDelta(){return Number((de()-this._deltaTs).toPrecision(10))}set priority(t){this.level=t}get priority(){return this.level}getPriority(){return this.level}enable(t=!0){return this._storage.setConfiguration({enabled:t}),this}setLevel(t){return this._storage.setConfiguration({level:t}),this}get(t){return this._storage.config[t]}set(t,r){this._storage.setConfiguration({[t]:r})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(t,r){if(!t)throw new Error(r||"Assertion failed")}warn(t){return this._getLogFunction(0,t,fe.warn,arguments,vn)}error(t){return this._getLogFunction(0,t,fe.error,arguments)}deprecated(t,r){return this.warn(`\`${t}\` is deprecated and will be removed in a later version. Use \`${r}\` instead`)}removed(t,r){return this.error(`\`${t}\` has been removed. Use \`${r}\` instead`)}probe(t,r){return this._getLogFunction(t,r,fe.log,arguments,{time:!0,once:!0})}log(t,r){return this._getLogFunction(t,r,fe.debug,arguments)}info(t,r){return this._getLogFunction(t,r,console.info,arguments)}once(t,r){return this._getLogFunction(t,r,fe.debug||fe.info,arguments,vn)}table(t,r,s){return r?this._getLogFunction(t,r,console.table||Ce,s&&[s],{tag:el(r)}):Ce}time(t,r){return this._getLogFunction(t,r,console.time?console.time:console.info)}timeEnd(t,r){return this._getLogFunction(t,r,console.timeEnd?console.timeEnd:console.info)}timeStamp(t,r){return this._getLogFunction(t,r,console.timeStamp||Ce)}group(t,r,s={collapsed:!1}){const i=Ln({logLevel:t,message:r,opts:s}),{collapsed:n}=s;return i.method=(n?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(t,r,s={}){return this.group(t,r,Object.assign({},s,{collapsed:!0}))}groupEnd(t){return this._getLogFunction(t,"",console.groupEnd||Ce)}withGroup(t,r,s){this.group(t,r)();try{s()}finally{this.groupEnd(t)()}}trace(){console.trace&&console.trace()}_shouldLog(t){return this.isEnabled()&&this.getLevel()>=ea(t)}_getLogFunction(t,r,s,i,n){if(this._shouldLog(t)){n=Ln({logLevel:t,message:r,args:i,opts:n}),s=s||n.method,Ui(s),n.total=this.getTotal(),n.delta=this.getDelta(),this._deltaTs=de();const A=n.tag||n.message;if(n.once&&A)if(!Gn[A])Gn[A]=de();else return Ce;return r=tl(this.id,n.message,n),s.bind(console,r,...n.args)}return Ce}}es.VERSION=ta;function ea(e){if(!e)return 0;let t;switch(typeof e){case"number":t=e;break;case"object":t=e.logLevel||e.priority||0;break;default:return 0}return Ui(Number.isFinite(t)&&t>=0),t}function Ln(e){const{logLevel:t,message:r}=e;e.logLevel=ea(t);const s=e.args?Array.from(e.args):[];for(;s.length&&s.shift()!==r;);switch(typeof t){case"string":case"function":r!==void 0&&s.unshift(r),e.message=t;break;case"object":Object.assign(e,t);break}typeof e.message=="function"&&(e.message=e.message());const i=typeof e.message;return Ui(i==="string"||i==="object"),Object.assign(e,{args:s},e.opts)}function tl(e,t,r){if(typeof t=="string"){const s=r.time?Wu(Yu(r.total)):"";t=r.time?`${e}: ${s}  ${t}`:`${e}: ${t}`,t=zu(t,r.color,r.background)}return t}function el(e){for(const t in e)for(const r in e[t])return r||"untitled";return"empty"}globalThis.probe={};const ra=new es({id:"@probe.gl/log"}),xn=new es({id:"loaders.gl"});class rl{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class sl{constructor(){this.console=void 0,this.console=console}log(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return this.console.log.bind(this.console,...r)}info(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return this.console.info.bind(this.console,...r)}warn(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return this.console.warn.bind(this.console,...r)}error(){for(var t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return this.console.error.bind(this.console,...r)}}const sa={fetch:null,mimeType:void 0,nothrow:!1,log:new sl,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:$r,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},il={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function ia(){globalThis.loaders=globalThis.loaders||{};const{loaders:e}=globalThis;return e._state=e._state||{},e._state}function na(){const e=ia();return e.globalOptions=e.globalOptions||{...sa},e.globalOptions}function nl(e,t,r,s){return r=r||[],r=Array.isArray(r)?r:[r],Al(e,r),al(t,e,s)}function Al(e,t){Un(e,null,sa,il,t);for(const r of t){const s=e&&e[r.id]||{},i=r.options&&r.options[r.id]||{},n=r.deprecatedOptions&&r.deprecatedOptions[r.id]||{};Un(s,r.id,i,n,t)}}function Un(e,t,r,s,i){const n=t||"Top level",A=t?`${t}.`:"";for(const o in e){const a=!t&&Ar(e[o]),c=o==="baseUri"&&!t,h=o==="workerUrl"&&t;if(!(o in r)&&!c&&!h){if(o in s)xn.warn(`${n} loader option '${A}${o}' no longer supported, use '${s[o]}'`)();else if(!a){const u=ol(o,i);xn.warn(`${n} loader option '${A}${o}' not recognized. ${u}`)()}}}}function ol(e,t){const r=e.toLowerCase();let s="";for(const i of t)for(const n in i.options){if(e===n)return`Did you mean '${i.id}.${n}'?`;const A=n.toLowerCase();(r.startsWith(A)||A.startsWith(r))&&(s=s||`Did you mean '${i.id}.${n}'?`)}return s}function al(e,t,r){const s={...e.options||{}};return cl(s,r),s.log===null&&(s.log=new rl),On(s,na()),On(s,t),s}function On(e,t){for(const r in t)if(r in t){const s=t[r];_n(s)&&_n(e[r])?e[r]={...e[r],...t[r]}:e[r]=t[r]}}function cl(e,t){t&&!("baseUri"in e)&&(e.baseUri=t)}function Oi(e){var t;return e?(Array.isArray(e)&&(e=e[0]),Array.isArray((t=e)===null||t===void 0?void 0:t.extensions)):!1}function Aa(e){var t,r;X(e,"null loader"),X(Oi(e),"invalid loader");let s;return Array.isArray(e)&&(s=e[1],e=e[0],e={...e,options:{...e.options,...s}}),((t=e)!==null&&t!==void 0&&t.parseTextSync||(r=e)!==null&&r!==void 0&&r.parseText)&&(e.text=!0),e.text||(e.binary=!0),e}const hl=()=>{const e=ia();return e.loaderRegistry=e.loaderRegistry||[],e.loaderRegistry};function ul(){return hl()}const ll=new es({id:"loaders.gl"}),gl=/\.([^.]+)$/;async function Bl(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(!oa(e))return null;let i=Nn(e,t,{...r,nothrow:!0},s);if(i)return i;if(ge(e)&&(e=await e.slice(0,10).arrayBuffer(),i=Nn(e,t,r,s)),!i&&!(r!=null&&r.nothrow))throw new Error(aa(e));return i}function Nn(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0;if(!oa(e))return null;if(t&&!Array.isArray(t))return Aa(t);let i=[];t&&(i=i.concat(t)),r!=null&&r.ignoreRegisteredLoaders||i.push(...ul()),fl(i);const n=dl(e,i,r,s);if(!n&&!(r!=null&&r.nothrow))throw new Error(aa(e));return n}function dl(e,t,r,s){const i=ts(e),n=Li(e),A=vi(i)||(s==null?void 0:s.url);let o=null,a="";if(r!=null&&r.mimeType&&(o=Ss(t,r==null?void 0:r.mimeType),a=`match forced by supplied MIME type ${r==null?void 0:r.mimeType}`),o=o||Cl(t,A),a=a||(o?`matched url ${A}`:""),o=o||Ss(t,n),a=a||(o?`matched MIME type ${n}`:""),o=o||El(t,e),a=a||(o?`matched initial data ${ca(e)}`:""),r!=null&&r.fallbackMimeType&&(o=o||Ss(t,r==null?void 0:r.fallbackMimeType),a=a||(o?`matched fallback MIME type ${n}`:"")),a){var c;ll.log(1,`selectLoader selected ${(c=o)===null||c===void 0?void 0:c.name}: ${a}.`)}return o}function oa(e){return!(e instanceof Response&&e.status===204)}function aa(e){const t=ts(e),r=Li(e);let s="No valid loader found (";s+=t?`${Wo(t)}, `:"no url provided, ",s+=`MIME type: ${r?`"${r}"`:"not provided"}, `;const i=e?ca(e):"";return s+=i?` first bytes: "${i}"`:"first bytes: not available",s+=")",s}function fl(e){for(const t of e)Aa(t)}function Cl(e,t){const r=t&&gl.exec(t),s=r&&r[1];return s?Il(e,s):null}function Il(e,t){t=t.toLowerCase();for(const r of e)for(const s of r.extensions)if(s.toLowerCase()===t)return r;return null}function Ss(e,t){for(const r of e)if(r.mimeTypes&&r.mimeTypes.includes(t)||t===`application/x.${r.id}`)return r;return null}function El(e,t){if(!t)return null;for(const r of e)if(typeof t=="string"){if(ml(t,r))return r}else if(ArrayBuffer.isView(t)){if(Pn(t.buffer,t.byteOffset,r))return r}else if(t instanceof ArrayBuffer&&Pn(t,0,r))return r;return null}function ml(e,t){return t.testText?t.testText(e):(Array.isArray(t.tests)?t.tests:[t.tests]).some(r=>e.startsWith(r))}function Pn(e,t,r){return(Array.isArray(r.tests)?r.tests:[r.tests]).some(s=>pl(e,t,r,s))}function pl(e,t,r,s){if(s instanceof ArrayBuffer)return fu(s,e,s.byteLength);switch(typeof s){case"function":return s(e);case"string":const i=oi(e,t,s.length);return s===i;default:return!1}}function ca(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:5;return typeof e=="string"?e.slice(0,t):ArrayBuffer.isView(e)?oi(e.buffer,e.byteOffset,t):e instanceof ArrayBuffer?oi(e,0,t):""}function oi(e,t,r){if(e.byteLength<t+r)return"";const s=new DataView(e);let i="";for(let n=0;n<r;n++)i+=String.fromCharCode(s.getUint8(t+n));return i}const yl=256*1024;function*Ql(e,t){const r=(t==null?void 0:t.chunkSize)||yl;let s=0;const i=new TextEncoder;for(;s<e.length;){const n=Math.min(e.length-s,r),A=e.slice(s,s+n);s+=n,yield i.encode(A)}}const wl=256*1024;function bl(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return function*(){const{chunkSize:r=wl}=t;let s=0;for(;s<e.byteLength;){const i=Math.min(e.byteLength-s,r),n=new ArrayBuffer(i),A=new Uint8Array(e,s,i);new Uint8Array(n).set(A),s+=i,yield n}}()}const Dl=1024*1024;async function*Rl(e,t){const r=(t==null?void 0:t.chunkSize)||Dl;let s=0;for(;s<e.size;){const i=s+r,n=await e.slice(s,i).arrayBuffer();s=i,yield n}}function Hn(e,t){return $r?Sl(e,t):Tl(e)}async function*Sl(e,t){const r=e.getReader();let s;try{for(;;){const i=s||r.read();t!=null&&t._streamReadAhead&&(s=r.read());const{done:n,value:A}=await i;if(n)return;yield Yo(A)}}catch{r.releaseLock()}}async function*Tl(e,t){for await(const r of e)yield Yo(r)}function _l(e,t){if(typeof e=="string")return Ql(e,t);if(e instanceof ArrayBuffer)return bl(e,t);if(ge(e))return Rl(e,t);if(zo(e))return Hn(e,t);if(le(e))return Hn(e.body,t);throw new Error("makeIterator")}const ha="Cannot convert supplied data type";function Ml(e,t,r){if(t.text&&typeof e=="string")return e;if(_u(e)&&(e=e.buffer),e instanceof ArrayBuffer){const s=e;return t.text&&!t.binary?new TextDecoder("utf8").decode(s):s}if(ArrayBuffer.isView(e)){if(t.text&&!t.binary)return new TextDecoder("utf8").decode(e);let s=e.buffer;const i=e.byteLength||e.length;return(e.byteOffset!==0||i!==s.byteLength)&&(s=s.slice(e.byteOffset,e.byteOffset+i)),s}throw new Error(ha)}async function Fl(e,t,r){const s=e instanceof ArrayBuffer||ArrayBuffer.isView(e);if(typeof e=="string"||s)return Ml(e,t);if(ge(e)&&(e=await $o(e)),le(e)){const i=e;return await Ou(i),t.binary?await i.arrayBuffer():await i.text()}if(zo(e)&&(e=_l(e,r)),Su(e)||Tu(e))return mu(e);throw new Error(ha)}function ua(e,t){const r=na(),s=e||r;return typeof s.fetch=="function"?s.fetch:Ar(s.fetch)?i=>Xe(i,s.fetch):t!=null&&t.fetch?t==null?void 0:t.fetch:Xe}function Gl(e,t,r){if(r)return r;const s={fetch:ua(t,e),...e};if(s.url){const i=vi(s.url);s.baseUrl=i,s.queryString=xu(s.url),s.filename=Wo(i),s.baseUrl=Xo(i)}return Array.isArray(s.loaders)||(s.loaders=null),s}function vl(e,t){if(e&&!Array.isArray(e))return e;let r;if(e&&(r=Array.isArray(e)?e:[e]),t&&t.loaders){const s=Array.isArray(t.loaders)?t.loaders:[t.loaders];r=r?[...r,...s]:s}return r&&r.length?r:void 0}async function Pr(e,t,r,s){t&&!Array.isArray(t)&&!Oi(t)&&(s=void 0,r=t,t=void 0),e=await e,r=r||{};const i=ts(e),n=vl(t,s),A=await Bl(e,n,r);return A?(r=nl(r,A,n,i),s=Gl({url:i,_parse:Pr,loaders:n},r,s||null),await Ll(A,e,r,s)):null}async function Ll(e,t,r,s){if(su(e),r=jh(e.options,r),le(t)){const n=t,{ok:A,redirected:o,status:a,statusText:c,type:h,url:u}=n,g=Object.fromEntries(n.headers.entries());s.response={headers:g,ok:A,redirected:o,status:a,statusText:c,type:h,url:u}}t=await Fl(t,e,r);const i=e;if(i.parseTextSync&&typeof t=="string")return i.parseTextSync(t,r,s);if(uu(e,r))return await lu(e,t,r,s,Pr);if(i.parseText&&typeof t=="string")return await i.parseText(t,r,s);if(i.parse)return await i.parse(t,r,s);throw Xt(!i.parseSync),new Error(`${e.id} loader - no parser found and worker is disabled`)}function xl(e){switch(e.constructor){case Int8Array:return"int8";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int16Array:return"int16";case Uint16Array:return"uint16";case Int32Array:return"int32";case Uint32Array:return"uint32";case Float32Array:return"float32";case Float64Array:return"float64";default:return"null"}}function Ul(e){let t=1/0,r=1/0,s=1/0,i=-1/0,n=-1/0,A=-1/0;const o=e.POSITION?e.POSITION.value:[],a=o&&o.length;for(let c=0;c<a;c+=3){const h=o[c],u=o[c+1],g=o[c+2];t=h<t?h:t,r=u<r?u:r,s=g<s?g:s,i=h>i?h:i,n=u>n?u:n,A=g>A?g:A}return[[t,r,s],[i,n,A]]}function Ol(e,t,r){const s=xl(t.value),i=r||Nl(t);return{name:e,type:{type:"fixed-size-list",listSize:t.size,children:[{name:"value",type:s}]},nullable:!1,metadata:i}}function Nl(e){const t={};return"byteOffset"in e&&(t.byteOffset=e.byteOffset.toString(10)),"byteStride"in e&&(t.byteStride=e.byteStride.toString(10)),"normalized"in e&&(t.normalized=e.normalized.toString()),t}async function Re(e,t,r,s){let i,n;!Array.isArray(t)&&!Oi(t)?(i=[],n=t):(i=t,n=r);const A=ua(n);let o=e;return typeof e=="string"&&(o=await A(e)),ge(e)&&(o=await A(e)),Array.isArray(i)?await Pr(o,i,n):await Pr(o,i,n)}const Pl=1/Math.PI*180,Hl=1/180*Math.PI,Jl={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...Jl}};const nt=globalThis.mathgl.config;function kl(e,{precision:t=nt.precision}={}){return e=Yl(e),"".concat(parseFloat(e.toPrecision(t)))}function he(e){return Array.isArray(e)||ArrayBuffer.isView(e)&&!(e instanceof DataView)}function ql(e){return jl(e)}function Kl(e){return Ft(e)}function jl(e,t){return Ni(e,r=>r*Hl,t)}function Ft(e,t){return Ni(e,r=>r*Pl,t)}function Vl(e,t,r){return Ni(e,s=>Math.max(t,Math.min(r,s)))}function ee(e,t,r){const s=nt.EPSILON;r&&(nt.EPSILON=r);try{if(e===t)return!0;if(he(e)&&he(t)){if(e.length!==t.length)return!1;for(let i=0;i<e.length;++i)if(!ee(e[i],t[i]))return!1;return!0}return e&&e.equals?e.equals(t):t&&t.equals?t.equals(e):typeof e=="number"&&typeof t=="number"?Math.abs(e-t)<=nt.EPSILON*Math.max(1,Math.abs(e),Math.abs(t)):!1}finally{nt.EPSILON=s}}function Yl(e){return Math.round(e/nt.EPSILON)*nt.EPSILON}function Wl(e){return e.clone?e.clone():new Array(e.length)}function Ni(e,t,r){if(he(e)){const s=e;r=r||Wl(s);for(let i=0;i<r.length&&i<s.length;++i){const n=typeof e=="number"?e:e[i];r[i]=t(n,i,r)}return r}return t(e)}function Xl(e){function t(){var r=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(r,Object.getPrototypeOf(this)),r}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}class Pi extends Xl(Array){clone(){return new this.constructor().copy(this)}fromArray(t,r=0){for(let s=0;s<this.ELEMENTS;++s)this[s]=t[s+r];return this.check()}toArray(t=[],r=0){for(let s=0;s<this.ELEMENTS;++s)t[r+s]=this[s];return t}toObject(t){return t}from(t){return Array.isArray(t)?this.copy(t):this.fromObject(t)}to(t){return t===this?this:he(t)?this.toArray(t):this.toObject(t)}toTarget(t){return t?this.to(t):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(nt)}formatString(t){let r="";for(let s=0;s<this.ELEMENTS;++s)r+=(s>0?", ":"")+kl(this[s],t);return"".concat(t.printTypes?this.constructor.name:"","[").concat(r,"]")}equals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(!ee(this[r],t[r]))return!1;return!0}exactEquals(t){if(!t||this.length!==t.length)return!1;for(let r=0;r<this.ELEMENTS;++r)if(this[r]!==t[r])return!1;return!0}negate(){for(let t=0;t<this.ELEMENTS;++t)this[t]=-this[t];return this.check()}lerp(t,r,s){if(s===void 0)return this.lerp(this,t,r);for(let i=0;i<this.ELEMENTS;++i){const n=t[i],A=typeof r=="number"?r:r[i];this[i]=n+s*(A-n)}return this.check()}min(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(t[r],this[r]);return this.check()}max(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.max(t[r],this[r]);return this.check()}clamp(t,r){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t[s]),r[s]);return this.check()}add(...t){for(const r of t)for(let s=0;s<this.ELEMENTS;++s)this[s]+=r[s];return this.check()}subtract(...t){for(const r of t)for(let s=0;s<this.ELEMENTS;++s)this[s]-=r[s];return this.check()}scale(t){if(typeof t=="number")for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;else for(let r=0;r<this.ELEMENTS&&r<t.length;++r)this[r]*=t[r];return this.check()}multiplyByScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}check(){if(nt.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let t=this.length===this.ELEMENTS;for(let r=0;r<this.ELEMENTS;++r)t=t&&Number.isFinite(this[r]);return t}sub(t){return this.subtract(t)}setScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]=t;return this.check()}addScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]+=t;return this.check()}subScalar(t){return this.addScalar(-t)}multiplyScalar(t){for(let r=0;r<this.ELEMENTS;++r)this[r]*=t;return this.check()}divideScalar(t){return this.multiplyByScalar(1/t)}clampScalar(t,r){for(let s=0;s<this.ELEMENTS;++s)this[s]=Math.min(Math.max(this[s],t),r);return this.check()}get elements(){return this}}function zl(e,t){if(e.length!==t)return!1;for(let r=0;r<e.length;++r)if(!Number.isFinite(e[r]))return!1;return!0}function P(e){if(!Number.isFinite(e))throw new Error("Invalid number ".concat(JSON.stringify(e)));return e}function qe(e,t,r=""){if(nt.debug&&!zl(e,t))throw new Error("math.gl: ".concat(r," some fields set to invalid numbers'"));return e}function Y(e,t){if(!e)throw new Error("math.gl assertion ".concat(t))}class Hi extends Pi{get x(){return this[0]}set x(t){this[0]=P(t)}get y(){return this[1]}set y(t){this[1]=P(t)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*this[r];return t}magnitudeSquared(){return this.lengthSquared()}distance(t){return Math.sqrt(this.distanceSquared(t))}distanceSquared(t){let r=0;for(let s=0;s<this.ELEMENTS;++s){const i=this[s]-t[s];r+=i*i}return P(r)}dot(t){let r=0;for(let s=0;s<this.ELEMENTS;++s)r+=this[s]*t[s];return P(r)}normalize(){const t=this.magnitude();if(t!==0)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t;return this.check()}multiply(...t){for(const r of t)for(let s=0;s<this.ELEMENTS;++s)this[s]*=r[s];return this.check()}divide(...t){for(const r of t)for(let s=0;s<this.ELEMENTS;++s)this[s]/=r[s];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(t){return this.distance(t)}distanceToSquared(t){return this.distanceSquared(t)}getComponent(t){return Y(t>=0&&t<this.ELEMENTS,"index is out of range"),P(this[t])}setComponent(t,r){return Y(t>=0&&t<this.ELEMENTS,"index is out of range"),this[t]=r,this.check()}addVectors(t,r){return this.copy(t).add(r)}subVectors(t,r){return this.copy(t).subtract(r)}multiplyVectors(t,r){return this.copy(t).multiply(r)}addScaledVector(t,r){return this.add(new this.constructor(t).multiplyScalar(r))}}const Ke=1e-6;let Lt=typeof Float32Array<"u"?Float32Array:Array;function Zl(){const e=new Lt(2);return Lt!=Float32Array&&(e[0]=0,e[1]=0),e}function $l(e,t,r){const s=t[0],i=t[1];return e[0]=r[0]*s+r[2]*i,e[1]=r[1]*s+r[3]*i,e}function tg(e,t,r){const s=t[0],i=t[1];return e[0]=r[0]*s+r[2]*i+r[4],e[1]=r[1]*s+r[3]*i+r[5],e}function la(e,t,r){const s=t[0],i=t[1];return e[0]=r[0]*s+r[3]*i+r[6],e[1]=r[1]*s+r[4]*i+r[7],e}function ga(e,t,r){const s=t[0],i=t[1];return e[0]=r[0]*s+r[4]*i+r[12],e[1]=r[1]*s+r[5]*i+r[13],e}(function(){const e=Zl();return function(t,r,s,i,n,A){let o,a;for(r||(r=2),s||(s=0),i?a=Math.min(i*r+s,t.length):a=t.length,o=s;o<a;o+=r)e[0]=t[o],e[1]=t[o+1],n(e,e,A),t[o]=e[0],t[o+1]=e[1];return t}})();function Ba(e,t,r){const s=t[0],i=t[1],n=r[3]*s+r[7]*i||1;return e[0]=(r[0]*s+r[4]*i)/n,e[1]=(r[1]*s+r[5]*i)/n,e}function da(e,t,r){const s=t[0],i=t[1],n=t[2],A=r[3]*s+r[7]*i+r[11]*n||1;return e[0]=(r[0]*s+r[4]*i+r[8]*n)/A,e[1]=(r[1]*s+r[5]*i+r[9]*n)/A,e[2]=(r[2]*s+r[6]*i+r[10]*n)/A,e}function eg(e,t,r){const s=t[0],i=t[1];return e[0]=r[0]*s+r[2]*i,e[1]=r[1]*s+r[3]*i,e[2]=t[2],e}function rg(e,t,r){const s=t[0],i=t[1];return e[0]=r[0]*s+r[2]*i,e[1]=r[1]*s+r[3]*i,e[2]=t[2],e[3]=t[3],e}function fa(e,t,r){const s=t[0],i=t[1],n=t[2];return e[0]=r[0]*s+r[3]*i+r[6]*n,e[1]=r[1]*s+r[4]*i+r[7]*n,e[2]=r[2]*s+r[5]*i+r[8]*n,e[3]=t[3],e}class rs extends Hi{constructor(t=0,r=0){super(2),he(t)&&arguments.length===1?this.copy(t):(nt.debug&&(P(t),P(r)),this[0]=t,this[1]=r)}set(t,r){return this[0]=t,this[1]=r,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this.check()}fromObject(t){return nt.debug&&(P(t.x),P(t.y)),this[0]=t.x,this[1]=t.y,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t}get ELEMENTS(){return 2}horizontalAngle(){return Math.atan2(this.y,this.x)}verticalAngle(){return Math.atan2(this.x,this.y)}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return ga(this,this,t),this.check()}transformAsVector(t){return Ba(this,this,t),this.check()}transformByMatrix3(t){return la(this,this,t),this.check()}transformByMatrix2x3(t){return tg(this,this,t),this.check()}transformByMatrix2(t){return $l(this,this,t),this.check()}}function Ca(){const e=new Lt(3);return Lt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Ia(e){const t=e[0],r=e[1],s=e[2];return Math.sqrt(t*t+r*r+s*s)}function Jn(e,t,r){const s=new Lt(3);return s[0]=e,s[1]=t,s[2]=r,s}function sg(e,t){const r=t[0],s=t[1],i=t[2];let n=r*r+s*s+i*i;return n>0&&(n=1/Math.sqrt(n)),e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e}function Ji(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Fr(e,t,r){const s=t[0],i=t[1],n=t[2],A=r[0],o=r[1],a=r[2];return e[0]=i*a-n*o,e[1]=n*A-s*a,e[2]=s*o-i*A,e}function ki(e,t,r){const s=t[0],i=t[1],n=t[2];let A=r[3]*s+r[7]*i+r[11]*n+r[15];return A=A||1,e[0]=(r[0]*s+r[4]*i+r[8]*n+r[12])/A,e[1]=(r[1]*s+r[5]*i+r[9]*n+r[13])/A,e[2]=(r[2]*s+r[6]*i+r[10]*n+r[14])/A,e}function Ea(e,t,r){const s=t[0],i=t[1],n=t[2];return e[0]=s*r[0]+i*r[3]+n*r[6],e[1]=s*r[1]+i*r[4]+n*r[7],e[2]=s*r[2]+i*r[5]+n*r[8],e}function ma(e,t,r){const s=r[0],i=r[1],n=r[2],A=r[3],o=t[0],a=t[1],c=t[2];let h=i*c-n*a,u=n*o-s*c,g=s*a-i*o,l=i*g-n*u,B=n*h-s*g,d=s*u-i*h;const C=A*2;return h*=C,u*=C,g*=C,l*=2,B*=2,d*=2,e[0]=o+h+l,e[1]=a+u+B,e[2]=c+g+d,e}function ig(e,t,r,s){const i=[],n=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],n[0]=i[0],n[1]=i[1]*Math.cos(s)-i[2]*Math.sin(s),n[2]=i[1]*Math.sin(s)+i[2]*Math.cos(s),e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function ng(e,t,r,s){const i=[],n=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],n[0]=i[2]*Math.sin(s)+i[0]*Math.cos(s),n[1]=i[1],n[2]=i[2]*Math.cos(s)-i[0]*Math.sin(s),e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function Ag(e,t,r,s){const i=[],n=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],n[0]=i[0]*Math.cos(s)-i[1]*Math.sin(s),n[1]=i[0]*Math.sin(s)+i[1]*Math.cos(s),n[2]=i[2],e[0]=n[0]+r[0],e[1]=n[1]+r[1],e[2]=n[2]+r[2],e}function og(e,t){const r=e[0],s=e[1],i=e[2],n=t[0],A=t[1],o=t[2],a=Math.sqrt((r*r+s*s+i*i)*(n*n+A*A+o*o)),c=a&&Ji(e,t)/a;return Math.acos(Math.min(Math.max(c,-1),1))}const ag=Ia;(function(){const e=Ca();return function(t,r,s,i,n,A){let o,a;for(r||(r=3),s||(s=0),i?a=Math.min(i*r+s,t.length):a=t.length,o=s;o<a;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],n(e,e,A),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2];return t}})();const Ts=[0,0,0];let ur;class f extends Hi{static get ZERO(){return ur||(ur=new f(0,0,0),Object.freeze(ur)),ur}constructor(t=0,r=0,s=0){super(-0,-0,-0),arguments.length===1&&he(t)?this.copy(t):(nt.debug&&(P(t),P(r),P(s)),this[0]=t,this[1]=r,this[2]=s)}set(t,r,s){return this[0]=t,this[1]=r,this[2]=s,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this.check()}fromObject(t){return nt.debug&&(P(t.x),P(t.y),P(t.z)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this.check()}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t}get ELEMENTS(){return 3}get z(){return this[2]}set z(t){this[2]=P(t)}angle(t){return og(this,t)}cross(t){return Fr(this,this,t),this.check()}rotateX({radians:t,origin:r=Ts}){return ig(this,this,r,t),this.check()}rotateY({radians:t,origin:r=Ts}){return ng(this,this,r,t),this.check()}rotateZ({radians:t,origin:r=Ts}){return Ag(this,this,r,t),this.check()}transform(t){return this.transformAsPoint(t)}transformAsPoint(t){return ki(this,this,t),this.check()}transformAsVector(t){return da(this,this,t),this.check()}transformByMatrix3(t){return Ea(this,this,t),this.check()}transformByMatrix2(t){return eg(this,this,t),this.check()}transformByQuaternion(t){return ma(this,this,t),this.check()}}let lr;class qi extends Hi{static get ZERO(){return lr||(lr=new qi(0,0,0,0),Object.freeze(lr)),lr}constructor(t=0,r=0,s=0,i=0){super(-0,-0,-0,-0),he(t)&&arguments.length===1?this.copy(t):(nt.debug&&(P(t),P(r),P(s),P(i)),this[0]=t,this[1]=r,this[2]=s,this[3]=i)}set(t,r,s,i){return this[0]=t,this[1]=r,this[2]=s,this[3]=i,this.check()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}fromObject(t){return nt.debug&&(P(t.x),P(t.y),P(t.z),P(t.w)),this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this}toObject(t){return t.x=this[0],t.y=this[1],t.z=this[2],t.w=this[3],t}get ELEMENTS(){return 4}get z(){return this[2]}set z(t){this[2]=P(t)}get w(){return this[3]}set w(t){this[3]=P(t)}transform(t){return ki(this,this,t),this.check()}transformByMatrix3(t){return fa(this,this,t),this.check()}transformByMatrix2(t){return rg(this,this,t),this.check()}transformByQuaternion(t){return ma(this,this,t),this.check()}applyMatrix4(t){return t.transform(this,this),this}}class pa extends Pi{toString(){let t="[";if(nt.printRowMajor){t+="row-major:";for(let r=0;r<this.RANK;++r)for(let s=0;s<this.RANK;++s)t+=" ".concat(this[s*this.RANK+r])}else{t+="column-major:";for(let r=0;r<this.ELEMENTS;++r)t+=" ".concat(this[r])}return t+="]",t}getElementIndex(t,r){return r*this.RANK+t}getElement(t,r){return this[r*this.RANK+t]}setElement(t,r,s){return this[r*this.RANK+t]=P(s),this}getColumn(t,r=new Array(this.RANK).fill(-0)){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)r[i]=this[s+i];return r}setColumn(t,r){const s=t*this.RANK;for(let i=0;i<this.RANK;++i)this[s+i]=r[i];return this}}function cg(){const e=new Lt(9);return Lt!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function hg(e,t){if(e===t){const r=t[1],s=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=s,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function ug(e,t){const r=t[0],s=t[1],i=t[2],n=t[3],A=t[4],o=t[5],a=t[6],c=t[7],h=t[8],u=h*A-o*c,g=-h*n+o*a,l=c*n-A*a;let B=r*u+s*g+i*l;return B?(B=1/B,e[0]=u*B,e[1]=(-h*s+i*c)*B,e[2]=(o*s-i*A)*B,e[3]=g*B,e[4]=(h*r-i*a)*B,e[5]=(-o*r+i*n)*B,e[6]=l*B,e[7]=(-c*r+s*a)*B,e[8]=(A*r-s*n)*B,e):null}function lg(e){const t=e[0],r=e[1],s=e[2],i=e[3],n=e[4],A=e[5],o=e[6],a=e[7],c=e[8];return t*(c*n-A*a)+r*(-c*i+A*o)+s*(a*i-n*o)}function kn(e,t,r){const s=t[0],i=t[1],n=t[2],A=t[3],o=t[4],a=t[5],c=t[6],h=t[7],u=t[8],g=r[0],l=r[1],B=r[2],d=r[3],C=r[4],m=r[5],w=r[6],E=r[7],p=r[8];return e[0]=g*s+l*A+B*c,e[1]=g*i+l*o+B*h,e[2]=g*n+l*a+B*u,e[3]=d*s+C*A+m*c,e[4]=d*i+C*o+m*h,e[5]=d*n+C*a+m*u,e[6]=w*s+E*A+p*c,e[7]=w*i+E*o+p*h,e[8]=w*n+E*a+p*u,e}function gg(e,t,r){const s=t[0],i=t[1],n=t[2],A=t[3],o=t[4],a=t[5],c=t[6],h=t[7],u=t[8],g=r[0],l=r[1];return e[0]=s,e[1]=i,e[2]=n,e[3]=A,e[4]=o,e[5]=a,e[6]=g*s+l*A+c,e[7]=g*i+l*o+h,e[8]=g*n+l*a+u,e}function Bg(e,t,r){const s=t[0],i=t[1],n=t[2],A=t[3],o=t[4],a=t[5],c=t[6],h=t[7],u=t[8],g=Math.sin(r),l=Math.cos(r);return e[0]=l*s+g*A,e[1]=l*i+g*o,e[2]=l*n+g*a,e[3]=l*A-g*s,e[4]=l*o-g*i,e[5]=l*a-g*n,e[6]=c,e[7]=h,e[8]=u,e}function qn(e,t,r){const s=r[0],i=r[1];return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function dg(e,t){const r=t[0],s=t[1],i=t[2],n=t[3],A=r+r,o=s+s,a=i+i,c=r*A,h=s*A,u=s*o,g=i*A,l=i*o,B=i*a,d=n*A,C=n*o,m=n*a;return e[0]=1-u-B,e[3]=h-m,e[6]=g+C,e[1]=h+m,e[4]=1-c-B,e[7]=l-d,e[2]=g-C,e[5]=l+d,e[8]=1-c-u,e}var ai;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL1ROW0=3]="COL1ROW0",e[e.COL1ROW1=4]="COL1ROW1",e[e.COL1ROW2=5]="COL1ROW2",e[e.COL2ROW0=6]="COL2ROW0",e[e.COL2ROW1=7]="COL2ROW1",e[e.COL2ROW2=8]="COL2ROW2"})(ai||(ai={}));const fg=Object.freeze([1,0,0,0,1,0,0,0,1]);class Z extends pa{static get IDENTITY(){return Ig()}static get ZERO(){return Cg()}get ELEMENTS(){return 9}get RANK(){return 3}get INDICES(){return ai}constructor(t,...r){super(-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):r.length>0?this.copy([t,...r]):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this.check()}identity(){return this.copy(fg)}fromObject(t){return this.check()}fromQuaternion(t){return dg(this,t),this.check()}set(t,r,s,i,n,A,o,a,c){return this[0]=t,this[1]=r,this[2]=s,this[3]=i,this[4]=n,this[5]=A,this[6]=o,this[7]=a,this[8]=c,this.check()}setRowMajor(t,r,s,i,n,A,o,a,c){return this[0]=t,this[1]=i,this[2]=o,this[3]=r,this[4]=n,this[5]=a,this[6]=s,this[7]=A,this[8]=c,this.check()}determinant(){return lg(this)}transpose(){return hg(this,this),this.check()}invert(){return ug(this,this),this.check()}multiplyLeft(t){return kn(this,t,this),this.check()}multiplyRight(t){return kn(this,this,t),this.check()}rotate(t){return Bg(this,this,t),this.check()}scale(t){return Array.isArray(t)?qn(this,this,t):qn(this,this,[t,t]),this.check()}translate(t){return gg(this,this,t),this.check()}transform(t,r){let s;switch(t.length){case 2:s=la(r||[-0,-0],t,this);break;case 3:s=Ea(r||[-0,-0,-0],t,this);break;case 4:s=fa(r||[-0,-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return qe(s,t.length),s}transformVector(t,r){return this.transform(t,r)}transformVector2(t,r){return this.transform(t,r)}transformVector3(t,r){return this.transform(t,r)}}let gr,Br=null;function Cg(){return gr||(gr=new Z([0,0,0,0,0,0,0,0,0]),Object.freeze(gr)),gr}function Ig(){return Br||(Br=new Z,Object.freeze(Br)),Br}function Eg(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function mg(e,t){if(e===t){const r=t[1],s=t[2],i=t[3],n=t[6],A=t[7],o=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=s,e[9]=n,e[11]=t[14],e[12]=i,e[13]=A,e[14]=o}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e}function pg(e,t){const r=t[0],s=t[1],i=t[2],n=t[3],A=t[4],o=t[5],a=t[6],c=t[7],h=t[8],u=t[9],g=t[10],l=t[11],B=t[12],d=t[13],C=t[14],m=t[15],w=r*o-s*A,E=r*a-i*A,p=r*c-n*A,R=s*a-i*o,y=s*c-n*o,T=i*c-n*a,G=h*d-u*B,_=h*C-g*B,v=h*m-l*B,N=u*C-g*d,q=u*m-l*d,K=g*m-l*C;let L=w*K-E*q+p*N+R*v-y*_+T*G;return L?(L=1/L,e[0]=(o*K-a*q+c*N)*L,e[1]=(i*q-s*K-n*N)*L,e[2]=(d*T-C*y+m*R)*L,e[3]=(g*y-u*T-l*R)*L,e[4]=(a*v-A*K-c*_)*L,e[5]=(r*K-i*v+n*_)*L,e[6]=(C*p-B*T-m*E)*L,e[7]=(h*T-g*p+l*E)*L,e[8]=(A*q-o*v+c*G)*L,e[9]=(s*v-r*q-n*G)*L,e[10]=(B*y-d*p+m*w)*L,e[11]=(u*p-h*y-l*w)*L,e[12]=(o*_-A*N-a*G)*L,e[13]=(r*N-s*_+i*G)*L,e[14]=(d*E-B*R-C*w)*L,e[15]=(h*R-u*E+g*w)*L,e):null}function yg(e){const t=e[0],r=e[1],s=e[2],i=e[3],n=e[4],A=e[5],o=e[6],a=e[7],c=e[8],h=e[9],u=e[10],g=e[11],l=e[12],B=e[13],d=e[14],C=e[15],m=t*A-r*n,w=t*o-s*n,E=r*o-s*A,p=c*B-h*l,R=c*d-u*l,y=h*d-u*B,T=t*y-r*R+s*p,G=n*y-A*R+o*p,_=c*E-h*w+u*m,v=l*E-B*w+d*m;return a*T-i*G+C*_-g*v}function Kn(e,t,r){const s=t[0],i=t[1],n=t[2],A=t[3],o=t[4],a=t[5],c=t[6],h=t[7],u=t[8],g=t[9],l=t[10],B=t[11],d=t[12],C=t[13],m=t[14],w=t[15];let E=r[0],p=r[1],R=r[2],y=r[3];return e[0]=E*s+p*o+R*u+y*d,e[1]=E*i+p*a+R*g+y*C,e[2]=E*n+p*c+R*l+y*m,e[3]=E*A+p*h+R*B+y*w,E=r[4],p=r[5],R=r[6],y=r[7],e[4]=E*s+p*o+R*u+y*d,e[5]=E*i+p*a+R*g+y*C,e[6]=E*n+p*c+R*l+y*m,e[7]=E*A+p*h+R*B+y*w,E=r[8],p=r[9],R=r[10],y=r[11],e[8]=E*s+p*o+R*u+y*d,e[9]=E*i+p*a+R*g+y*C,e[10]=E*n+p*c+R*l+y*m,e[11]=E*A+p*h+R*B+y*w,E=r[12],p=r[13],R=r[14],y=r[15],e[12]=E*s+p*o+R*u+y*d,e[13]=E*i+p*a+R*g+y*C,e[14]=E*n+p*c+R*l+y*m,e[15]=E*A+p*h+R*B+y*w,e}function Qg(e,t,r){const s=r[0],i=r[1],n=r[2];let A,o,a,c,h,u,g,l,B,d,C,m;return t===e?(e[12]=t[0]*s+t[4]*i+t[8]*n+t[12],e[13]=t[1]*s+t[5]*i+t[9]*n+t[13],e[14]=t[2]*s+t[6]*i+t[10]*n+t[14],e[15]=t[3]*s+t[7]*i+t[11]*n+t[15]):(A=t[0],o=t[1],a=t[2],c=t[3],h=t[4],u=t[5],g=t[6],l=t[7],B=t[8],d=t[9],C=t[10],m=t[11],e[0]=A,e[1]=o,e[2]=a,e[3]=c,e[4]=h,e[5]=u,e[6]=g,e[7]=l,e[8]=B,e[9]=d,e[10]=C,e[11]=m,e[12]=A*s+h*i+B*n+t[12],e[13]=o*s+u*i+d*n+t[13],e[14]=a*s+g*i+C*n+t[14],e[15]=c*s+l*i+m*n+t[15]),e}function wg(e,t,r){const s=r[0],i=r[1],n=r[2];return e[0]=t[0]*s,e[1]=t[1]*s,e[2]=t[2]*s,e[3]=t[3]*s,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*n,e[9]=t[9]*n,e[10]=t[10]*n,e[11]=t[11]*n,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function bg(e,t,r,s){let i=s[0],n=s[1],A=s[2],o=Math.sqrt(i*i+n*n+A*A),a,c,h,u,g,l,B,d,C,m,w,E,p,R,y,T,G,_,v,N,q,K,L,$;return o<Ke?null:(o=1/o,i*=o,n*=o,A*=o,c=Math.sin(r),a=Math.cos(r),h=1-a,u=t[0],g=t[1],l=t[2],B=t[3],d=t[4],C=t[5],m=t[6],w=t[7],E=t[8],p=t[9],R=t[10],y=t[11],T=i*i*h+a,G=n*i*h+A*c,_=A*i*h-n*c,v=i*n*h-A*c,N=n*n*h+a,q=A*n*h+i*c,K=i*A*h+n*c,L=n*A*h-i*c,$=A*A*h+a,e[0]=u*T+d*G+E*_,e[1]=g*T+C*G+p*_,e[2]=l*T+m*G+R*_,e[3]=B*T+w*G+y*_,e[4]=u*v+d*N+E*q,e[5]=g*v+C*N+p*q,e[6]=l*v+m*N+R*q,e[7]=B*v+w*N+y*q,e[8]=u*K+d*L+E*$,e[9]=g*K+C*L+p*$,e[10]=l*K+m*L+R*$,e[11]=B*K+w*L+y*$,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function Dg(e,t,r){const s=Math.sin(r),i=Math.cos(r),n=t[4],A=t[5],o=t[6],a=t[7],c=t[8],h=t[9],u=t[10],g=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=n*i+c*s,e[5]=A*i+h*s,e[6]=o*i+u*s,e[7]=a*i+g*s,e[8]=c*i-n*s,e[9]=h*i-A*s,e[10]=u*i-o*s,e[11]=g*i-a*s,e}function Rg(e,t,r){const s=Math.sin(r),i=Math.cos(r),n=t[0],A=t[1],o=t[2],a=t[3],c=t[8],h=t[9],u=t[10],g=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*i-c*s,e[1]=A*i-h*s,e[2]=o*i-u*s,e[3]=a*i-g*s,e[8]=n*s+c*i,e[9]=A*s+h*i,e[10]=o*s+u*i,e[11]=a*s+g*i,e}function Sg(e,t,r){const s=Math.sin(r),i=Math.cos(r),n=t[0],A=t[1],o=t[2],a=t[3],c=t[4],h=t[5],u=t[6],g=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=n*i+c*s,e[1]=A*i+h*s,e[2]=o*i+u*s,e[3]=a*i+g*s,e[4]=c*i-n*s,e[5]=h*i-A*s,e[6]=u*i-o*s,e[7]=g*i-a*s,e}function Tg(e,t){const r=t[0],s=t[1],i=t[2],n=t[4],A=t[5],o=t[6],a=t[8],c=t[9],h=t[10];return e[0]=Math.sqrt(r*r+s*s+i*i),e[1]=Math.sqrt(n*n+A*A+o*o),e[2]=Math.sqrt(a*a+c*c+h*h),e}function _g(e,t){const r=t[0],s=t[1],i=t[2],n=t[3],A=r+r,o=s+s,a=i+i,c=r*A,h=s*A,u=s*o,g=i*A,l=i*o,B=i*a,d=n*A,C=n*o,m=n*a;return e[0]=1-u-B,e[1]=h+m,e[2]=g-C,e[3]=0,e[4]=h-m,e[5]=1-c-B,e[6]=l+d,e[7]=0,e[8]=g+C,e[9]=l-d,e[10]=1-c-u,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function Mg(e,t,r,s,i,n,A){const o=1/(r-t),a=1/(i-s),c=1/(n-A);return e[0]=n*2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n*2*a,e[6]=0,e[7]=0,e[8]=(r+t)*o,e[9]=(i+s)*a,e[10]=(A+n)*c,e[11]=-1,e[12]=0,e[13]=0,e[14]=A*n*2*c,e[15]=0,e}function Fg(e,t,r,s,i){const n=1/Math.tan(t/2);if(e[0]=n/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=n,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){const A=1/(s-i);e[10]=(i+s)*A,e[14]=2*i*s*A}else e[10]=-1,e[14]=-2*s;return e}const Gg=Fg;function vg(e,t,r,s,i,n,A){const o=1/(t-r),a=1/(s-i),c=1/(n-A);return e[0]=-2*o,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*c,e[11]=0,e[12]=(t+r)*o,e[13]=(i+s)*a,e[14]=(A+n)*c,e[15]=1,e}const Lg=vg;function xg(e,t,r,s){let i,n,A,o,a,c,h,u,g,l;const B=t[0],d=t[1],C=t[2],m=s[0],w=s[1],E=s[2],p=r[0],R=r[1],y=r[2];return Math.abs(B-p)<Ke&&Math.abs(d-R)<Ke&&Math.abs(C-y)<Ke?Eg(e):(u=B-p,g=d-R,l=C-y,i=1/Math.sqrt(u*u+g*g+l*l),u*=i,g*=i,l*=i,n=w*l-E*g,A=E*u-m*l,o=m*g-w*u,i=Math.sqrt(n*n+A*A+o*o),i?(i=1/i,n*=i,A*=i,o*=i):(n=0,A=0,o=0),a=g*o-l*A,c=l*n-u*o,h=u*A-g*n,i=Math.sqrt(a*a+c*c+h*h),i?(i=1/i,a*=i,c*=i,h*=i):(a=0,c=0,h=0),e[0]=n,e[1]=a,e[2]=u,e[3]=0,e[4]=A,e[5]=c,e[6]=g,e[7]=0,e[8]=o,e[9]=h,e[10]=l,e[11]=0,e[12]=-(n*B+A*d+o*C),e[13]=-(a*B+c*d+h*C),e[14]=-(u*B+g*d+l*C),e[15]=1,e)}function Ug(){const e=new Lt(4);return Lt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Og(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e}function Ng(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function Pg(e){const t=e[0],r=e[1],s=e[2],i=e[3];return Math.sqrt(t*t+r*r+s*s+i*i)}function Hg(e){const t=e[0],r=e[1],s=e[2],i=e[3];return t*t+r*r+s*s+i*i}function Jg(e,t){const r=t[0],s=t[1],i=t[2],n=t[3];let A=r*r+s*s+i*i+n*n;return A>0&&(A=1/Math.sqrt(A)),e[0]=r*A,e[1]=s*A,e[2]=i*A,e[3]=n*A,e}function kg(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function qg(e,t,r,s){const i=t[0],n=t[1],A=t[2],o=t[3];return e[0]=i+s*(r[0]-i),e[1]=n+s*(r[1]-n),e[2]=A+s*(r[2]-A),e[3]=o+s*(r[3]-o),e}function Kg(e,t,r){const s=t[0],i=t[1],n=t[2],A=t[3];return e[0]=r[0]*s+r[4]*i+r[8]*n+r[12]*A,e[1]=r[1]*s+r[5]*i+r[9]*n+r[13]*A,e[2]=r[2]*s+r[6]*i+r[10]*n+r[14]*A,e[3]=r[3]*s+r[7]*i+r[11]*n+r[15]*A,e}function jg(e,t,r){const s=t[0],i=t[1],n=t[2],A=r[0],o=r[1],a=r[2],c=r[3],h=c*s+o*n-a*i,u=c*i+a*s-A*n,g=c*n+A*i-o*s,l=-A*s-o*i-a*n;return e[0]=h*c+l*-A+u*-a-g*-o,e[1]=u*c+l*-o+g*-A-h*-a,e[2]=g*c+l*-a+h*-o-u*-A,e[3]=t[3],e}(function(){const e=Ug();return function(t,r,s,i,n,A){let o,a;for(r||(r=4),s||(s=0),i?a=Math.min(i*r+s,t.length):a=t.length,o=s;o<a;o+=r)e[0]=t[o],e[1]=t[o+1],e[2]=t[o+2],e[3]=t[o+3],n(e,e,A),t[o]=e[0],t[o+1]=e[1],t[o+2]=e[2],t[o+3]=e[3];return t}})();var ci;(function(e){e[e.COL0ROW0=0]="COL0ROW0",e[e.COL0ROW1=1]="COL0ROW1",e[e.COL0ROW2=2]="COL0ROW2",e[e.COL0ROW3=3]="COL0ROW3",e[e.COL1ROW0=4]="COL1ROW0",e[e.COL1ROW1=5]="COL1ROW1",e[e.COL1ROW2=6]="COL1ROW2",e[e.COL1ROW3=7]="COL1ROW3",e[e.COL2ROW0=8]="COL2ROW0",e[e.COL2ROW1=9]="COL2ROW1",e[e.COL2ROW2=10]="COL2ROW2",e[e.COL2ROW3=11]="COL2ROW3",e[e.COL3ROW0=12]="COL3ROW0",e[e.COL3ROW1=13]="COL3ROW1",e[e.COL3ROW2=14]="COL3ROW2",e[e.COL3ROW3=15]="COL3ROW3"})(ci||(ci={}));const Vg=45*Math.PI/180,Yg=1,_s=.1,Ms=500,Wg=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class k extends pa{static get IDENTITY(){return zg()}static get ZERO(){return Xg()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return ci}constructor(t){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(t)?this.copy(t):this.identity()}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this[4]=t[4],this[5]=t[5],this[6]=t[6],this[7]=t[7],this[8]=t[8],this[9]=t[9],this[10]=t[10],this[11]=t[11],this[12]=t[12],this[13]=t[13],this[14]=t[14],this[15]=t[15],this.check()}set(t,r,s,i,n,A,o,a,c,h,u,g,l,B,d,C){return this[0]=t,this[1]=r,this[2]=s,this[3]=i,this[4]=n,this[5]=A,this[6]=o,this[7]=a,this[8]=c,this[9]=h,this[10]=u,this[11]=g,this[12]=l,this[13]=B,this[14]=d,this[15]=C,this.check()}setRowMajor(t,r,s,i,n,A,o,a,c,h,u,g,l,B,d,C){return this[0]=t,this[1]=n,this[2]=c,this[3]=l,this[4]=r,this[5]=A,this[6]=h,this[7]=B,this[8]=s,this[9]=o,this[10]=u,this[11]=d,this[12]=i,this[13]=a,this[14]=g,this[15]=C,this.check()}toRowMajor(t){return t[0]=this[0],t[1]=this[4],t[2]=this[8],t[3]=this[12],t[4]=this[1],t[5]=this[5],t[6]=this[9],t[7]=this[13],t[8]=this[2],t[9]=this[6],t[10]=this[10],t[11]=this[14],t[12]=this[3],t[13]=this[7],t[14]=this[11],t[15]=this[15],t}identity(){return this.copy(Wg)}fromObject(t){return this.check()}fromQuaternion(t){return _g(this,t),this.check()}frustum(t){const{left:r,right:s,bottom:i,top:n,near:A=_s,far:o=Ms}=t;return o===1/0?Zg(this,r,s,i,n,A):Mg(this,r,s,i,n,A,o),this.check()}lookAt(t){const{eye:r,center:s=[0,0,0],up:i=[0,1,0]}=t;return xg(this,r,s,i),this.check()}ortho(t){const{left:r,right:s,bottom:i,top:n,near:A=_s,far:o=Ms}=t;return Lg(this,r,s,i,n,A,o),this.check()}orthographic(t){const{fovy:r=Vg,aspect:s=Yg,focalDistance:i=1,near:n=_s,far:A=Ms}=t;jn(r);const o=r/2,a=i*Math.tan(o),c=a*s;return this.ortho({left:-c,right:c,bottom:-a,top:a,near:n,far:A})}perspective(t){const{fovy:r=45*Math.PI/180,aspect:s=1,near:i=.1,far:n=500}=t;return jn(r),Gg(this,r,s,i,n),this.check()}determinant(){return yg(this)}getScale(t=[-0,-0,-0]){return t[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),t[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),t[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),t}getTranslation(t=[-0,-0,-0]){return t[0]=this[12],t[1]=this[13],t[2]=this[14],t}getRotation(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const s=this.getScale(r),i=1/s[0],n=1/s[1],A=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*n,t[2]=this[2]*A,t[3]=0,t[4]=this[4]*i,t[5]=this[5]*n,t[6]=this[6]*A,t[7]=0,t[8]=this[8]*i,t[9]=this[9]*n,t[10]=this[10]*A,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}getRotationMatrix3(t,r){t=t||[-0,-0,-0,-0,-0,-0,-0,-0,-0],r=r||[-0,-0,-0];const s=this.getScale(r),i=1/s[0],n=1/s[1],A=1/s[2];return t[0]=this[0]*i,t[1]=this[1]*n,t[2]=this[2]*A,t[3]=this[4]*i,t[4]=this[5]*n,t[5]=this[6]*A,t[6]=this[8]*i,t[7]=this[9]*n,t[8]=this[10]*A,t}transpose(){return mg(this,this),this.check()}invert(){return pg(this,this),this.check()}multiplyLeft(t){return Kn(this,t,this),this.check()}multiplyRight(t){return Kn(this,this,t),this.check()}rotateX(t){return Dg(this,this,t),this.check()}rotateY(t){return Rg(this,this,t),this.check()}rotateZ(t){return Sg(this,this,t),this.check()}rotateXYZ(t){return this.rotateX(t[0]).rotateY(t[1]).rotateZ(t[2])}rotateAxis(t,r){return bg(this,this,t,r),this.check()}scale(t){return wg(this,this,Array.isArray(t)?t:[t,t,t]),this.check()}translate(t){return Qg(this,this,t),this.check()}transform(t,r){return t.length===4?(r=Kg(r||[-0,-0,-0,-0],t,this),qe(r,4),r):this.transformAsPoint(t,r)}transformAsPoint(t,r){const{length:s}=t;let i;switch(s){case 2:i=ga(r||[-0,-0],t,this);break;case 3:i=ki(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return qe(i,t.length),i}transformAsVector(t,r){let s;switch(t.length){case 2:s=Ba(r||[-0,-0],t,this);break;case 3:s=da(r||[-0,-0,-0],t,this);break;default:throw new Error("Illegal vector")}return qe(s,t.length),s}transformPoint(t,r){return this.transformAsPoint(t,r)}transformVector(t,r){return this.transformAsPoint(t,r)}transformDirection(t,r){return this.transformAsVector(t,r)}makeRotationX(t){return this.identity().rotateX(t)}makeTranslation(t,r,s){return this.identity().translate([t,r,s])}}let dr,fr;function Xg(){return dr||(dr=new k([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(dr)),dr}function zg(){return fr||(fr=new k,Object.freeze(fr)),fr}function jn(e){if(e>Math.PI*2)throw Error("expected radians")}function Zg(e,t,r,s,i,n){const A=2*n/(r-t),o=2*n/(i-s),a=(r+t)/(r-t),c=(i+s)/(i-s),h=-1,u=-1,g=-2*n;return e[0]=A,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=a,e[9]=c,e[10]=h,e[11]=u,e[12]=0,e[13]=0,e[14]=g,e[15]=0,e}function Vn(){const e=new Lt(4);return Lt!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function $g(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function ya(e,t,r){r=r*.5;const s=Math.sin(r);return e[0]=s*t[0],e[1]=s*t[1],e[2]=s*t[2],e[3]=Math.cos(r),e}function Yn(e,t,r){const s=t[0],i=t[1],n=t[2],A=t[3],o=r[0],a=r[1],c=r[2],h=r[3];return e[0]=s*h+A*o+i*c-n*a,e[1]=i*h+A*a+n*o-s*c,e[2]=n*h+A*c+s*a-i*o,e[3]=A*h-s*o-i*a-n*c,e}function tB(e,t,r){r*=.5;const s=t[0],i=t[1],n=t[2],A=t[3],o=Math.sin(r),a=Math.cos(r);return e[0]=s*a+A*o,e[1]=i*a+n*o,e[2]=n*a-i*o,e[3]=A*a-s*o,e}function eB(e,t,r){r*=.5;const s=t[0],i=t[1],n=t[2],A=t[3],o=Math.sin(r),a=Math.cos(r);return e[0]=s*a-n*o,e[1]=i*a+A*o,e[2]=n*a+s*o,e[3]=A*a-i*o,e}function rB(e,t,r){r*=.5;const s=t[0],i=t[1],n=t[2],A=t[3],o=Math.sin(r),a=Math.cos(r);return e[0]=s*a+i*o,e[1]=i*a-s*o,e[2]=n*a+A*o,e[3]=A*a-n*o,e}function sB(e,t){const r=t[0],s=t[1],i=t[2];return e[0]=r,e[1]=s,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-s*s-i*i)),e}function Gr(e,t,r,s){const i=t[0],n=t[1],A=t[2],o=t[3];let a=r[0],c=r[1],h=r[2],u=r[3],g,l,B,d,C;return g=i*a+n*c+A*h+o*u,g<0&&(g=-g,a=-a,c=-c,h=-h,u=-u),1-g>Ke?(l=Math.acos(g),C=Math.sin(l),B=Math.sin((1-s)*l)/C,d=Math.sin(s*l)/C):(B=1-s,d=s),e[0]=B*i+d*a,e[1]=B*n+d*c,e[2]=B*A+d*h,e[3]=B*o+d*u,e}function iB(e,t){const r=t[0],s=t[1],i=t[2],n=t[3],A=r*r+s*s+i*i+n*n,o=A?1/A:0;return e[0]=-r*o,e[1]=-s*o,e[2]=-i*o,e[3]=n*o,e}function nB(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function Qa(e,t){const r=t[0]+t[4]+t[8];let s;if(r>0)s=Math.sqrt(r+1),e[3]=.5*s,s=.5/s,e[0]=(t[5]-t[7])*s,e[1]=(t[6]-t[2])*s,e[2]=(t[1]-t[3])*s;else{let i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);const n=(i+1)%3,A=(i+2)%3;s=Math.sqrt(t[i*3+i]-t[n*3+n]-t[A*3+A]+1),e[i]=.5*s,s=.5/s,e[3]=(t[n*3+A]-t[A*3+n])*s,e[n]=(t[n*3+i]+t[i*3+n])*s,e[A]=(t[A*3+i]+t[i*3+A])*s}return e}const AB=Og,oB=Ng,aB=kg,cB=qg,hB=Pg,uB=Hg,wa=Jg,lB=function(){const e=Ca(),t=Jn(1,0,0),r=Jn(0,1,0);return function(s,i,n){const A=Ji(i,n);return A<-.999999?(Fr(e,t,i),ag(e)<1e-6&&Fr(e,r,i),sg(e,e),ya(s,e,Math.PI),s):A>.999999?(s[0]=0,s[1]=0,s[2]=0,s[3]=1,s):(Fr(e,i,n),s[0]=e[0],s[1]=e[1],s[2]=e[2],s[3]=1+A,wa(s,s))}}();(function(){const e=Vn(),t=Vn();return function(r,s,i,n,A,o){return Gr(e,s,A,o),Gr(t,i,n,o),Gr(r,e,t,2*o*(1-o)),r}})();(function(){const e=cg();return function(t,r,s,i){return e[0]=s[0],e[3]=s[1],e[6]=s[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],wa(t,Qa(t,e))}})();const gB=[0,0,0,1];class Hr extends Pi{constructor(t=0,r=0,s=0,i=1){super(-0,-0,-0,-0),Array.isArray(t)&&arguments.length===1?this.copy(t):this.set(t,r,s,i)}copy(t){return this[0]=t[0],this[1]=t[1],this[2]=t[2],this[3]=t[3],this.check()}set(t,r,s,i){return this[0]=t,this[1]=r,this[2]=s,this[3]=i,this.check()}fromObject(t){return this[0]=t.x,this[1]=t.y,this[2]=t.z,this[3]=t.w,this.check()}fromMatrix3(t){return Qa(this,t),this.check()}fromAxisRotation(t,r){return ya(this,t,r),this.check()}identity(){return $g(this),this.check()}setAxisAngle(t,r){return this.fromAxisRotation(t,r)}get ELEMENTS(){return 4}get x(){return this[0]}set x(t){this[0]=P(t)}get y(){return this[1]}set y(t){this[1]=P(t)}get z(){return this[2]}set z(t){this[2]=P(t)}get w(){return this[3]}set w(t){this[3]=P(t)}len(){return hB(this)}lengthSquared(){return uB(this)}dot(t){return aB(this,t)}rotationTo(t,r){return lB(this,t,r),this.check()}add(t){return AB(this,this,t),this.check()}calculateW(){return sB(this,this),this.check()}conjugate(){return nB(this,this),this.check()}invert(){return iB(this,this),this.check()}lerp(t,r,s){return s===void 0?this.lerp(this,t,r):(cB(this,t,r,s),this.check())}multiplyRight(t){return Yn(this,this,t),this.check()}multiplyLeft(t){return Yn(this,t,this),this.check()}normalize(){const t=this.len(),r=t>0?1/t:0;return this[0]=this[0]*r,this[1]=this[1]*r,this[2]=this[2]*r,this[3]=this[3]*r,t===0&&(this[3]=1),this.check()}rotateX(t){return tB(this,this,t),this.check()}rotateY(t){return eB(this,this,t),this.check()}rotateZ(t){return rB(this,this,t),this.check()}scale(t){return oB(this,this,t),this.check()}slerp(t,r,s){let i,n,A;switch(arguments.length){case 1:({start:i=gB,target:n,ratio:A}=t);break;case 2:i=this,n=t,A=r;break;default:i=t,n=r,A=s}return Gr(this,i,n,A),this.check()}transformVector4(t,r=new qi){return jg(r,t,this),qe(r,4)}lengthSq(){return this.lengthSquared()}setFromAxisAngle(t,r){return this.setAxisAngle(t,r)}premultiply(t){return this.multiplyLeft(t)}multiply(t){return this.multiplyRight(t)}}function ze(e){"@babel/helpers - typeof";return ze=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ze(e)}function BB(e,t){if(ze(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var s=r.call(e,t||"default");if(ze(s)!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function dB(e){var t=BB(e,"string");return ze(t)=="symbol"?t:String(t)}function F(e,t,r){return t=dB(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const fB=.1,CB=1e-12,ba=1e-15,IB=1e-20,EB=6378137,mB=6378137,pB=6356752314245179e-9;function ss(e){return e}new f;function yB(e,t=[],r=ss){return"longitude"in e?(t[0]=r(e.longitude),t[1]=r(e.latitude),t[2]=e.height):"x"in e?(t[0]=r(e.x),t[1]=r(e.y),t[2]=e.z):(t[0]=r(e[0]),t[1]=r(e[1]),t[2]=e[2]),t}function QB(e,t=[]){return yB(e,t,nt._cartographicRadians?ss:ql)}function wB(e,t,r=ss){return"longitude"in t?(t.longitude=r(e[0]),t.latitude=r(e[1]),t.height=e[2]):"x"in t?(t.x=r(e[0]),t.y=r(e[1]),t.z=e[2]):(t[0]=r(e[0]),t[1]=r(e[1]),t[2]=e[2]),t}function bB(e,t){return wB(e,t,nt._cartographicRadians?ss:Kl)}const Wn=1e-14,DB=new f,Xn={up:{south:"east",north:"west",west:"south",east:"north"},down:{south:"west",north:"east",west:"north",east:"south"},south:{up:"west",down:"east",west:"down",east:"up"},north:{up:"east",down:"west",west:"up",east:"down"},west:{up:"north",down:"south",north:"down",south:"up"},east:{up:"south",down:"north",north:"up",south:"down"}},Fs={north:[-1,0,0],east:[0,1,0],up:[0,0,1],south:[1,0,0],west:[0,-1,0],down:[0,0,-1]},Fe={east:new f,north:new f,up:new f,west:new f,south:new f,down:new f},RB=new f,SB=new f,TB=new f;function zn(e,t,r,s,i,n){const A=Xn[t]&&Xn[t][r];Y(A&&(!s||s===A));let o,a,c;const h=DB.copy(i);if(ee(h.x,0,Wn)&&ee(h.y,0,Wn)){const u=Math.sign(h.z);o=RB.fromArray(Fs[t]),t!=="east"&&t!=="west"&&o.scale(u),a=SB.fromArray(Fs[r]),r!=="east"&&r!=="west"&&a.scale(u),c=TB.fromArray(Fs[s]),s!=="east"&&s!=="west"&&c.scale(u)}else{const{up:u,east:g,north:l}=Fe;g.set(-h.y,h.x,0).normalize(),e.geodeticSurfaceNormal(h,u),l.copy(u).cross(g);const{down:B,west:d,south:C}=Fe;B.copy(u).scale(-1),d.copy(g).scale(-1),C.copy(l).scale(-1),o=Fe[t],a=Fe[r],c=Fe[s]}return n[0]=o.x,n[1]=o.y,n[2]=o.z,n[3]=0,n[4]=a.x,n[5]=a.y,n[6]=a.z,n[7]=0,n[8]=c.x,n[9]=c.y,n[10]=c.z,n[11]=0,n[12]=h.x,n[13]=h.y,n[14]=h.z,n[15]=1,n}const Ie=new f,_B=new f,MB=new f;function FB(e,t,r=[]){const{oneOverRadii:s,oneOverRadiiSquared:i,centerToleranceSquared:n}=t;Ie.from(e);const A=Ie.x,o=Ie.y,a=Ie.z,c=s.x,h=s.y,u=s.z,g=A*A*c*c,l=o*o*h*h,B=a*a*u*u,d=g+l+B,C=Math.sqrt(1/d);if(!Number.isFinite(C))return;const m=_B;if(m.copy(e).scale(C),d<n)return m.to(r);const w=i.x,E=i.y,p=i.z,R=MB;R.set(m.x*w*2,m.y*E*2,m.z*p*2);let y=(1-C)*Ie.len()/(.5*R.len()),T=0,G,_,v,N;do{y-=T,G=1/(1+y*w),_=1/(1+y*E),v=1/(1+y*p);const q=G*G,K=_*_,L=v*v,$=q*G,ct=K*_,j=L*v;N=g*q+l*K+B*L-1;const V=-2*(g*$*w+l*ct*E+B*j*p);T=N/V}while(Math.abs(N)>CB);return Ie.scale([G,_,v]).to(r)}const Cr=new f,Zn=new f,GB=new f,Mt=new f,vB=new f,Ir=new f;class J{constructor(t=0,r=0,s=0){F(this,"radii",void 0),F(this,"radiiSquared",void 0),F(this,"radiiToTheFourth",void 0),F(this,"oneOverRadii",void 0),F(this,"oneOverRadiiSquared",void 0),F(this,"minimumRadius",void 0),F(this,"maximumRadius",void 0),F(this,"centerToleranceSquared",fB),F(this,"squaredXOverSquaredZ",void 0),Y(t>=0),Y(r>=0),Y(s>=0),this.radii=new f(t,r,s),this.radiiSquared=new f(t*t,r*r,s*s),this.radiiToTheFourth=new f(t*t*t*t,r*r*r*r,s*s*s*s),this.oneOverRadii=new f(t===0?0:1/t,r===0?0:1/r,s===0?0:1/s),this.oneOverRadiiSquared=new f(t===0?0:1/(t*t),r===0?0:1/(r*r),s===0?0:1/(s*s)),this.minimumRadius=Math.min(t,r,s),this.maximumRadius=Math.max(t,r,s),this.radiiSquared.z!==0&&(this.squaredXOverSquaredZ=this.radiiSquared.x/this.radiiSquared.z),Object.freeze(this)}equals(t){return this===t||!!(t&&this.radii.equals(t.radii))}toString(){return this.radii.toString()}cartographicToCartesian(t,r=[0,0,0]){const s=Zn,i=GB,[,,n]=t;this.geodeticSurfaceNormalCartographic(t,s),i.copy(this.radiiSquared).scale(s);const A=Math.sqrt(s.dot(i));return i.scale(1/A),s.scale(n),i.add(s),i.to(r)}cartesianToCartographic(t,r=[0,0,0]){Ir.from(t);const s=this.scaleToGeodeticSurface(Ir,Mt);if(!s)return;const i=this.geodeticSurfaceNormal(s,Zn),n=vB;n.copy(Ir).subtract(s);const A=Math.atan2(i.y,i.x),o=Math.asin(i.z),a=Math.sign(Ji(n,Ir))*Ia(n);return bB([A,o,a],r)}eastNorthUpToFixedFrame(t,r=new k){return zn(this,"east","north","up",t,r)}localFrameToFixedFrame(t,r,s,i,n=new k){return zn(this,t,r,s,i,n)}geocentricSurfaceNormal(t,r=[0,0,0]){return Cr.from(t).normalize().to(r)}geodeticSurfaceNormalCartographic(t,r=[0,0,0]){const s=QB(t),i=s[0],n=s[1],A=Math.cos(n);return Cr.set(A*Math.cos(i),A*Math.sin(i),Math.sin(n)).normalize(),Cr.to(r)}geodeticSurfaceNormal(t,r=[0,0,0]){return Cr.from(t).scale(this.oneOverRadiiSquared).normalize().to(r)}scaleToGeodeticSurface(t,r){return FB(t,this,r)}scaleToGeocentricSurface(t,r=[0,0,0]){Mt.from(t);const s=Mt.x,i=Mt.y,n=Mt.z,A=this.oneOverRadiiSquared,o=1/Math.sqrt(s*s*A.x+i*i*A.y+n*n*A.z);return Mt.multiplyScalar(o).to(r)}transformPositionToScaledSpace(t,r=[0,0,0]){return Mt.from(t).scale(this.oneOverRadii).to(r)}transformPositionFromScaledSpace(t,r=[0,0,0]){return Mt.from(t).scale(this.radii).to(r)}getSurfaceNormalIntersectionWithZAxis(t,r=0,s=[0,0,0]){Y(ee(this.radii.x,this.radii.y,ba)),Y(this.radii.z>0),Mt.from(t);const i=Mt.z*(1-this.squaredXOverSquaredZ);if(!(Math.abs(i)>=this.radii.z-r))return Mt.set(0,0,i).to(s)}}F(J,"WGS84",new J(EB,mB,pB));const Qt={OUTSIDE:-1,INTERSECTING:0,INSIDE:1};new f;new f;const Ge=new f,$n=new f;class or{constructor(t=[0,0,0],r=0){F(this,"center",void 0),F(this,"radius",void 0),this.radius=-0,this.center=new f,this.fromCenterRadius(t,r)}fromCenterRadius(t,r){return this.center.from(t),this.radius=r,this}fromCornerPoints(t,r){return r=Ge.from(r),this.center=new f().from(t).add(r).scale(.5),this.radius=this.center.distance(r),this}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.radius===t.radius}clone(){return new or(this.center,this.radius)}union(t){const r=this.center,s=this.radius,i=t.center,n=t.radius,A=Ge.copy(i).subtract(r),o=A.magnitude();if(s>=o+n)return this.clone();if(n>=o+s)return t.clone();const a=(s+o+n)*.5;return $n.copy(A).scale((-s+a)/o).add(r),this.center.copy($n),this.radius=a,this}expand(t){const r=Ge.from(t).subtract(this.center).magnitude();return r>this.radius&&(this.radius=r),this}transform(t){this.center.transform(t);const r=Tg(Ge,t);return this.radius=Math.max(r[0],Math.max(r[1],r[2]))*this.radius,this}distanceSquaredTo(t){const r=this.distanceTo(t);return r*r}distanceTo(t){const r=Ge.from(t).subtract(this.center);return Math.max(0,r.len()-this.radius)}intersectPlane(t){const r=this.center,s=this.radius,i=t.normal.dot(r)+t.distance;return i<-s?Qt.OUTSIDE:i<s?Qt.INTERSECTING:Qt.INSIDE}}const LB=new f,xB=new f,Er=new f,mr=new f,pr=new f,UB=new f,OB=new f,qt={COLUMN0ROW0:0,COLUMN0ROW1:1,COLUMN0ROW2:2,COLUMN1ROW0:3,COLUMN1ROW1:4,COLUMN1ROW2:5,COLUMN2ROW0:6,COLUMN2ROW1:7,COLUMN2ROW2:8};class ar{constructor(t=[0,0,0],r=[0,0,0,0,0,0,0,0,0]){F(this,"center",void 0),F(this,"halfAxes",void 0),this.center=new f().from(t),this.halfAxes=new Z(r)}get halfSize(){const t=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),s=this.halfAxes.getColumn(2);return[new f(t).len(),new f(r).len(),new f(s).len()]}get quaternion(){const t=this.halfAxes.getColumn(0),r=this.halfAxes.getColumn(1),s=this.halfAxes.getColumn(2),i=new f(t).normalize(),n=new f(r).normalize(),A=new f(s).normalize();return new Hr().fromMatrix3(new Z([...i,...n,...A]))}fromCenterHalfSizeQuaternion(t,r,s){const i=new Hr(s),n=new Z().fromQuaternion(i);return n[0]=n[0]*r[0],n[1]=n[1]*r[0],n[2]=n[2]*r[0],n[3]=n[3]*r[1],n[4]=n[4]*r[1],n[5]=n[5]*r[1],n[6]=n[6]*r[2],n[7]=n[7]*r[2],n[8]=n[8]*r[2],this.center=new f().from(t),this.halfAxes=n,this}clone(){return new ar(this.center,this.halfAxes)}equals(t){return this===t||!!t&&this.center.equals(t.center)&&this.halfAxes.equals(t.halfAxes)}getBoundingSphere(t=new or){const r=this.halfAxes,s=r.getColumn(0,Er),i=r.getColumn(1,mr),n=r.getColumn(2,pr),A=LB.copy(s).add(i).add(n);return t.center.copy(this.center),t.radius=A.magnitude(),t}intersectPlane(t){const r=this.center,s=t.normal,i=this.halfAxes,n=s.x,A=s.y,o=s.z,a=Math.abs(n*i[qt.COLUMN0ROW0]+A*i[qt.COLUMN0ROW1]+o*i[qt.COLUMN0ROW2])+Math.abs(n*i[qt.COLUMN1ROW0]+A*i[qt.COLUMN1ROW1]+o*i[qt.COLUMN1ROW2])+Math.abs(n*i[qt.COLUMN2ROW0]+A*i[qt.COLUMN2ROW1]+o*i[qt.COLUMN2ROW2]),c=s.dot(r)+t.distance;return c<=-a?Qt.OUTSIDE:c>=a?Qt.INSIDE:Qt.INTERSECTING}distanceTo(t){return Math.sqrt(this.distanceSquaredTo(t))}distanceSquaredTo(t){const r=xB.from(t).subtract(this.center),s=this.halfAxes,i=s.getColumn(0,Er),n=s.getColumn(1,mr),A=s.getColumn(2,pr),o=i.magnitude(),a=n.magnitude(),c=A.magnitude();i.normalize(),n.normalize(),A.normalize();let h=0,u;return u=Math.abs(r.dot(i))-o,u>0&&(h+=u*u),u=Math.abs(r.dot(n))-a,u>0&&(h+=u*u),u=Math.abs(r.dot(A))-c,u>0&&(h+=u*u),h}computePlaneDistances(t,r,s=[-0,-0]){let i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;const A=this.center,o=this.halfAxes,a=o.getColumn(0,Er),c=o.getColumn(1,mr),h=o.getColumn(2,pr),u=UB.copy(a).add(c).add(h).add(A),g=OB.copy(u).subtract(t);let l=r.dot(g);return i=Math.min(l,i),n=Math.max(l,n),u.copy(A).add(a).add(c).subtract(h),g.copy(u).subtract(t),l=r.dot(g),i=Math.min(l,i),n=Math.max(l,n),u.copy(A).add(a).subtract(c).add(h),g.copy(u).subtract(t),l=r.dot(g),i=Math.min(l,i),n=Math.max(l,n),u.copy(A).add(a).subtract(c).subtract(h),g.copy(u).subtract(t),l=r.dot(g),i=Math.min(l,i),n=Math.max(l,n),A.copy(u).subtract(a).add(c).add(h),g.copy(u).subtract(t),l=r.dot(g),i=Math.min(l,i),n=Math.max(l,n),A.copy(u).subtract(a).add(c).subtract(h),g.copy(u).subtract(t),l=r.dot(g),i=Math.min(l,i),n=Math.max(l,n),A.copy(u).subtract(a).subtract(c).add(h),g.copy(u).subtract(t),l=r.dot(g),i=Math.min(l,i),n=Math.max(l,n),A.copy(u).subtract(a).subtract(c).subtract(h),g.copy(u).subtract(t),l=r.dot(g),i=Math.min(l,i),n=Math.max(l,n),s[0]=i,s[1]=n,s}transform(t){this.center.transformAsPoint(t);const r=this.halfAxes.getColumn(0,Er);r.transformAsPoint(t);const s=this.halfAxes.getColumn(1,mr);s.transformAsPoint(t);const i=this.halfAxes.getColumn(2,pr);return i.transformAsPoint(t),this.halfAxes=new Z([...r,...s,...i]),this}getTransform(){throw new Error("not implemented")}}const tA=new f,eA=new f;class at{constructor(t=[0,0,1],r=0){F(this,"normal",void 0),F(this,"distance",void 0),this.normal=new f,this.distance=-0,this.fromNormalDistance(t,r)}fromNormalDistance(t,r){return Y(Number.isFinite(r)),this.normal.from(t).normalize(),this.distance=r,this}fromPointNormal(t,r){t=tA.from(t),this.normal.from(r).normalize();const s=-this.normal.dot(t);return this.distance=s,this}fromCoefficients(t,r,s,i){return this.normal.set(t,r,s),Y(ee(this.normal.len(),1)),this.distance=i,this}clone(){return new at(this.normal,this.distance)}equals(t){return ee(this.distance,t.distance)&&ee(this.normal,t.normal)}getPointDistance(t){return this.normal.dot(t)+this.distance}transform(t){const r=eA.copy(this.normal).transformAsVector(t).normalize(),s=this.normal.scale(-this.distance).transform(t);return this.fromPointNormal(s,r)}projectPointOntoPlane(t,r=[0,0,0]){const s=tA.from(t),i=this.getPointDistance(s),n=eA.copy(this.normal).scale(i);return s.subtract(n).to(r)}}const rA=[new f([1,0,0]),new f([0,1,0]),new f([0,0,1])],sA=new f,NB=new f;class Et{constructor(t=[]){F(this,"planes",void 0),this.planes=t}fromBoundingSphere(t){this.planes.length=2*rA.length;const r=t.center,s=t.radius;let i=0;for(const n of rA){let A=this.planes[i],o=this.planes[i+1];A||(A=this.planes[i]=new at),o||(o=this.planes[i+1]=new at);const a=sA.copy(n).scale(-s).add(r);A.fromPointNormal(a,n);const c=sA.copy(n).scale(s).add(r),h=NB.copy(n).negate();o.fromPointNormal(c,h),i+=2}return this}computeVisibility(t){let r=Qt.INSIDE;for(const s of this.planes)switch(t.intersectPlane(s)){case Qt.OUTSIDE:return Qt.OUTSIDE;case Qt.INTERSECTING:r=Qt.INTERSECTING;break}return r}computeVisibilityWithPlaneMask(t,r){if(Y(Number.isFinite(r),"parentPlaneMask is required."),r===Et.MASK_OUTSIDE||r===Et.MASK_INSIDE)return r;let s=Et.MASK_INSIDE;const i=this.planes;for(let n=0;n<this.planes.length;++n){const A=n<31?1<<n:0;if(n<31&&!(r&A))continue;const o=i[n],a=t.intersectPlane(o);if(a===Qt.OUTSIDE)return Et.MASK_OUTSIDE;a===Qt.INTERSECTING&&(s|=A)}return s}}F(Et,"MASK_OUTSIDE",4294967295);F(Et,"MASK_INSIDE",0);F(Et,"MASK_INDETERMINATE",2147483647);const PB=new f,HB=new f,JB=new f,kB=new f,qB=new f;class Jr{constructor(t={}){F(this,"left",void 0),F(this,"_left",void 0),F(this,"right",void 0),F(this,"_right",void 0),F(this,"top",void 0),F(this,"_top",void 0),F(this,"bottom",void 0),F(this,"_bottom",void 0),F(this,"near",void 0),F(this,"_near",void 0),F(this,"far",void 0),F(this,"_far",void 0),F(this,"_cullingVolume",new Et([new at,new at,new at,new at,new at,new at])),F(this,"_perspectiveMatrix",new k),F(this,"_infinitePerspective",new k);const{near:r=1,far:s=5e8}=t;this.left=t.left,this._left=void 0,this.right=t.right,this._right=void 0,this.top=t.top,this._top=void 0,this.bottom=t.bottom,this._bottom=void 0,this.near=r,this._near=r,this.far=s,this._far=s}clone(){return new Jr({right:this.right,left:this.left,top:this.top,bottom:this.bottom,near:this.near,far:this.far})}equals(t){return t&&t instanceof Jr&&this.right===t.right&&this.left===t.left&&this.top===t.top&&this.bottom===t.bottom&&this.near===t.near&&this.far===t.far}get projectionMatrix(){return this._update(),this._perspectiveMatrix}get infiniteProjectionMatrix(){return this._update(),this._infinitePerspective}computeCullingVolume(t,r,s){Y(t,"position is required."),Y(r,"direction is required."),Y(s,"up is required.");const i=this._cullingVolume.planes;s=PB.copy(s).normalize();const n=HB.copy(r).cross(s).normalize(),A=JB.copy(r).multiplyByScalar(this.near).add(t),o=kB.copy(r).multiplyByScalar(this.far).add(t);let a=qB;return a.copy(n).multiplyByScalar(this.left).add(A).subtract(t).cross(s),i[0].fromPointNormal(t,a),a.copy(n).multiplyByScalar(this.right).add(A).subtract(t).cross(s).negate(),i[1].fromPointNormal(t,a),a.copy(s).multiplyByScalar(this.bottom).add(A).subtract(t).cross(n).negate(),i[2].fromPointNormal(t,a),a.copy(s).multiplyByScalar(this.top).add(A).subtract(t).cross(n),i[3].fromPointNormal(t,a),a=new f().copy(r),i[4].fromPointNormal(A,a),a.negate(),i[5].fromPointNormal(o,a),this._cullingVolume}getPixelDimensions(t,r,s,i){this._update(),Y(Number.isFinite(t)&&Number.isFinite(r)),Y(t>0),Y(r>0),Y(s>0),Y(i);const n=1/this.near;let A=this.top*n;const o=2*s*A/r;A=this.right*n;const a=2*s*A/t;return i.x=a,i.y=o,i}_update(){Y(Number.isFinite(this.right)&&Number.isFinite(this.left)&&Number.isFinite(this.top)&&Number.isFinite(this.bottom)&&Number.isFinite(this.near)&&Number.isFinite(this.far));const{top:t,bottom:r,right:s,left:i,near:n,far:A}=this;(t!==this._top||r!==this._bottom||i!==this._left||s!==this._right||n!==this._near||A!==this._far)&&(Y(this.near>0&&this.near<this.far,"near must be greater than zero and less than far."),this._left=i,this._right=s,this._top=t,this._bottom=r,this._near=n,this._far=A,this._perspectiveMatrix=new k().frustum({left:i,right:s,bottom:r,top:t,near:n,far:A}),this._infinitePerspective=new k().frustum({left:i,right:s,bottom:r,top:t,near:n,far:1/0}))}}const KB=e=>e!==null&&typeof e<"u";class kr{constructor(t={}){F(this,"_offCenterFrustum",new Jr),F(this,"fov",void 0),F(this,"_fov",void 0),F(this,"_fovy",void 0),F(this,"_sseDenominator",void 0),F(this,"aspectRatio",void 0),F(this,"_aspectRatio",void 0),F(this,"near",void 0),F(this,"_near",void 0),F(this,"far",void 0),F(this,"_far",void 0),F(this,"xOffset",void 0),F(this,"_xOffset",void 0),F(this,"yOffset",void 0),F(this,"_yOffset",void 0);const{fov:r,aspectRatio:s,near:i=1,far:n=5e8,xOffset:A=0,yOffset:o=0}=t;this.fov=r,this.aspectRatio=s,this.near=i,this.far=n,this.xOffset=A,this.yOffset=o}clone(){return new kr({aspectRatio:this.aspectRatio,fov:this.fov,near:this.near,far:this.far})}equals(t){return!KB(t)||!(t instanceof kr)?!1:(this._update(),t._update(),this.fov===t.fov&&this.aspectRatio===t.aspectRatio&&this.near===t.near&&this.far===t.far&&this._offCenterFrustum.equals(t._offCenterFrustum))}get projectionMatrix(){return this._update(),this._offCenterFrustum.projectionMatrix}get infiniteProjectionMatrix(){return this._update(),this._offCenterFrustum.infiniteProjectionMatrix}get fovy(){return this._update(),this._fovy}get sseDenominator(){return this._update(),this._sseDenominator}computeCullingVolume(t,r,s){return this._update(),this._offCenterFrustum.computeCullingVolume(t,r,s)}getPixelDimensions(t,r,s,i){return this._update(),this._offCenterFrustum.getPixelDimensions(t,r,s,i||new rs)}_update(){Y(Number.isFinite(this.fov)&&Number.isFinite(this.aspectRatio)&&Number.isFinite(this.near)&&Number.isFinite(this.far));const t=this._offCenterFrustum;(this.fov!==this._fov||this.aspectRatio!==this._aspectRatio||this.near!==this._near||this.far!==this._far||this.xOffset!==this._xOffset||this.yOffset!==this._yOffset)&&(Y(this.fov>=0&&this.fov<Math.PI),Y(this.aspectRatio>0),Y(this.near>=0&&this.near<this.far),this._aspectRatio=this.aspectRatio,this._fov=this.fov,this._fovy=this.aspectRatio<=1?this.fov:Math.atan(Math.tan(this.fov*.5)/this.aspectRatio)*2,this._near=this.near,this._far=this.far,this._sseDenominator=2*Math.tan(.5*this._fovy),this._xOffset=this.xOffset,this._yOffset=this.yOffset,t.top=this.near*Math.tan(.5*this._fovy),t.bottom=-t.top,t.right=this.aspectRatio*t.top,t.left=-t.right,t.near=this.near,t.far=this.far,t.right+=this.xOffset,t.left+=this.xOffset,t.top+=this.yOffset,t.bottom+=this.yOffset)}}new f;new f;new f;new f;new f;new f;new f;new f;new f;new f;new f;new f;const Nt=new Z,jB=new Z,VB=new Z,yr=new Z,iA=new Z;function YB(e,t={}){const r=IB,s=10;let i=0,n=0;const A=jB,o=VB;A.identity(),o.copy(e);const a=r*WB(o);for(;n<s&&XB(o)>a;)zB(o,yr),iA.copy(yr).transpose(),o.multiplyRight(yr),o.multiplyLeft(iA),A.multiplyRight(yr),++i>2&&(++n,i=0);return t.unitary=A.toTarget(t.unitary),t.diagonal=o.toTarget(t.diagonal),t}function WB(e){let t=0;for(let r=0;r<9;++r){const s=e[r];t+=s*s}return Math.sqrt(t)}const hi=[1,0,0],ui=[2,2,1];function XB(e){let t=0;for(let r=0;r<3;++r){const s=e[Nt.getElementIndex(ui[r],hi[r])];t+=2*s*s}return Math.sqrt(t)}function zB(e,t){const r=ba;let s=0,i=1;for(let c=0;c<3;++c){const h=Math.abs(e[Nt.getElementIndex(ui[c],hi[c])]);h>s&&(i=c,s=h)}const n=hi[i],A=ui[i];let o=1,a=0;if(Math.abs(e[Nt.getElementIndex(A,n)])>r){const c=e[Nt.getElementIndex(A,A)],h=e[Nt.getElementIndex(n,n)],u=e[Nt.getElementIndex(A,n)],g=(c-h)/2/u;let l;g<0?l=-1/(-g+Math.sqrt(1+g*g)):l=1/(g+Math.sqrt(1+g*g)),o=1/Math.sqrt(1+l*l),a=l*o}return Z.IDENTITY.to(t),t[Nt.getElementIndex(n,n)]=t[Nt.getElementIndex(A,A)]=o,t[Nt.getElementIndex(A,n)]=a,t[Nt.getElementIndex(n,A)]=-a,t}const Zt=new f,ZB=new f,$B=new f,td=new f,ed=new f,rd=new Z,sd={diagonal:new Z,unitary:new Z};function id(e,t=new ar){if(!e||e.length===0)return t.halfAxes=new Z([0,0,0,0,0,0,0,0,0]),t.center=new f,t;const r=e.length,s=new f(0,0,0);for(const _ of e)s.add(_);const i=1/r;s.multiplyByScalar(i);let n=0,A=0,o=0,a=0,c=0,h=0;for(const _ of e){const v=Zt.copy(_).subtract(s);n+=v.x*v.x,A+=v.x*v.y,o+=v.x*v.z,a+=v.y*v.y,c+=v.y*v.z,h+=v.z*v.z}n*=i,A*=i,o*=i,a*=i,c*=i,h*=i;const u=rd;u[0]=n,u[1]=A,u[2]=o,u[3]=A,u[4]=a,u[5]=c,u[6]=o,u[7]=c,u[8]=h;const{unitary:g}=YB(u,sd),l=t.halfAxes.copy(g);let B=l.getColumn(0,$B),d=l.getColumn(1,td),C=l.getColumn(2,ed),m=-Number.MAX_VALUE,w=-Number.MAX_VALUE,E=-Number.MAX_VALUE,p=Number.MAX_VALUE,R=Number.MAX_VALUE,y=Number.MAX_VALUE;for(const _ of e)Zt.copy(_),m=Math.max(Zt.dot(B),m),w=Math.max(Zt.dot(d),w),E=Math.max(Zt.dot(C),E),p=Math.min(Zt.dot(B),p),R=Math.min(Zt.dot(d),R),y=Math.min(Zt.dot(C),y);B=B.multiplyByScalar(.5*(p+m)),d=d.multiplyByScalar(.5*(R+w)),C=C.multiplyByScalar(.5*(y+E)),t.center.copy(B).add(d).add(C);const T=ZB.set(m-p,w-R,E-y).multiplyByScalar(.5),G=new Z([T[0],0,0,0,T[1],0,0,0,T[2]]);return t.halfAxes.multiplyRight(G),t}let nA=function(e){return e[e.ADD=1]="ADD",e[e.REPLACE=2]="REPLACE",e}({}),Qr=function(e){return e.EMPTY="empty",e.SCENEGRAPH="scenegraph",e.POINTCLOUD="pointcloud",e.MESH="mesh",e}({}),nd=function(e){return e.I3S="I3S",e.TILES3D="TILES3D",e}({}),is=function(e){return e.GEOMETRIC_ERROR="geometricError",e.MAX_SCREEN_THRESHOLD="maxScreenThreshold",e}({});const Da="4.1.1",ve={COMPOSITE:"cmpt",POINT_CLOUD:"pnts",BATCHED_3D_MODEL:"b3dm",INSTANCED_3D_MODEL:"i3dm",GEOMETRY:"geom",VECTOR:"vect",GLTF:"glTF"};function Ra(e,t,r){X(e instanceof ArrayBuffer);const s=new TextDecoder("utf8"),i=new Uint8Array(e,t,r);return s.decode(i)}function Ad(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const r=new DataView(e);return`${String.fromCharCode(r.getUint8(t+0))}${String.fromCharCode(r.getUint8(t+1))}${String.fromCharCode(r.getUint8(t+2))}${String.fromCharCode(r.getUint8(t+3))}`}const od="4.1.1",ad={name:"Draco",id:"draco",module:"draco",version:od,worker:!0,extensions:["drc"],mimeTypes:["application/octet-stream"],binary:!0,tests:["DRACO"],options:{draco:{decoderType:typeof WebAssembly=="object"?"wasm":"js",libraryPath:"libs/",extraAttributes:{},attributeNameEntry:void 0}}};function cd(e,t,r){const s=Sa(t.metadata),i=[],n=hd(t.attributes);for(const A in e){const o=e[A],a=AA(A,o,n[A]);i.push(a)}if(r){const A=AA("indices",r);i.push(A)}return{fields:i,metadata:s}}function hd(e){const t={};for(const r in e){const s=e[r];t[s.name||"undefined"]=s}return t}function AA(e,t,r){const s=r?Sa(r.metadata):void 0;return Ol(e,t,s)}function Sa(e){Object.entries(e);const t={};for(const r in e)t[`${r}.string`]=JSON.stringify(e[r]);return t}const oA={POSITION:"POSITION",NORMAL:"NORMAL",COLOR:"COLOR_0",TEX_COORD:"TEXCOORD_0"},ud={1:Int8Array,2:Uint8Array,3:Int16Array,4:Uint16Array,5:Int32Array,6:Uint32Array,9:Float32Array},ld=4;class gd{constructor(t){this.draco=void 0,this.decoder=void 0,this.metadataQuerier=void 0,this.draco=t,this.decoder=new this.draco.Decoder,this.metadataQuerier=new this.draco.MetadataQuerier}destroy(){this.draco.destroy(this.decoder),this.draco.destroy(this.metadataQuerier)}parseSync(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const s=new this.draco.DecoderBuffer;s.Init(new Int8Array(t),t.byteLength),this._disableAttributeTransforms(r);const i=this.decoder.GetEncodedGeometryType(s),n=i===this.draco.TRIANGULAR_MESH?new this.draco.Mesh:new this.draco.PointCloud;try{let A;switch(i){case this.draco.TRIANGULAR_MESH:A=this.decoder.DecodeBufferToMesh(s,n);break;case this.draco.POINT_CLOUD:A=this.decoder.DecodeBufferToPointCloud(s,n);break;default:throw new Error("DRACO: Unknown geometry type.")}if(!A.ok()||!n.ptr){const u=`DRACO decompression failed: ${A.error_msg()}`;throw new Error(u)}const o=this._getDracoLoaderData(n,i,r),a=this._getMeshData(n,o,r),c=Ul(a.attributes),h=cd(a.attributes,o,a.indices);return{loader:"draco",loaderData:o,header:{vertexCount:n.num_points(),boundingBox:c},...a,schema:h}}finally{this.draco.destroy(s),n&&this.draco.destroy(n)}}_getDracoLoaderData(t,r,s){const i=this._getTopLevelMetadata(t),n=this._getDracoAttributes(t,s);return{geometry_type:r,num_attributes:t.num_attributes(),num_points:t.num_points(),num_faces:t instanceof this.draco.Mesh?t.num_faces():0,metadata:i,attributes:n}}_getDracoAttributes(t,r){const s={};for(let i=0;i<t.num_attributes();i++){const n=this.decoder.GetAttribute(t,i),A=this._getAttributeMetadata(t,i);s[n.unique_id()]={unique_id:n.unique_id(),attribute_type:n.attribute_type(),data_type:n.data_type(),num_components:n.num_components(),byte_offset:n.byte_offset(),byte_stride:n.byte_stride(),normalized:n.normalized(),attribute_index:i,metadata:A};const o=this._getQuantizationTransform(n,r);o&&(s[n.unique_id()].quantization_transform=o);const a=this._getOctahedronTransform(n,r);a&&(s[n.unique_id()].octahedron_transform=a)}return s}_getMeshData(t,r,s){const i=this._getMeshAttributes(r,t,s);if(!i.POSITION)throw new Error("DRACO: No position attribute found.");if(t instanceof this.draco.Mesh)switch(s.topology){case"triangle-strip":return{topology:"triangle-strip",mode:4,attributes:i,indices:{value:this._getTriangleStripIndices(t),size:1}};case"triangle-list":default:return{topology:"triangle-list",mode:5,attributes:i,indices:{value:this._getTriangleListIndices(t),size:1}}}return{topology:"point-list",mode:0,attributes:i}}_getMeshAttributes(t,r,s){const i={};for(const n of Object.values(t.attributes)){const A=this._deduceAttributeName(n,s);n.name=A;const{value:o,size:a}=this._getAttributeValues(r,n);i[A]={value:o,size:a,byteOffset:n.byte_offset,byteStride:n.byte_stride,normalized:n.normalized}}return i}_getTriangleListIndices(t){const r=t.num_faces()*3,s=r*ld,i=this.draco._malloc(s);try{return this.decoder.GetTrianglesUInt32Array(t,s,i),new Uint32Array(this.draco.HEAPF32.buffer,i,r).slice()}finally{this.draco._free(i)}}_getTriangleStripIndices(t){const r=new this.draco.DracoInt32Array;try{return this.decoder.GetTriangleStripsFromMesh(t,r),fd(r)}finally{this.draco.destroy(r)}}_getAttributeValues(t,r){const s=ud[r.data_type],i=r.num_components,n=t.num_points()*i,A=n*s.BYTES_PER_ELEMENT,o=Bd(this.draco,s);let a;const c=this.draco._malloc(A);try{const h=this.decoder.GetAttribute(t,r.attribute_index);this.decoder.GetAttributeDataArrayForAllPoints(t,h,o,A,c),a=new s(this.draco.HEAPF32.buffer,c,n).slice()}finally{this.draco._free(c)}return{value:a,size:i}}_deduceAttributeName(t,r){const s=t.unique_id;for(const[A,o]of Object.entries(r.extraAttributes||{}))if(o===s)return A;const i=t.attribute_type;for(const A in oA)if(this.draco[A]===i)return oA[A];const n=r.attributeNameEntry||"name";return t.metadata[n]?t.metadata[n].string:`CUSTOM_ATTRIBUTE_${s}`}_getTopLevelMetadata(t){const r=this.decoder.GetMetadata(t);return this._getDracoMetadata(r)}_getAttributeMetadata(t,r){const s=this.decoder.GetAttributeMetadata(t,r);return this._getDracoMetadata(s)}_getDracoMetadata(t){if(!t||!t.ptr)return{};const r={},s=this.metadataQuerier.NumEntries(t);for(let i=0;i<s;i++){const n=this.metadataQuerier.GetEntryName(t,i);r[n]=this._getDracoMetadataField(t,n)}return r}_getDracoMetadataField(t,r){const s=new this.draco.DracoInt32Array;try{this.metadataQuerier.GetIntEntryArray(t,r,s);const i=dd(s);return{int:this.metadataQuerier.GetIntEntry(t,r),string:this.metadataQuerier.GetStringEntry(t,r),double:this.metadataQuerier.GetDoubleEntry(t,r),intArray:i}}finally{this.draco.destroy(s)}}_disableAttributeTransforms(t){const{quantizedAttributes:r=[],octahedronAttributes:s=[]}=t,i=[...r,...s];for(const n of i)this.decoder.SkipAttributeTransform(this.draco[n])}_getQuantizationTransform(t,r){const{quantizedAttributes:s=[]}=r,i=t.attribute_type();if(s.map(n=>this.decoder[n]).includes(i)){const n=new this.draco.AttributeQuantizationTransform;try{if(n.InitFromAttribute(t))return{quantization_bits:n.quantization_bits(),range:n.range(),min_values:new Float32Array([1,2,3]).map(A=>n.min_value(A))}}finally{this.draco.destroy(n)}}return null}_getOctahedronTransform(t,r){const{octahedronAttributes:s=[]}=r,i=t.attribute_type();if(s.map(n=>this.decoder[n]).includes(i)){const n=new this.draco.AttributeQuantizationTransform;try{if(n.InitFromAttribute(t))return{quantization_bits:n.quantization_bits()}}finally{this.draco.destroy(n)}}return null}}function Bd(e,t){switch(t){case Float32Array:return e.DT_FLOAT32;case Int8Array:return e.DT_INT8;case Int16Array:return e.DT_INT16;case Int32Array:return e.DT_INT32;case Uint8Array:return e.DT_UINT8;case Uint16Array:return e.DT_UINT16;case Uint32Array:return e.DT_UINT32;default:return e.DT_INVALID}}function dd(e){const t=e.size(),r=new Int32Array(t);for(let s=0;s<t;s++)r[s]=e.GetValue(s);return r}function fd(e){const t=e.size(),r=new Int32Array(t);for(let s=0;s<t;s++)r[s]=e.GetValue(s);return r}const Cd="1.5.6",Id="1.4.1",Gs=`https://www.gstatic.com/draco/versioned/decoders/${Cd}`,It={DECODER:"draco_wasm_wrapper.js",DECODER_WASM:"draco_decoder.wasm",FALLBACK_DECODER:"draco_decoder.js",ENCODER:"draco_encoder.js"},vs={[It.DECODER]:`${Gs}/${It.DECODER}`,[It.DECODER_WASM]:`${Gs}/${It.DECODER_WASM}`,[It.FALLBACK_DECODER]:`${Gs}/${It.FALLBACK_DECODER}`,[It.ENCODER]:`https://raw.githubusercontent.com/google/draco/${Id}/javascript/${It.ENCODER}`};let Le;async function Ed(e){const t=e.modules||{};return t.draco3d?Le=Le||t.draco3d.createDecoderModule({}).then(r=>({draco:r})):Le=Le||md(e),await Le}async function md(e){let t,r;switch(e.draco&&e.draco.decoderType){case"js":t=await ae(vs[It.FALLBACK_DECODER],"draco",e,It.FALLBACK_DECODER);break;case"wasm":default:[t,r]=await Promise.all([await ae(vs[It.DECODER],"draco",e,It.DECODER),await ae(vs[It.DECODER_WASM],"draco",e,It.DECODER_WASM)])}return t=t||globalThis.DracoDecoderModule,await pd(t,r)}function pd(e,t){const r={};return t&&(r.wasmBinary=t),new Promise(s=>{e({...r,onModuleLoaded:i=>s({draco:i})})})}const Ta={...ad,parse:yd};async function yd(e,t){const{draco:r}=await Ed(t),s=new gd(r);try{return s.parseSync(e,t==null?void 0:t.draco)}finally{s.destroy()}}const Qd={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},rt={BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DOUBLE:5130},U={...Qd,...rt},Ls={[rt.DOUBLE]:Float64Array,[rt.FLOAT]:Float32Array,[rt.UNSIGNED_SHORT]:Uint16Array,[rt.UNSIGNED_INT]:Uint32Array,[rt.UNSIGNED_BYTE]:Uint8Array,[rt.BYTE]:Int8Array,[rt.SHORT]:Int16Array,[rt.INT]:Int32Array},wd={DOUBLE:rt.DOUBLE,FLOAT:rt.FLOAT,UNSIGNED_SHORT:rt.UNSIGNED_SHORT,UNSIGNED_INT:rt.UNSIGNED_INT,UNSIGNED_BYTE:rt.UNSIGNED_BYTE,BYTE:rt.BYTE,SHORT:rt.SHORT,INT:rt.INT},xs="Failed to convert GL type";class Jt{static fromTypedArray(t){t=ArrayBuffer.isView(t)?t.constructor:t;for(const r in Ls)if(Ls[r]===t)return r;throw new Error(xs)}static fromName(t){const r=wd[t];if(!r)throw new Error(xs);return r}static getArrayType(t){switch(t){case rt.UNSIGNED_SHORT_5_6_5:case rt.UNSIGNED_SHORT_4_4_4_4:case rt.UNSIGNED_SHORT_5_5_5_1:return Uint16Array;default:const r=Ls[t];if(!r)throw new Error(xs);return r}}static getByteSize(t){return Jt.getArrayType(t).BYTES_PER_ELEMENT}static validate(t){return!!Jt.getArrayType(t)}static createTypedArray(t,r){let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3?arguments[3]:void 0;i===void 0&&(i=(r.byteLength-s)/Jt.getByteSize(t));const n=Jt.getArrayType(t);return new n(r,s,i)}}function bd(e,t){if(!e)throw new Error(`math.gl assertion failed. ${t}`)}function Dd(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[0,0,0];const r=e>>11&31,s=e>>5&63,i=e&31;return t[0]=r<<3,t[1]=s<<2,t[2]=i<<3,t}new rs;new f;new rs;new rs;function aA(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:255;return Vl(e,0,t)/t*2-1}function cA(e){return e<0?-1:1}function Rd(e,t,r,s){if(bd(s),e<0||e>r||t<0||t>r)throw new Error(`x and y must be unsigned normalized integers between 0 and ${r}`);if(s.x=aA(e,r),s.y=aA(t,r),s.z=1-(Math.abs(s.x)+Math.abs(s.y)),s.z<0){const i=s.x;s.x=(1-Math.abs(s.y))*cA(i),s.y=(1-Math.abs(i))*cA(s.y)}return s.normalize()}function Sd(e,t,r){return Rd(e,t,255,r)}class Ki{constructor(t,r){this.json=void 0,this.buffer=void 0,this.featuresLength=0,this._cachedTypedArrays={},this.json=t,this.buffer=r}getExtension(t){return this.json.extensions&&this.json.extensions[t]}hasProperty(t){return!!this.json[t]}getGlobalProperty(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:U.UNSIGNED_INT,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?this._getTypedArrayFromBinary(t,r,s,1,i.byteOffset):i}getPropertyArray(t,r,s){const i=this.json[t];return i&&Number.isFinite(i.byteOffset)?("componentType"in i&&(r=Jt.fromName(i.componentType)),this._getTypedArrayFromBinary(t,r,s,this.featuresLength,i.byteOffset)):this._getTypedArrayFromArray(t,r,i)}getProperty(t,r,s,i,n){const A=this.json[t];if(!A)return A;const o=this.getPropertyArray(t,r,s);if(s===1)return o[i];for(let a=0;a<s;++a)n[a]=o[s*i+a];return n}_getTypedArrayFromBinary(t,r,s,i,n){const A=this._cachedTypedArrays;let o=A[t];return o||(o=Jt.createTypedArray(r,this.buffer.buffer,this.buffer.byteOffset+n,i*s),A[t]=o),o}_getTypedArrayFromArray(t,r,s){const i=this._cachedTypedArrays;let n=i[t];return n||(n=Jt.createTypedArray(r,s),i[t]=n),n}}const Td={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},_d={SCALAR:(e,t)=>e[t],VEC2:(e,t)=>[e[2*t+0],e[2*t+1]],VEC3:(e,t)=>[e[3*t+0],e[3*t+1],e[3*t+2]],VEC4:(e,t)=>[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]],MAT2:(e,t)=>[e[4*t+0],e[4*t+1],e[4*t+2],e[4*t+3]],MAT3:(e,t)=>[e[9*t+0],e[9*t+1],e[9*t+2],e[9*t+3],e[9*t+4],e[9*t+5],e[9*t+6],e[9*t+7],e[9*t+8]],MAT4:(e,t)=>[e[16*t+0],e[16*t+1],e[16*t+2],e[16*t+3],e[16*t+4],e[16*t+5],e[16*t+6],e[16*t+7],e[16*t+8],e[16*t+9],e[16*t+10],e[16*t+11],e[16*t+12],e[16*t+13],e[16*t+14],e[16*t+15]]},Md={SCALAR:(e,t,r)=>{t[r]=e},VEC2:(e,t,r)=>{t[2*r+0]=e[0],t[2*r+1]=e[1]},VEC3:(e,t,r)=>{t[3*r+0]=e[0],t[3*r+1]=e[1],t[3*r+2]=e[2]},VEC4:(e,t,r)=>{t[4*r+0]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]},MAT2:(e,t,r)=>{t[4*r+0]=e[0],t[4*r+1]=e[1],t[4*r+2]=e[2],t[4*r+3]=e[3]},MAT3:(e,t,r)=>{t[9*r+0]=e[0],t[9*r+1]=e[1],t[9*r+2]=e[2],t[9*r+3]=e[3],t[9*r+4]=e[4],t[9*r+5]=e[5],t[9*r+6]=e[6],t[9*r+7]=e[7],t[9*r+8]=e[8],t[9*r+9]=e[9]},MAT4:(e,t,r)=>{t[16*r+0]=e[0],t[16*r+1]=e[1],t[16*r+2]=e[2],t[16*r+3]=e[3],t[16*r+4]=e[4],t[16*r+5]=e[5],t[16*r+6]=e[6],t[16*r+7]=e[7],t[16*r+8]=e[8],t[16*r+9]=e[9],t[16*r+10]=e[10],t[16*r+11]=e[11],t[16*r+12]=e[12],t[16*r+13]=e[13],t[16*r+14]=e[14],t[16*r+15]=e[15]}};function Fd(e,t,r,s){const{componentType:i}=e;X(e.componentType);const n=typeof i=="string"?Jt.fromName(i):i,A=Td[e.type],o=_d[e.type],a=Md[e.type];return r+=e.byteOffset,{values:Jt.createTypedArray(n,t,r,A*s),type:n,size:A,unpacker:o,packer:a}}const Pt=e=>e!==void 0;function Gd(e,t,r){if(!t)return null;let s=e.getExtension("3DTILES_batch_table_hierarchy");const i=t.HIERARCHY;return i&&(console.warn("3D Tile Parser: HIERARCHY is deprecated. Use 3DTILES_batch_table_hierarchy."),t.extensions=t.extensions||{},t.extensions["3DTILES_batch_table_hierarchy"]=i,s=i),s?vd(s,r):null}function vd(e,t){let r,s,i;const n=e.instancesLength,A=e.classes;let o=e.classIds,a=e.parentCounts,c=e.parentIds,h=n;Pt(o.byteOffset)&&(o.componentType=defaultValue(o.componentType,GL.UNSIGNED_SHORT),o.type=AttributeType.SCALAR,i=getBinaryAccessor(o),o=i.createArrayBufferView(t.buffer,t.byteOffset+o.byteOffset,n));let u;if(Pt(a))for(Pt(a.byteOffset)&&(a.componentType=defaultValue(a.componentType,GL.UNSIGNED_SHORT),a.type=AttributeType.SCALAR,i=getBinaryAccessor(a),a=i.createArrayBufferView(t.buffer,t.byteOffset+a.byteOffset,n)),u=new Uint16Array(n),h=0,r=0;r<n;++r)u[r]=h,h+=a[r];Pt(c)&&Pt(c.byteOffset)&&(c.componentType=defaultValue(c.componentType,GL.UNSIGNED_SHORT),c.type=AttributeType.SCALAR,i=getBinaryAccessor(c),c=i.createArrayBufferView(t.buffer,t.byteOffset+c.byteOffset,h));const g=A.length;for(r=0;r<g;++r){const C=A[r].length,m=A[r].instances,w=getBinaryProperties(C,m,t);A[r].instances=combine(w,m)}const l=new Array(g).fill(0),B=new Uint16Array(n);for(r=0;r<n;++r)s=o[r],B[r]=l[s],++l[s];const d={classes:A,classIds:o,classIndexes:B,parentCounts:a,parentIndexes:u,parentIds:c};return Ud(d),d}function xe(e,t,r){if(!e)return;const s=e.parentCounts;return e.parentIds?r(e,t):s>0?Ld(e,t,r):xd(e,t,r)}function Ld(e,t,r){const s=e.classIds,i=e.parentCounts,n=e.parentIds,A=e.parentIndexes,o=s.length,a=scratchVisited;a.length=Math.max(a.length,o);const c=++marker,h=scratchStack;for(h.length=0,h.push(t);h.length>0;){if(t=h.pop(),a[t]===c)continue;a[t]=c;const u=r(e,t);if(Pt(u))return u;const g=i[t],l=A[t];for(let B=0;B<g;++B){const d=n[l+B];d!==t&&h.push(d)}}return null}function xd(e,t,r){let s=!0;for(;s;){const i=r(e,t);if(Pt(i))return i;const n=e.parentIds[t];s=n!==t,t=n}throw new Error("traverseHierarchySingleParent")}function Ud(e){const t=e.classIds.length;for(let r=0;r<t;++r)_a(e,r,stack)}function _a(e,t,r){const s=e.parentCounts,i=e.parentIds,n=e.parentIndexes,A=e.classIds.length;if(!Pt(i))return;assert(t<A,`Parent index ${t} exceeds the total number of instances: ${A}`),assert(r.indexOf(t)===-1,"Circular dependency detected in the batch table hierarchy."),r.push(t);const o=Pt(s)?s[t]:1,a=Pt(s)?n[t]:t;for(let c=0;c<o;++c){const h=i[a+c];h!==t&&_a(e,h,r)}r.pop(t)}function dt(e){return e!=null}const wr=(e,t)=>e,Od={HIERARCHY:!0,extensions:!0,extras:!0};class Ma{constructor(t,r,s){var i;let n=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.json=void 0,this.binary=void 0,this.featureCount=void 0,this._extensions=void 0,this._properties=void 0,this._binaryProperties=void 0,this._hierarchy=void 0,X(s>=0),this.json=t||{},this.binary=r,this.featureCount=s,this._extensions=((i=this.json)===null||i===void 0?void 0:i.extensions)||{},this._properties={};for(const A in this.json)Od[A]||(this._properties[A]=this.json[A]);this._binaryProperties=this._initializeBinaryProperties(),n["3DTILES_batch_table_hierarchy"]&&(this._hierarchy=Gd(this,this.json,this.binary))}getExtension(t){return this.json&&this.json.extensions&&this.json.extensions[t]}memorySizeInBytes(){return 0}isClass(t,r){if(this._checkBatchId(t),X(typeof r=="string",r),this._hierarchy){const s=xe(this._hierarchy,t,(i,n)=>{const A=i.classIds[n];return i.classes[A].name===r});return dt(s)}return!1}isExactClass(t,r){return X(typeof r=="string",r),this.getExactClassName(t)===r}getExactClassName(t){if(this._checkBatchId(t),this._hierarchy){const r=this._hierarchy.classIds[t];return this._hierarchy.classes[r].name}}hasProperty(t,r){return this._checkBatchId(t),X(typeof r=="string",r),dt(this._properties[r])||this._hasPropertyInHierarchy(t,r)}getPropertyNames(t,r){this._checkBatchId(t),r=dt(r)?r:[],r.length=0;const s=Object.keys(this._properties);return r.push(...s),this._hierarchy&&this._getPropertyNamesInHierarchy(t,r),r}getProperty(t,r){if(this._checkBatchId(t),X(typeof r=="string",r),this._binaryProperties){const i=this._binaryProperties[r];if(dt(i))return this._getBinaryProperty(i,t)}const s=this._properties[r];if(dt(s))return wr(s[t]);if(this._hierarchy){const i=this._getHierarchyProperty(t,r);if(dt(i))return i}}setProperty(t,r,s){const i=this.featureCount;if(this._checkBatchId(t),X(typeof r=="string",r),this._binaryProperties){const A=this._binaryProperties[r];if(A){this._setBinaryProperty(A,t,s);return}}if(this._hierarchy&&this._setHierarchyProperty(this,t,r,s))return;let n=this._properties[r];dt(n)||(this._properties[r]=new Array(i),n=this._properties[r]),n[t]=wr(s)}_checkBatchId(t){if(!(t>=0&&t<this.featureCount))throw new Error("batchId not in range [0, featureCount - 1].")}_getBinaryProperty(t,r){return t.unpack(t.typedArray,r)}_setBinaryProperty(t,r,s){t.pack(s,t.typedArray,r)}_initializeBinaryProperties(){let t=null;for(const r in this._properties){const s=this._properties[r],i=this._initializeBinaryProperty(r,s);i&&(t=t||{},t[r]=i)}return t}_initializeBinaryProperty(t,r){if("byteOffset"in r){const s=r;X(this.binary,`Property ${t} requires a batch table binary.`),X(s.type,`Property ${t} requires a type.`);const i=Fd(s,this.binary.buffer,this.binary.byteOffset|0,this.featureCount);return{typedArray:i.values,componentCount:i.size,unpack:i.unpacker,pack:i.packer}}return null}_hasPropertyInHierarchy(t,r){if(!this._hierarchy)return!1;const s=xe(this._hierarchy,t,(i,n)=>{const A=i.classIds[n],o=i.classes[A].instances;return dt(o[r])});return dt(s)}_getPropertyNamesInHierarchy(t,r){xe(this._hierarchy,t,(s,i)=>{const n=s.classIds[i],A=s.classes[n].instances;for(const o in A)A.hasOwnProperty(o)&&r.indexOf(o)===-1&&r.push(o)})}_getHierarchyProperty(t,r){return xe(this._hierarchy,t,(s,i)=>{const n=s.classIds[i],A=s.classes[n],o=s.classIndexes[i],a=A.instances[r];return dt(a)?dt(a.typedArray)?this._getBinaryProperty(a,o):wr(a[o]):null})}_setHierarchyProperty(t,r,s,i){const n=xe(this._hierarchy,r,(A,o)=>{const a=A.classIds[o],c=A.classes[a],h=A.classIndexes[o],u=c.instances[s];return dt(u)?(X(o===r,`Inherited property "${s}" is read-only.`),dt(u.typedArray)?this._setBinaryProperty(u,h,i):u[h]=wr(i),!0):!1});return dt(n)}}const Us=4;function ns(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=new DataView(t);if(e.magic=s.getUint32(r,!0),r+=Us,e.version=s.getUint32(r,!0),r+=Us,e.byteLength=s.getUint32(r,!0),r+=Us,e.version!==1)throw new Error(`3D Tile Version ${e.version} not supported`);return r}const Ee=4,hA="b3dm tile in legacy format.";function ji(e,t,r){const s=new DataView(t);let i;e.header=e.header||{};let n=s.getUint32(r,!0);r+=Ee;let A=s.getUint32(r,!0);r+=Ee;let o=s.getUint32(r,!0);r+=Ee;let a=s.getUint32(r,!0);return r+=Ee,o>=570425344?(r-=Ee*2,i=n,o=A,a=0,n=0,A=0,console.warn(hA)):a>=570425344&&(r-=Ee,i=o,o=n,a=A,n=0,A=0,console.warn(hA)),e.header.featureTableJsonByteLength=n,e.header.featureTableBinaryByteLength=A,e.header.batchTableJsonByteLength=o,e.header.batchTableBinaryByteLength=a,e.header.batchLength=i,r}function Vi(e,t,r,s){return r=Nd(e,t,r),r=Pd(e,t,r),r}function Nd(e,t,r,s){const{featureTableJsonByteLength:i,featureTableBinaryByteLength:n,batchLength:A}=e.header||{};if(e.featureTableJson={BATCH_LENGTH:A||0},i&&i>0){const o=Ra(t,r,i);e.featureTableJson=JSON.parse(o)}return r+=i||0,e.featureTableBinary=new Uint8Array(t,r,n),r+=n||0,r}function Pd(e,t,r,s){const{batchTableJsonByteLength:i,batchTableBinaryByteLength:n}=e.header||{};if(i&&i>0){const A=Ra(t,r,i);e.batchTableJson=JSON.parse(A),r+=i,n&&n>0&&(e.batchTableBinary=new Uint8Array(t,r,n),e.batchTableBinary=new Uint8Array(e.batchTableBinary),r+=n)}return r}function Fa(e,t,r){if(!t&&(!e||!e.batchIds||!r))return null;const{batchIds:s,isRGB565:i,pointCount:n=0}=e;if(s&&r){const A=new Uint8ClampedArray(n*3);for(let o=0;o<n;o++){const a=s[o],c=r.getProperty(a,"dimensions").map(h=>h*255);A[o*3]=c[0],A[o*3+1]=c[1],A[o*3+2]=c[2]}return{type:U.UNSIGNED_BYTE,value:A,size:3,normalized:!0}}if(t&&i){const A=new Uint8ClampedArray(n*3);for(let o=0;o<n;o++){const a=Dd(t[o]);A[o*3]=a[0],A[o*3+1]=a[1],A[o*3+2]=a[2]}return{type:U.UNSIGNED_BYTE,value:A,size:3,normalized:!0}}return t&&t.length===n*3?{type:U.UNSIGNED_BYTE,value:t,size:3,normalized:!0}:{type:U.UNSIGNED_BYTE,value:t||new Uint8ClampedArray,size:4,normalized:!0}}const uA=new f;function Hd(e,t){if(!t)return null;if(e.isOctEncoded16P){const r=new Float32Array((e.pointsLength||0)*3);for(let s=0;s<(e.pointsLength||0);s++)Sd(t[s*2],t[s*2+1],uA),uA.toArray(r,s*3);return{type:U.FLOAT,size:2,value:r}}return{type:U.FLOAT,size:2,value:t}}function Jd(e,t,r){return e.isQuantized?r["3d-tiles"]&&r["3d-tiles"].decodeQuantizedPositions?(e.isQuantized=!1,kd(e,t)):{type:U.UNSIGNED_SHORT,value:t,size:3,normalized:!0}:t}function kd(e,t){const r=new f,s=new Float32Array(e.pointCount*3);for(let i=0;i<e.pointCount;i++)r.set(t[i*3],t[i*3+1],t[i*3+2]).scale(1/e.quantizedRange).multiply(e.quantizedVolumeScale).add(e.quantizedVolumeOffset).toArray(s,i*3);return s}async function qd(e,t,r,s,i){r=ns(e,t,r),r=ji(e,t,r),r=Vi(e,t,r),Kd(e);const{featureTable:n,batchTable:A}=jd(e);return await zd(e,n,A,s,i),Vd(e,n,s),Yd(e,n,A),Wd(e,n),r}function Kd(e){e.attributes={positions:null,colors:null,normals:null,batchIds:null},e.isQuantized=!1,e.isTranslucent=!1,e.isRGB565=!1,e.isOctEncoded16P=!1}function jd(e){const t=new Ki(e.featureTableJson,e.featureTableBinary),r=t.getGlobalProperty("POINTS_LENGTH");if(!Number.isFinite(r))throw new Error("POINTS_LENGTH must be defined");t.featuresLength=r,e.featuresLength=r,e.pointsLength=r,e.pointCount=r,e.rtcCenter=t.getGlobalProperty("RTC_CENTER",U.FLOAT,3);const s=Xd(e,t);return{featureTable:t,batchTable:s}}function Vd(e,t,r){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.positions){if(t.hasProperty("POSITION"))e.attributes.positions=t.getPropertyArray("POSITION",U.FLOAT,3);else if(t.hasProperty("POSITION_QUANTIZED")){const s=t.getPropertyArray("POSITION_QUANTIZED",U.UNSIGNED_SHORT,3);if(e.isQuantized=!0,e.quantizedRange=65535,e.quantizedVolumeScale=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",U.FLOAT,3),!e.quantizedVolumeScale)throw new Error("QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");if(e.quantizedVolumeOffset=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",U.FLOAT,3),!e.quantizedVolumeOffset)throw new Error("QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");e.attributes.positions=Jd(e,s,r)}}if(!e.attributes.positions)throw new Error("Either POSITION or POSITION_QUANTIZED must be defined.")}function Yd(e,t,r){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.colors){let s=null;t.hasProperty("RGBA")?(s=t.getPropertyArray("RGBA",U.UNSIGNED_BYTE,4),e.isTranslucent=!0):t.hasProperty("RGB")?s=t.getPropertyArray("RGB",U.UNSIGNED_BYTE,3):t.hasProperty("RGB565")&&(s=t.getPropertyArray("RGB565",U.UNSIGNED_SHORT,1),e.isRGB565=!0),e.attributes.colors=Fa(e,s,r)}t.hasProperty("CONSTANT_RGBA")&&(e.constantRGBA=t.getGlobalProperty("CONSTANT_RGBA",U.UNSIGNED_BYTE,4))}function Wd(e,t){if(e.attributes=e.attributes||{positions:null,colors:null,normals:null,batchIds:null},!e.attributes.normals){let r=null;t.hasProperty("NORMAL")?r=t.getPropertyArray("NORMAL",U.FLOAT,3):t.hasProperty("NORMAL_OCT16P")&&(r=t.getPropertyArray("NORMAL_OCT16P",U.UNSIGNED_BYTE,2),e.isOctEncoded16P=!0),e.attributes.normals=Hd(e,r)}}function Xd(e,t){let r=null;if(!e.batchIds&&t.hasProperty("BATCH_ID")&&(e.batchIds=t.getPropertyArray("BATCH_ID",U.UNSIGNED_SHORT,1),e.batchIds)){const s=t.getGlobalProperty("BATCH_LENGTH");if(!s)throw new Error("Global property: BATCH_LENGTH must be defined when BATCH_ID is defined.");const{batchTableJson:i,batchTableBinary:n}=e;r=new Ma(i,n,s)}return r}async function zd(e,t,r,s,i){let n,A,o;const a=e.batchTableJson&&e.batchTableJson.extensions&&e.batchTableJson.extensions["3DTILES_draco_point_compression"];a&&(o=a.properties);const c=t.getExtension("3DTILES_draco_point_compression");if(c){A=c.properties;const u=c.byteOffset,g=c.byteLength;if(!A||!Number.isFinite(u)||!g)throw new Error("Draco properties, byteOffset, and byteLength must be defined");n=(e.featureTableBinary||[]).slice(u,u+g),e.hasPositions=Number.isFinite(A.POSITION),e.hasColors=Number.isFinite(A.RGB)||Number.isFinite(A.RGBA),e.hasNormals=Number.isFinite(A.NORMAL),e.hasBatchIds=Number.isFinite(A.BATCH_ID),e.isTranslucent=Number.isFinite(A.RGBA)}if(!n)return!0;const h={buffer:n,properties:{...A,...o},featureTableProperties:A,batchTableProperties:o,dequantizeInShader:!1};return await Zd(e,h,s,i)}async function Zd(e,t,r,s){if(!s)return;const i={...r,draco:{...r==null?void 0:r.draco,extraAttributes:t.batchTableProperties||{}}};delete i["3d-tiles"];const n=await ir(t.buffer,Ta,i,s),A=n.attributes.POSITION&&n.attributes.POSITION.value,o=n.attributes.COLOR_0&&n.attributes.COLOR_0.value,a=n.attributes.NORMAL&&n.attributes.NORMAL.value,c=n.attributes.BATCH_ID&&n.attributes.BATCH_ID.value,h=A&&n.attributes.POSITION.value.quantization,u=a&&n.attributes.NORMAL.value.quantization;if(h){const l=n.POSITION.data.quantization,B=l.range;e.quantizedVolumeScale=new f(B,B,B),e.quantizedVolumeOffset=new f(l.minValues),e.quantizedRange=(1<<l.quantizationBits)-1,e.isQuantizedDraco=!0}u&&(e.octEncodedRange=(1<<n.NORMAL.data.quantization.quantizationBits)-1,e.isOctEncodedDraco=!0);const g={};if(t.batchTableProperties)for(const l of Object.keys(t.batchTableProperties))n.attributes[l]&&n.attributes[l].value&&(g[l.toLowerCase()]=n.attributes[l].value);e.attributes={positions:A,colors:Fa(e,o,void 0),normals:a,batchIds:c,...g}}const $d="4.1.1";var Os;const tf=(Os=globalThis.loaders)===null||Os===void 0?void 0:Os.parseImageNode,li=typeof Image<"u",gi=typeof ImageBitmap<"u",ef=!!tf,Bi=$r?!0:ef;function rf(e){switch(e){case"auto":return gi||li||Bi;case"imagebitmap":return gi;case"image":return li;case"data":return Bi;default:throw new Error(`@loaders.gl/images: image ${e} not supported in this environment`)}}function sf(){if(gi)return"imagebitmap";if(li)return"image";if(Bi)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function nf(e){const t=Af(e);if(!t)throw new Error("Not an image");return t}function Ga(e){switch(nf(e)){case"data":return e;case"image":case"imagebitmap":const t=document.createElement("canvas"),r=t.getContext("2d");if(!r)throw new Error("getImageData");return t.width=e.width,t.height=e.height,r.drawImage(e,0,0),r.getImageData(0,0,e.width,e.height);default:throw new Error("getImageData")}}function Af(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&e instanceof Image?"image":e&&typeof e=="object"&&e.data&&e.width&&e.height?"data":null}const of=/^data:image\/svg\+xml/,af=/\.svg((\?|#).*)?$/;function Yi(e){return e&&(of.test(e)||af.test(e))}function cf(e,t){if(Yi(t)){let r=new TextDecoder().decode(e);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(s){throw new Error(s.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return va(e,t)}function va(e,t){if(Yi(t))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(e)])}async function La(e,t,r){const s=cf(e,r),i=self.URL||self.webkitURL,n=typeof s!="string"&&i.createObjectURL(s);try{return await hf(n||s,t)}finally{n&&i.revokeObjectURL(n)}}async function hf(e,t){const r=new Image;return r.src=e,t.image&&t.image.decode&&r.decode?(await r.decode(),r):await new Promise((s,i)=>{try{r.onload=()=>s(r),r.onerror=n=>{const A=n instanceof Error?n.message:"error";i(new Error(A))}}catch(n){i(n)}})}const uf={};let lA=!0;async function lf(e,t,r){let s;Yi(r)?s=await La(e,t,r):s=va(e,r);const i=t&&t.imagebitmap;return await gf(s,i)}async function gf(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if((Bf(t)||!lA)&&(t=null),t)try{return await createImageBitmap(e,t)}catch(r){console.warn(r),lA=!1}return await createImageBitmap(e)}function Bf(e){for(const t in e||uf)return!1;return!0}function df(e){return!Ef(e,"ftyp",4)||!(e[8]&96)?null:ff(e)}function ff(e){switch(Cf(e,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function Cf(e,t,r){return String.fromCharCode(...e.slice(t,r))}function If(e){return[...e].map(t=>t.charCodeAt(0))}function Ef(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=If(t);for(let i=0;i<s.length;++i)if(s[i]!==e[i+r])return!1;return!0}const Ht=!1,je=!0;function Wi(e){const t=cr(e);return pf(t)||wf(t)||yf(t)||Qf(t)||mf(t)}function mf(e){const t=new Uint8Array(e instanceof DataView?e.buffer:e),r=df(t);return r?{mimeType:r.mimeType,width:0,height:0}:null}function pf(e){const t=cr(e);return t.byteLength>=24&&t.getUint32(0,Ht)===2303741511?{mimeType:"image/png",width:t.getUint32(16,Ht),height:t.getUint32(20,Ht)}:null}function yf(e){const t=cr(e);return t.byteLength>=10&&t.getUint32(0,Ht)===1195984440?{mimeType:"image/gif",width:t.getUint16(6,je),height:t.getUint16(8,je)}:null}function Qf(e){const t=cr(e);return t.byteLength>=14&&t.getUint16(0,Ht)===16973&&t.getUint32(2,je)===t.byteLength?{mimeType:"image/bmp",width:t.getUint32(18,je),height:t.getUint32(22,je)}:null}function wf(e){const t=cr(e);if(!(t.byteLength>=3&&t.getUint16(0,Ht)===65496&&t.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:s}=bf();let i=2;for(;i+9<t.byteLength;){const n=t.getUint16(i,Ht);if(s.has(n))return{mimeType:"image/jpeg",height:t.getUint16(i+5,Ht),width:t.getUint16(i+7,Ht)};if(!r.has(n))return null;i+=2,i+=t.getUint16(i,Ht)}return null}function bf(){const e=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)e.add(t);return{tableMarkers:e,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function cr(e){if(e instanceof DataView)return e;if(ArrayBuffer.isView(e))return new DataView(e.buffer);if(e instanceof ArrayBuffer)return new DataView(e);throw new Error("toDataView")}async function Df(e,t){var r;const{mimeType:s}=Wi(e)||{},i=(r=globalThis.loaders)===null||r===void 0?void 0:r.parseImageNode;return X(i),await i(e,s)}async function Rf(e,t,r){t=t||{};const s=(t.image||{}).type||"auto",{url:i}=r||{},n=Sf(s);let A;switch(n){case"imagebitmap":A=await lf(e,t,i);break;case"image":A=await La(e,t,i);break;case"data":A=await Df(e);break;default:X(!1)}return s==="data"&&(A=Ga(A)),A}function Sf(e){switch(e){case"auto":case"data":return sf();default:return rf(e),e}}const Tf=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],_f=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],Mf={image:{type:"auto",decode:!0}},Ff={id:"image",module:"images",name:"Images",version:$d,mimeTypes:_f,extensions:Tf,parse:Rf,tests:[e=>!!Wi(new DataView(e))],options:Mf},Ns={};function Gf(e){if(Ns[e]===void 0){const t=$r?Lf(e):vf(e);Ns[e]=t}return Ns[e]}function vf(e){var t,r;const s=["image/png","image/jpeg","image/gif"],i=((t=globalThis.loaders)===null||t===void 0?void 0:t.imageFormatsNode)||s;return!!(!((r=globalThis.loaders)===null||r===void 0)&&r.parseImageNode)&&i.includes(e)}function Lf(e){switch(e){case"image/avif":case"image/webp":return xf(e);default:return!0}}function xf(e){try{return document.createElement("canvas").toDataURL(e).indexOf(`data:${e}`)===0}catch{return!1}}function wt(e,t){if(!e)throw new Error(t||"assert failed: gltf")}const xa={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Ua={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Uf=1.33,gA=["SCALAR","VEC2","VEC3","VEC4"],Of=[[Int8Array,5120],[Uint8Array,5121],[Int16Array,5122],[Uint16Array,5123],[Uint32Array,5125],[Float32Array,5126],[Float64Array,5130]],Nf=new Map(Of),Pf={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Hf={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},Jf={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array};function Oa(e){return gA[e-1]||gA[0]}function Xi(e){const t=Nf.get(e.constructor);if(!t)throw new Error("Illegal typed array");return t}function zi(e,t){const r=Jf[e.componentType],s=Pf[e.type],i=Hf[e.componentType],n=e.count*s,A=e.count*s*i;wt(A>=0&&A<=t.byteLength);const o=Ua[e.componentType],a=xa[e.type];return{ArrayType:r,length:n,byteLength:A,componentByteSize:o,numberOfComponentsInElement:a}}function Na(e){let{images:t,bufferViews:r}=e;t=t||[],r=r||[];const s=t.map(A=>A.bufferView);r=r.filter(A=>!s.includes(A));const i=r.reduce((A,o)=>A+o.byteLength,0),n=t.reduce((A,o)=>{const{width:a,height:c}=o.image;return A+a*c},0);return i+Math.ceil(4*n*Uf)}function kf(e,t,r){const s=e.bufferViews[r];wt(s);const i=s.buffer,n=t[i];wt(n);const A=(s.byteOffset||0)+n.byteOffset;return new Uint8Array(n.arrayBuffer,A,s.byteLength)}function qf(e,t,r){var s,i;const n=typeof r=="number"?(s=e.accessors)===null||s===void 0?void 0:s[r]:r;if(!n)throw new Error(`No gltf accessor ${JSON.stringify(r)}`);const A=(i=e.bufferViews)===null||i===void 0?void 0:i[n.bufferView||0];if(!A)throw new Error(`No gltf buffer view for accessor ${A}`);const{arrayBuffer:o,byteOffset:a}=t[A.buffer],c=(a||0)+(n.byteOffset||0)+(A.byteOffset||0),{ArrayType:h,length:u,componentByteSize:g,numberOfComponentsInElement:l}=zi(n,A),B=g*l,d=A.byteStride||B;if(typeof A.byteStride>"u"||A.byteStride===B)return new h(o,c,u);const C=new h(u);for(let m=0;m<n.count;m++){const w=new h(o,c+m*d,l);C.set(w,m*l)}return C}function Kf(){return{asset:{version:"2.0",generator:"loaders.gl"},buffers:[],extensions:{},extensionsRequired:[],extensionsUsed:[]}}class ut{constructor(t){this.gltf=void 0,this.sourceBuffers=void 0,this.byteLength=void 0,this.gltf={json:(t==null?void 0:t.json)||Kf(),buffers:(t==null?void 0:t.buffers)||[],images:(t==null?void 0:t.images)||[]},this.sourceBuffers=[],this.byteLength=0,this.gltf.buffers&&this.gltf.buffers[0]&&(this.byteLength=this.gltf.buffers[0].byteLength,this.sourceBuffers=[this.gltf.buffers[0]])}get json(){return this.gltf.json}getApplicationData(t){return this.json[t]}getExtraData(t){return(this.json.extras||{})[t]}hasExtension(t){const r=this.getUsedExtensions().find(i=>i===t),s=this.getRequiredExtensions().find(i=>i===t);return typeof r=="string"||typeof s=="string"}getExtension(t){const r=this.getUsedExtensions().find(i=>i===t),s=this.json.extensions||{};return r?s[t]:null}getRequiredExtension(t){return this.getRequiredExtensions().find(r=>r===t)?this.getExtension(t):null}getRequiredExtensions(){return this.json.extensionsRequired||[]}getUsedExtensions(){return this.json.extensionsUsed||[]}getRemovedExtensions(){return this.json.extensionsRemoved||[]}getObjectExtension(t,r){return(t.extensions||{})[r]}getScene(t){return this.getObject("scenes",t)}getNode(t){return this.getObject("nodes",t)}getSkin(t){return this.getObject("skins",t)}getMesh(t){return this.getObject("meshes",t)}getMaterial(t){return this.getObject("materials",t)}getAccessor(t){return this.getObject("accessors",t)}getTexture(t){return this.getObject("textures",t)}getSampler(t){return this.getObject("samplers",t)}getImage(t){return this.getObject("images",t)}getBufferView(t){return this.getObject("bufferViews",t)}getBuffer(t){return this.getObject("buffers",t)}getObject(t,r){if(typeof r=="object")return r;const s=this.json[t]&&this.json[t][r];if(!s)throw new Error(`glTF file error: Could not find ${t}[${r}]`);return s}getTypedArrayForBufferView(t){t=this.getBufferView(t);const r=t.buffer,s=this.gltf.buffers[r];wt(s);const i=(t.byteOffset||0)+s.byteOffset;return new Uint8Array(s.arrayBuffer,i,t.byteLength)}getTypedArrayForAccessor(t){const r=this.getAccessor(t);return qf(this.gltf.json,this.gltf.buffers,r)}getTypedArrayForImageData(t){t=this.getAccessor(t);const r=this.getBufferView(t.bufferView),s=this.getBuffer(r.buffer).data,i=r.byteOffset||0;return new Uint8Array(s,i,r.byteLength)}addApplicationData(t,r){return this.json[t]=r,this}addExtraData(t,r){return this.json.extras=this.json.extras||{},this.json.extras[t]=r,this}addObjectExtension(t,r,s){return t.extensions=t.extensions||{},t.extensions[r]=s,this.registerUsedExtension(r),this}setObjectExtension(t,r,s){const i=t.extensions||{};i[r]=s}removeObjectExtension(t,r){const s=(t==null?void 0:t.extensions)||{};if(s[r]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const i=this.json.extensionsRemoved;i.includes(r)||i.push(r)}delete s[r]}addExtension(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return wt(r),this.json.extensions=this.json.extensions||{},this.json.extensions[t]=r,this.registerUsedExtension(t),r}addRequiredExtension(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return wt(r),this.addExtension(t,r),this.registerRequiredExtension(t),r}registerUsedExtension(t){this.json.extensionsUsed=this.json.extensionsUsed||[],this.json.extensionsUsed.find(r=>r===t)||this.json.extensionsUsed.push(t)}registerRequiredExtension(t){this.registerUsedExtension(t),this.json.extensionsRequired=this.json.extensionsRequired||[],this.json.extensionsRequired.find(r=>r===t)||this.json.extensionsRequired.push(t)}removeExtension(t){var r;if((r=this.json.extensions)!==null&&r!==void 0&&r[t]){this.json.extensionsRemoved=this.json.extensionsRemoved||[];const s=this.json.extensionsRemoved;s.includes(t)||s.push(t)}this.json.extensions&&delete this.json.extensions[t],this.json.extensionsRequired&&this._removeStringFromArray(this.json.extensionsRequired,t),this.json.extensionsUsed&&this._removeStringFromArray(this.json.extensionsUsed,t)}setDefaultScene(t){this.json.scene=t}addScene(t){const{nodeIndices:r}=t;return this.json.scenes=this.json.scenes||[],this.json.scenes.push({nodes:r}),this.json.scenes.length-1}addNode(t){const{meshIndex:r,matrix:s}=t;this.json.nodes=this.json.nodes||[];const i={mesh:r};return s&&(i.matrix=s),this.json.nodes.push(i),this.json.nodes.length-1}addMesh(t){const{attributes:r,indices:s,material:i,mode:n=4}=t,A={primitives:[{attributes:this._addAttributes(r),mode:n}]};if(s){const o=this._addIndices(s);A.primitives[0].indices=o}return Number.isFinite(i)&&(A.primitives[0].material=i),this.json.meshes=this.json.meshes||[],this.json.meshes.push(A),this.json.meshes.length-1}addPointCloud(t){const r={primitives:[{attributes:this._addAttributes(t),mode:0}]};return this.json.meshes=this.json.meshes||[],this.json.meshes.push(r),this.json.meshes.length-1}addImage(t,r){const s=Wi(t),i=r||(s==null?void 0:s.mimeType),n={bufferView:this.addBufferView(t),mimeType:i};return this.json.images=this.json.images||[],this.json.images.push(n),this.json.images.length-1}addBufferView(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.byteLength;const i=t.byteLength;wt(Number.isFinite(i)),this.sourceBuffers=this.sourceBuffers||[],this.sourceBuffers.push(t);const n={buffer:r,byteOffset:s,byteLength:i};return this.byteLength+=nr(i,4),this.json.bufferViews=this.json.bufferViews||[],this.json.bufferViews.push(n),this.json.bufferViews.length-1}addAccessor(t,r){const s={bufferView:t,type:Oa(r.size),componentType:r.componentType,count:r.count,max:r.max,min:r.min};return this.json.accessors=this.json.accessors||[],this.json.accessors.push(s),this.json.accessors.length-1}addBinaryBuffer(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{size:3};const s=this.addBufferView(t);let i={min:r.min,max:r.max};(!i.min||!i.max)&&(i=this._getAccessorMinMax(t,r.size));const n={size:r.size,componentType:Xi(t),count:Math.round(t.length/r.size),min:i.min,max:i.max};return this.addAccessor(s,Object.assign(n,r))}addTexture(t){const{imageIndex:r}=t,s={source:r};return this.json.textures=this.json.textures||[],this.json.textures.push(s),this.json.textures.length-1}addMaterial(t){return this.json.materials=this.json.materials||[],this.json.materials.push(t),this.json.materials.length-1}createBinaryChunk(){var t,r;this.gltf.buffers=[];const s=this.byteLength,i=new ArrayBuffer(s),n=new Uint8Array(i);let A=0;for(const o of this.sourceBuffers||[])A=Eu(o,n,A);(t=this.json)!==null&&t!==void 0&&(r=t.buffers)!==null&&r!==void 0&&r[0]?this.json.buffers[0].byteLength=s:this.json.buffers=[{byteLength:s}],this.gltf.binary=i,this.sourceBuffers=[i]}_removeStringFromArray(t,r){let s=!0;for(;s;){const i=t.indexOf(r);i>-1?t.splice(i,1):s=!1}}_addAttributes(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const r={};for(const s in t){const i=t[s],n=this._getGltfAttributeName(s),A=this.addBinaryBuffer(i.value,i);r[n]=A}return r}_addIndices(t){return this.addBinaryBuffer(t,{size:1})}_getGltfAttributeName(t){switch(t.toLowerCase()){case"position":case"positions":case"vertices":return"POSITION";case"normal":case"normals":return"NORMAL";case"color":case"colors":return"COLOR_0";case"texcoord":case"texcoords":return"TEXCOORD_0";default:return t}}_getAccessorMinMax(t,r){const s={min:null,max:null};if(t.length<r)return s;s.min=[],s.max=[];const i=t.subarray(0,r);for(const n of i)s.min.push(n),s.max.push(n);for(let n=r;n<t.length;n+=r)for(let A=0;A<r;A++)s.min[0+A]=Math.min(s.min[0+A],t[n+A]),s.max[0+A]=Math.max(s.max[0+A],t[n+A]);return s}}function BA(e){return(e%1+1)%1}const Pa={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16,BOOLEAN:1,STRING:1,ENUM:1},jf={INT8:Int8Array,UINT8:Uint8Array,INT16:Int16Array,UINT16:Uint16Array,INT32:Int32Array,UINT32:Uint32Array,INT64:BigInt64Array,UINT64:BigUint64Array,FLOAT32:Float32Array,FLOAT64:Float64Array},Ha={INT8:1,UINT8:1,INT16:2,UINT16:2,INT32:4,UINT32:4,INT64:8,UINT64:8,FLOAT32:4,FLOAT64:8};function Zi(e,t){return Ha[t]*Pa[e]}function As(e,t,r,s){if(r!=="UINT8"&&r!=="UINT16"&&r!=="UINT32"&&r!=="UINT64")return null;const i=e.getTypedArrayForBufferView(t),n=os(i,"SCALAR",r,s+1);return n instanceof BigInt64Array||n instanceof BigUint64Array?null:n}function os(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const i=Pa[t],n=jf[r],A=Ha[r],o=s*i,a=o*A;let c=e.buffer,h=e.byteOffset;return h%A!==0&&(c=new Uint8Array(c).slice(h,h+a).buffer,h=0),new n(c,h,o)}function $i(e,t,r){var s,i;const n=`TEXCOORD_${t.texCoord||0}`,A=r.attributes[n],o=e.getTypedArrayForAccessor(A),a=e.gltf.json,c=t.index,h=(s=a.textures)===null||s===void 0||(i=s[c])===null||i===void 0?void 0:i.source;if(typeof h<"u"){var u,g,l;const B=(u=a.images)===null||u===void 0||(g=u[h])===null||g===void 0?void 0:g.mimeType,d=(l=e.gltf.images)===null||l===void 0?void 0:l[h];if(d&&typeof d.width<"u"){const C=[];for(let m=0;m<o.length;m+=2){const w=Vf(d,B,o,m,t.channels);C.push(w)}return C}}return[]}function Ja(e,t,r,s,i){if(!(r!=null&&r.length))return;const n=[];for(const h of r){let u=s.findIndex(g=>g===h);u===-1&&(u=s.push(h)-1),n.push(u)}const A=new Uint32Array(n),o=e.gltf.buffers.push({arrayBuffer:A.buffer,byteOffset:A.byteOffset,byteLength:A.byteLength})-1,a=e.addBufferView(A,o,0),c=e.addAccessor(a,{size:1,componentType:Xi(A),count:A.length});i.attributes[t]=c}function Vf(e,t,r,s){let i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[0];const n={r:{offset:0,shift:0},g:{offset:1,shift:8},b:{offset:2,shift:16},a:{offset:3,shift:24}},A=r[s],o=r[s+1];let a=1;t&&(t.indexOf("image/jpeg")!==-1||t.indexOf("image/png")!==-1)&&(a=4);const c=Yf(A,o,e,a);let h=0;for(const u of i){const g=typeof u=="number"?Object.values(n)[u]:n[u],l=c+g.offset,B=Ga(e);if(B.data.length<=l)throw new Error(`${B.data.length} <= ${l}`);const d=B.data[l];h|=d<<g.shift}return h}function Yf(e,t,r){let s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const i=r.width,n=BA(e)*(i-1),A=Math.round(n),o=r.height,a=BA(t)*(o-1),c=Math.round(a),h=r.components?r.components:s;return(c*i+A)*h}function ka(e,t,r,s,i){const n=[];for(let A=0;A<t;A++){const o=r[A],a=r[A+1]-r[A];if(a+o>s)break;const c=o/i,h=a/i;n.push(e.slice(c,c+h))}return n}function qa(e,t,r){const s=[];for(let i=0;i<t;i++){const n=i*r;s.push(e.slice(n,n+r))}return s}function Ka(e,t,r,s){if(r)throw new Error("Not implemented - arrayOffsets for strings is specified");if(s){const i=[],n=new TextDecoder("utf8");let A=0;for(let o=0;o<e;o++){const a=s[o+1]-s[o];if(a+A<=t.length){const c=t.subarray(A,a+A),h=n.decode(c);i.push(h),A+=a}}return i}return[]}const ja="EXT_mesh_features",Wf=ja;async function Xf(e,t){const r=new ut(e);zf(r,t)}function zf(e,t){const r=e.gltf.json;if(r.meshes)for(const s of r.meshes)for(const i of s.primitives)Zf(e,i,t)}function Zf(e,t,r){var s,i;if(!(r!=null&&(s=r.gltf)!==null&&s!==void 0&&s.loadBuffers))return;const n=(i=t.extensions)===null||i===void 0?void 0:i[ja],A=n==null?void 0:n.featureIds;if(A)for(const a of A){var o;let c;if(typeof a.attribute<"u"){const h=`_FEATURE_ID_${a.attribute}`,u=t.attributes[h];c=e.getTypedArrayForAccessor(u)}else typeof a.texture<"u"&&r!==null&&r!==void 0&&(o=r.gltf)!==null&&o!==void 0&&o.loadImages?c=$i(e,a.texture,t):c=[];a.data=c}}const $f=Object.freeze(Object.defineProperty({__proto__:null,decode:Xf,name:Wf},Symbol.toStringTag,{value:"Module"})),tn="EXT_structural_metadata",tC=tn;async function eC(e,t){const r=new ut(e);rC(r,t)}function rC(e,t){var r,s;if(!((r=t.gltf)!==null&&r!==void 0&&r.loadBuffers))return;const i=e.getExtension(tn);i&&((s=t.gltf)!==null&&s!==void 0&&s.loadImages&&sC(e,i),iC(e,i))}function sC(e,t){const r=t.propertyTextures,s=e.gltf.json;if(r&&s.meshes)for(const i of s.meshes)for(const n of i.primitives)AC(e,r,n,t)}function iC(e,t){const r=t.schema;if(!r)return;const s=r.classes,i=t.propertyTables;if(s&&i)for(const n in s){const A=nC(i,n);A&&aC(e,r,A)}}function nC(e,t){for(const r of e)if(r.class===t)return r;return null}function AC(e,t,r,s){var i;if(!t)return;const n=(i=r.extensions)===null||i===void 0?void 0:i[tn],A=n==null?void 0:n.propertyTextures;if(A)for(const o of A){const a=t[o];oC(e,a,r,s)}}function oC(e,t,r,s){if(!t.properties)return;s.dataAttributeNames||(s.dataAttributeNames=[]);const i=t.class;for(const A in t.properties){var n;const o=`${i}_${A}`,a=(n=t.properties)===null||n===void 0?void 0:n[A];if(!a)continue;a.data||(a.data=[]);const c=a.data,h=$i(e,a,r);h!==null&&(Ja(e,o,h,c,r),a.data=c,s.dataAttributeNames.push(o))}}function aC(e,t,r){var s;const i=(s=t.classes)===null||s===void 0?void 0:s[r.class];if(!i)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${r.class}`);const n=r.count;for(const o in i.properties){var A;const a=i.properties[o],c=(A=r.properties)===null||A===void 0?void 0:A[o];if(c){const h=cC(e,t,a,n,c);c.data=h}}}function cC(e,t,r,s,i){let n=[];const A=i.values,o=e.getTypedArrayForBufferView(A),a=hC(e,r,i,s),c=uC(e,i,s);switch(r.type){case"SCALAR":case"VEC2":case"VEC3":case"VEC4":case"MAT2":case"MAT3":case"MAT4":{n=lC(r,s,o,a);break}case"BOOLEAN":throw new Error(`Not implemented - classProperty.type=${r.type}`);case"STRING":{n=Ka(s,o,a,c);break}case"ENUM":{n=gC(t,r,s,o,a);break}default:throw new Error(`Unknown classProperty type ${r.type}`)}return n}function hC(e,t,r,s){return t.array&&typeof t.count>"u"&&typeof r.arrayOffsets<"u"?As(e,r.arrayOffsets,r.arrayOffsetType||"UINT32",s):null}function uC(e,t,r){return typeof t.stringOffsets<"u"?As(e,t.stringOffsets,t.stringOffsetType||"UINT32",r):null}function lC(e,t,r,s){const i=e.array,n=e.count,A=Zi(e.type,e.componentType),o=r.byteLength/A;let a;return e.componentType?a=os(r,e.type,e.componentType,o):a=r,i?s?ka(a,t,s,r.length,A):n?qa(a,t,n):[]:a}function gC(e,t,r,s,i){var n;const A=t.enumType;if(!A)throw new Error("Incorrect data in the EXT_structural_metadata extension: classProperty.enumType is not set for type ENUM");const o=(n=e.enums)===null||n===void 0?void 0:n[A];if(!o)throw new Error(`Incorrect data in the EXT_structural_metadata extension: schema.enums does't contain ${A}`);const a=o.valueType||"UINT16",c=Zi(t.type,a),h=s.byteLength/c;let u=os(s,t.type,a,h);if(u||(u=s),t.array){if(i)return BC({valuesData:u,numberOfElements:r,arrayOffsets:i,valuesDataBytesLength:s.length,elementSize:c,enumEntry:o});const g=t.count;return g?dC(u,r,g,o):[]}return en(u,0,r,o)}function BC(e){const{valuesData:t,numberOfElements:r,arrayOffsets:s,valuesDataBytesLength:i,elementSize:n,enumEntry:A}=e,o=[];for(let a=0;a<r;a++){const c=s[a],h=s[a+1]-s[a];if(h+c>i)break;const u=c/n,g=h/n,l=en(t,u,g,A);o.push(l)}return o}function dC(e,t,r,s){const i=[];for(let n=0;n<t;n++){const A=r*n,o=en(e,A,r,s);i.push(o)}return i}function en(e,t,r,s){const i=[];for(let n=0;n<r;n++)if(e instanceof BigInt64Array||e instanceof BigUint64Array)i.push("");else{const A=e[t+n],o=fC(s,A);o?i.push(o.name):i.push("")}return i}function fC(e,t){for(const r of e.values)if(r.value===t)return r;return null}const CC=Object.freeze(Object.defineProperty({__proto__:null,decode:eC,name:tC},Symbol.toStringTag,{value:"Module"})),Va="EXT_feature_metadata",IC=Va;async function EC(e,t){const r=new ut(e);mC(r,t)}function mC(e,t){var r,s;if(!((r=t.gltf)!==null&&r!==void 0&&r.loadBuffers))return;const i=e.getExtension(Va);i&&((s=t.gltf)!==null&&s!==void 0&&s.loadImages&&pC(e,i),yC(e,i))}function pC(e,t){const r=t.schema;if(!r)return;const s=r.classes,{featureTextures:i}=t;if(s&&i)for(const n in s){const A=s[n],o=wC(i,n);o&&DC(e,o,A)}}function yC(e,t){const r=t.schema;if(!r)return;const s=r.classes,i=t.featureTables;if(s&&i)for(const n in s){const A=QC(i,n);A&&bC(e,r,A)}}function QC(e,t){for(const r in e){const s=e[r];if(s.class===t)return s}return null}function wC(e,t){for(const r in e){const s=e[r];if(s.class===t)return s}return null}function bC(e,t,r){var s;if(!r.class)return;const i=(s=t.classes)===null||s===void 0?void 0:s[r.class];if(!i)throw new Error(`Incorrect data in the EXT_structural_metadata extension: no schema class with name ${r.class}`);const n=r.count;for(const o in i.properties){var A;const a=i.properties[o],c=(A=r.properties)===null||A===void 0?void 0:A[o];if(c){const h=RC(e,t,a,n,c);c.data=h}}}function DC(e,t,r){const s=t.class;for(const n in r.properties){var i;const A=t==null||(i=t.properties)===null||i===void 0?void 0:i[n];if(A){const o=FC(e,A,s);A.data=o}}}function RC(e,t,r,s,i){let n=[];const A=i.bufferView,o=e.getTypedArrayForBufferView(A),a=SC(e,r,i,s),c=TC(e,r,i,s);return r.type==="STRING"||r.componentType==="STRING"?n=Ka(s,o,a,c):_C(r)&&(n=MC(r,s,o,a)),n}function SC(e,t,r,s){return t.type==="ARRAY"&&typeof t.componentCount>"u"&&typeof r.arrayOffsetBufferView<"u"?As(e,r.arrayOffsetBufferView,r.offsetType||"UINT32",s):null}function TC(e,t,r,s){return typeof r.stringOffsetBufferView<"u"?As(e,r.stringOffsetBufferView,r.offsetType||"UINT32",s):null}function _C(e){const t=["UINT8","INT16","UINT16","INT32","UINT32","INT64","UINT64","FLOAT32","FLOAT64"];return t.includes(e.type)||typeof e.componentType<"u"&&t.includes(e.componentType)}function MC(e,t,r,s){const i=e.type==="ARRAY",n=e.componentCount,A="SCALAR",o=e.componentType||e.type,a=Zi(A,o),c=r.byteLength/a,h=os(r,A,o,c);return i?s?ka(h,t,s,r.length,a):n?qa(h,t,n):[]:h}function FC(e,t,r){const s=e.gltf.json;if(!s.meshes)return[];const i=[];for(const n of s.meshes)for(const A of n.primitives)GC(e,r,t,i,A);return i}function GC(e,t,r,s,i){const n={channels:r.channels,...r.texture},A=$i(e,n,i);A&&Ja(e,t,A,s,i)}const vC=Object.freeze(Object.defineProperty({__proto__:null,decode:EC,name:IC},Symbol.toStringTag,{value:"Module"})),LC="4.1.1",xC="4.1.1",qr={TRANSCODER:"basis_transcoder.js",TRANSCODER_WASM:"basis_transcoder.wasm",ENCODER:"basis_encoder.js",ENCODER_WASM:"basis_encoder.wasm"};let Ps;async function dA(e){const t=e.modules||{};return t.basis?t.basis:(Ps=Ps||UC(e),await Ps)}async function UC(e){let t=null,r=null;return[t,r]=await Promise.all([await ae(qr.TRANSCODER,"textures",e),await ae(qr.TRANSCODER_WASM,"textures",e)]),t=t||globalThis.BASIS,await OC(t,r)}function OC(e,t){const r={};return t&&(r.wasmBinary=t),new Promise(s=>{e(r).then(i=>{const{BasisFile:n,initializeBasis:A}=i;A(),s({BasisFile:n})})})}let Hs;async function fA(e){const t=e.modules||{};return t.basisEncoder?t.basisEncoder:(Hs=Hs||NC(e),await Hs)}async function NC(e){let t=null,r=null;return[t,r]=await Promise.all([await ae(qr.ENCODER,"textures",e),await ae(qr.ENCODER_WASM,"textures",e)]),t=t||globalThis.BASIS,await PC(t,r)}function PC(e,t){const r={};return t&&(r.wasmBinary=t),new Promise(s=>{e(r).then(i=>{const{BasisFile:n,KTX2File:A,initializeBasis:o,BasisEncoder:a}=i;o(),s({BasisFile:n,KTX2File:A,BasisEncoder:a})})})}const me={COMPRESSED_RGB_S3TC_DXT1_EXT:33776,COMPRESSED_RGBA_S3TC_DXT1_EXT:33777,COMPRESSED_RGBA_S3TC_DXT3_EXT:33778,COMPRESSED_RGBA_S3TC_DXT5_EXT:33779,COMPRESSED_R11_EAC:37488,COMPRESSED_SIGNED_R11_EAC:37489,COMPRESSED_RG11_EAC:37490,COMPRESSED_SIGNED_RG11_EAC:37491,COMPRESSED_RGB8_ETC2:37492,COMPRESSED_RGBA8_ETC2_EAC:37493,COMPRESSED_SRGB8_ETC2:37494,COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:37495,COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2:37496,COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2:37497,COMPRESSED_RGB_PVRTC_4BPPV1_IMG:35840,COMPRESSED_RGBA_PVRTC_4BPPV1_IMG:35842,COMPRESSED_RGB_PVRTC_2BPPV1_IMG:35841,COMPRESSED_RGBA_PVRTC_2BPPV1_IMG:35843,COMPRESSED_RGB_ETC1_WEBGL:36196,COMPRESSED_RGB_ATC_WEBGL:35986,COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL:35987,COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL:34798,COMPRESSED_RGBA_ASTC_4X4_KHR:37808,COMPRESSED_RGBA_ASTC_5X4_KHR:37809,COMPRESSED_RGBA_ASTC_5X5_KHR:37810,COMPRESSED_RGBA_ASTC_6X5_KHR:37811,COMPRESSED_RGBA_ASTC_6X6_KHR:37812,COMPRESSED_RGBA_ASTC_8X5_KHR:37813,COMPRESSED_RGBA_ASTC_8X6_KHR:37814,COMPRESSED_RGBA_ASTC_8X8_KHR:37815,COMPRESSED_RGBA_ASTC_10X5_KHR:37816,COMPRESSED_RGBA_ASTC_10X6_KHR:37817,COMPRESSED_RGBA_ASTC_10X8_KHR:37818,COMPRESSED_RGBA_ASTC_10X10_KHR:37819,COMPRESSED_RGBA_ASTC_12X10_KHR:37820,COMPRESSED_RGBA_ASTC_12X12_KHR:37821,COMPRESSED_SRGB8_ALPHA8_ASTC_4X4_KHR:37840,COMPRESSED_SRGB8_ALPHA8_ASTC_5X4_KHR:37841,COMPRESSED_SRGB8_ALPHA8_ASTC_5X5_KHR:37842,COMPRESSED_SRGB8_ALPHA8_ASTC_6X5_KHR:37843,COMPRESSED_SRGB8_ALPHA8_ASTC_6X6_KHR:37844,COMPRESSED_SRGB8_ALPHA8_ASTC_8X5_KHR:37845,COMPRESSED_SRGB8_ALPHA8_ASTC_8X6_KHR:37846,COMPRESSED_SRGB8_ALPHA8_ASTC_8X8_KHR:37847,COMPRESSED_SRGB8_ALPHA8_ASTC_10X5_KHR:37848,COMPRESSED_SRGB8_ALPHA8_ASTC_10X6_KHR:37849,COMPRESSED_SRGB8_ALPHA8_ASTC_10X8_KHR:37850,COMPRESSED_SRGB8_ALPHA8_ASTC_10X10_KHR:37851,COMPRESSED_SRGB8_ALPHA8_ASTC_12X10_KHR:37852,COMPRESSED_SRGB8_ALPHA8_ASTC_12X12_KHR:37853,COMPRESSED_RED_RGTC1_EXT:36283,COMPRESSED_SIGNED_RED_RGTC1_EXT:36284,COMPRESSED_RED_GREEN_RGTC2_EXT:36285,COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT:36286,COMPRESSED_SRGB_S3TC_DXT1_EXT:35916,COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT:35917,COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT:35918,COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT:35919},HC=["","WEBKIT_","MOZ_"],CA={WEBGL_compressed_texture_s3tc:"dxt",WEBGL_compressed_texture_s3tc_srgb:"dxt-srgb",WEBGL_compressed_texture_etc1:"etc1",WEBGL_compressed_texture_etc:"etc2",WEBGL_compressed_texture_pvrtc:"pvrtc",WEBGL_compressed_texture_atc:"atc",WEBGL_compressed_texture_astc:"astc",EXT_texture_compression_rgtc:"rgtc"};let br=null;function JC(e){if(!br){e=e||kC()||void 0,br=new Set;for(const t of HC)for(const r in CA)if(e&&e.getExtension(`${t}${r}`)){const s=CA[r];br.add(s)}}return br}function kC(){try{return document.createElement("canvas").getContext("webgl")}catch{return null}}var IA,EA,mA,pA,yA,QA,wA,bA;(function(e){e[e.NONE=0]="NONE",e[e.BASISLZ=1]="BASISLZ",e[e.ZSTD=2]="ZSTD",e[e.ZLIB=3]="ZLIB"})(IA||(IA={})),function(e){e[e.BASICFORMAT=0]="BASICFORMAT"}(EA||(EA={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.ETC1S=163]="ETC1S",e[e.UASTC=166]="UASTC"}(mA||(mA={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.SRGB=1]="SRGB"}(pA||(pA={})),function(e){e[e.UNSPECIFIED=0]="UNSPECIFIED",e[e.LINEAR=1]="LINEAR",e[e.SRGB=2]="SRGB",e[e.ITU=3]="ITU",e[e.NTSC=4]="NTSC",e[e.SLOG=5]="SLOG",e[e.SLOG2=6]="SLOG2"}(yA||(yA={})),function(e){e[e.ALPHA_STRAIGHT=0]="ALPHA_STRAIGHT",e[e.ALPHA_PREMULTIPLIED=1]="ALPHA_PREMULTIPLIED"}(QA||(QA={})),function(e){e[e.RGB=0]="RGB",e[e.RRR=3]="RRR",e[e.GGG=4]="GGG",e[e.AAA=15]="AAA"}(wA||(wA={})),function(e){e[e.RGB=0]="RGB",e[e.RGBA=3]="RGBA",e[e.RRR=4]="RRR",e[e.RRRG=5]="RRRG"}(bA||(bA={}));const pt=[171,75,84,88,32,50,48,187,13,10,26,10];function qC(e){const t=new Uint8Array(e);return!(t.byteLength<pt.length||t[0]!==pt[0]||t[1]!==pt[1]||t[2]!==pt[2]||t[3]!==pt[3]||t[4]!==pt[4]||t[5]!==pt[5]||t[6]!==pt[6]||t[7]!==pt[7]||t[8]!==pt[8]||t[9]!==pt[9]||t[10]!==pt[10]||t[11]!==pt[11])}const KC={etc1:{basisFormat:0,compressed:!0,format:me.COMPRESSED_RGB_ETC1_WEBGL},etc2:{basisFormat:1,compressed:!0},bc1:{basisFormat:2,compressed:!0,format:me.COMPRESSED_RGB_S3TC_DXT1_EXT},bc3:{basisFormat:3,compressed:!0,format:me.COMPRESSED_RGBA_S3TC_DXT5_EXT},bc4:{basisFormat:4,compressed:!0},bc5:{basisFormat:5,compressed:!0},"bc7-m6-opaque-only":{basisFormat:6,compressed:!0},"bc7-m5":{basisFormat:7,compressed:!0},"pvrtc1-4-rgb":{basisFormat:8,compressed:!0,format:me.COMPRESSED_RGB_PVRTC_4BPPV1_IMG},"pvrtc1-4-rgba":{basisFormat:9,compressed:!0,format:me.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG},"astc-4x4":{basisFormat:10,compressed:!0,format:me.COMPRESSED_RGBA_ASTC_4X4_KHR},"atc-rgb":{basisFormat:11,compressed:!0},"atc-rgba-interpolated-alpha":{basisFormat:12,compressed:!0},rgba32:{basisFormat:13,compressed:!1},rgb565:{basisFormat:14,compressed:!1},bgr565:{basisFormat:15,compressed:!1},rgba4444:{basisFormat:16,compressed:!1}};async function jC(e,t){if(t.basis.containerFormat==="auto"){if(qC(e)){const s=await fA(t);return DA(s.KTX2File,e,t)}const{BasisFile:r}=await dA(t);return Js(r,e,t)}switch(t.basis.module){case"encoder":const r=await fA(t);switch(t.basis.containerFormat){case"ktx2":return DA(r.KTX2File,e,t);case"basis":default:return Js(r.BasisFile,e,t)}case"transcoder":default:const{BasisFile:s}=await dA(t);return Js(s,e,t)}}function Js(e,t,r){const s=new e(new Uint8Array(t));try{if(!s.startTranscoding())throw new Error("Failed to start basis transcoding");const i=s.getNumImages(),n=[];for(let A=0;A<i;A++){const o=s.getNumLevels(A),a=[];for(let c=0;c<o;c++)a.push(VC(s,A,c,r));n.push(a)}return n}finally{s.close(),s.delete()}}function VC(e,t,r,s){const i=e.getImageWidth(t,r),n=e.getImageHeight(t,r),A=e.getHasAlpha(),{compressed:o,format:a,basisFormat:c}=Ya(s,A),h=e.getImageTranscodedSizeInBytes(t,r,c),u=new Uint8Array(h);if(!e.transcodeImage(u,t,r,c,0,0))throw new Error("failed to start Basis transcoding");return{width:i,height:n,data:u,compressed:o,format:a,hasAlpha:A}}function DA(e,t,r){const s=new e(new Uint8Array(t));try{if(!s.startTranscoding())throw new Error("failed to start KTX2 transcoding");const i=s.getLevels(),n=[];for(let A=0;A<i;A++){n.push(YC(s,A,r));break}return[n]}finally{s.close(),s.delete()}}function YC(e,t,r){const{alphaFlag:s,height:i,width:n}=e.getImageLevelInfo(t,0,0),{compressed:A,format:o,basisFormat:a}=Ya(r,s),c=e.getImageTranscodedSizeInBytes(t,0,0,a),h=new Uint8Array(c);if(!e.transcodeImage(h,t,0,0,a,0,-1,-1))throw new Error("Failed to transcode KTX2 image");return{width:n,height:i,data:h,compressed:A,levelSize:c,hasAlpha:s,format:o}}function Ya(e,t){let r=e&&e.basis&&e.basis.format;return r==="auto"&&(r=Wa()),typeof r=="object"&&(r=t?r.alpha:r.noAlpha),r=r.toLowerCase(),KC[r]}function Wa(){const e=JC();return e.has("astc")?"astc-4x4":e.has("dxt")?{alpha:"bc3",noAlpha:"bc1"}:e.has("pvrtc")?{alpha:"pvrtc1-4-rgba",noAlpha:"pvrtc1-4-rgb"}:e.has("etc1")?"etc1":e.has("etc2")?"etc2":"rgb565"}const WC={name:"Basis",id:"basis",module:"textures",version:xC,worker:!0,extensions:["basis","ktx2"],mimeTypes:["application/octet-stream","image/ktx2"],tests:["sB"],binary:!0,options:{basis:{format:"auto",libraryPath:"libs/",containerFormat:"auto",module:"transcoder"}}},XC={...WC,parse:jC},Se=!0,RA=1735152710,rn=12,Kr=8,zC=1313821514,ZC=5130562,$C=0,tI=0,eI=1;function rI(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return`${String.fromCharCode(e.getUint8(t+0))}${String.fromCharCode(e.getUint8(t+1))}${String.fromCharCode(e.getUint8(t+2))}${String.fromCharCode(e.getUint8(t+3))}`}function sI(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const s=new DataView(e),{magic:i=RA}=r,n=s.getUint32(t,!1);return n===i||n===RA}function iI(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const s=new DataView(t),i=rI(s,r+0),n=s.getUint32(r+4,Se),A=s.getUint32(r+8,Se);switch(Object.assign(e,{header:{byteOffset:r,byteLength:A,hasBinChunk:!1},type:i,version:n,json:{},binChunks:[]}),r+=rn,e.version){case 1:return nI(e,s,r);case 2:return AI(e,s,r,{});default:throw new Error(`Invalid GLB version ${e.version}. Only supports version 1 and 2.`)}}function nI(e,t,r){X(e.header.byteLength>rn+Kr);const s=t.getUint32(r+0,Se),i=t.getUint32(r+4,Se);return r+=Kr,X(i===$C),di(e,t,r,s),r+=s,r+=fi(e,t,r,e.header.byteLength),r}function AI(e,t,r,s){return X(e.header.byteLength>rn+Kr),oI(e,t,r,s),r+e.header.byteLength}function oI(e,t,r,s){for(;r+8<=e.header.byteLength;){const i=t.getUint32(r+0,Se),n=t.getUint32(r+4,Se);switch(r+=Kr,n){case zC:di(e,t,r,i);break;case ZC:fi(e,t,r,i);break;case tI:s.strict||di(e,t,r,i);break;case eI:s.strict||fi(e,t,r,i);break}r+=nr(i,4)}return r}function di(e,t,r,s){const i=new Uint8Array(t.buffer,r,s),n=new TextDecoder("utf8").decode(i);return e.json=JSON.parse(n),nr(s,4)}function fi(e,t,r,s){return e.header.hasBinChunk=!0,e.binChunks.push({byteOffset:r,byteLength:s,arrayBuffer:t.buffer}),nr(s,4)}function Xa(e,t){if(e.startsWith("data:")||e.startsWith("http:")||e.startsWith("https:"))return e;const r=t.baseUri||t.uri;if(!r)throw new Error(`'baseUri' must be provided to resolve relative url ${e}`);return r.substr(0,r.lastIndexOf("/")+1)+e}const aI="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",cI="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",hI=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]),uI=new Uint8Array([32,0,65,253,3,1,2,34,4,106,6,5,11,8,7,20,13,33,12,16,128,9,116,64,19,113,127,15,10,21,22,14,255,66,24,54,136,107,18,23,192,26,114,118,132,17,77,101,130,144,27,87,131,44,45,74,156,154,70,167]),lI={0:"",1:"meshopt_decodeFilterOct",2:"meshopt_decodeFilterQuat",3:"meshopt_decodeFilterExp",NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},gI={0:"meshopt_decodeVertexBuffer",1:"meshopt_decodeIndexBuffer",2:"meshopt_decodeIndexSequence",ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};async function BI(e,t,r,s,i){let n=arguments.length>5&&arguments[5]!==void 0?arguments[5]:"NONE";const A=await dI();II(A,A.exports[gI[i]],e,t,r,s,A.exports[lI[n||"NONE"]])}let ks;async function dI(){return ks||(ks=fI()),ks}async function fI(){let e=aI;WebAssembly.validate(hI)&&(e=cI,console.log("Warning: meshopt_decoder is using experimental SIMD support"));const t=await WebAssembly.instantiate(CI(e),{});return await t.instance.exports.__wasm_call_ctors(),t.instance}function CI(e){const t=new Uint8Array(e.length);for(let s=0;s<e.length;++s){const i=e.charCodeAt(s);t[s]=i>96?i-71:i>64?i-65:i>47?i+4:i>46?63:62}let r=0;for(let s=0;s<e.length;++s)t[r++]=t[s]<60?uI[t[s]]:(t[s]-60)*64+t[++s];return t.buffer.slice(0,r)}function II(e,t,r,s,i,n,A){const o=e.exports.sbrk,a=s+3&-4,c=o(a*i),h=o(n.length),u=new Uint8Array(e.exports.memory.buffer);u.set(n,h);const g=t(c,s,i,h,n.length);if(g===0&&A&&A(c,a,i),r.set(u.subarray(c,c+s*i)),o(c-o(0)),g!==0)throw new Error(`Malformed buffer data: ${g}`)}const jr="EXT_meshopt_compression",EI=jr;async function mI(e,t){var r,s;const i=new ut(e);if(!(t!=null&&(r=t.gltf)!==null&&r!==void 0&&r.decompressMeshes)||!((s=t.gltf)!==null&&s!==void 0&&s.loadBuffers))return;const n=[];for(const A of e.json.bufferViews||[])n.push(pI(i,A));await Promise.all(n),i.removeExtension(jr)}async function pI(e,t){const r=e.getObjectExtension(t,jr);if(r){const{byteOffset:s=0,byteLength:i=0,byteStride:n,count:A,mode:o,filter:a="NONE",buffer:c}=r,h=e.gltf.buffers[c],u=new Uint8Array(h.arrayBuffer,h.byteOffset+s,i),g=new Uint8Array(e.gltf.buffers[t.buffer].arrayBuffer,t.byteOffset,t.byteLength);await BI(g,A,n,u,o,a),e.removeObjectExtension(t,jr)}}const yI=Object.freeze(Object.defineProperty({__proto__:null,decode:mI,name:EI},Symbol.toStringTag,{value:"Module"})),pe="EXT_texture_webp",QI=pe;function wI(e,t){const r=new ut(e);if(!Gf("image/webp")){if(r.getRequiredExtensions().includes(pe))throw new Error(`gltf: Required extension ${pe} not supported by browser`);return}const{json:s}=r;for(const i of s.textures||[]){const n=r.getObjectExtension(i,pe);n&&(i.source=n.source),r.removeObjectExtension(i,pe)}r.removeExtension(pe)}const bI=Object.freeze(Object.defineProperty({__proto__:null,name:QI,preprocess:wI},Symbol.toStringTag,{value:"Module"})),vr="KHR_texture_basisu",DI=vr;function RI(e,t){const r=new ut(e),{json:s}=r;for(const i of s.textures||[]){const n=r.getObjectExtension(i,vr);n&&(i.source=n.source,r.removeObjectExtension(i,vr))}r.removeExtension(vr)}const SI=Object.freeze(Object.defineProperty({__proto__:null,name:DI,preprocess:RI},Symbol.toStringTag,{value:"Module"}));function TI(e){const t={};for(const r in e){const s=e[r];if(r!=="indices"){const i=za(s);t[r]=i}}return t}function za(e){const{buffer:t,size:r,count:s}=_I(e);return{value:t,size:r,byteOffset:0,count:s,type:Oa(r),componentType:Xi(t)}}function _I(e){let t=e,r=1,s=0;return e&&e.value&&(t=e.value,r=e.size||1),t&&(ArrayBuffer.isView(t)||(t=MI(t,Float32Array)),s=t.length/r),{buffer:t,size:r,count:s}}function MI(e,t){let r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e?Array.isArray(e)?new t(e):r&&!(e instanceof t)?new t(e):e:null}const re="KHR_draco_mesh_compression",FI=re;function GI(e,t,r){const s=new ut(e);for(const i of Za(s))s.getObjectExtension(i,re)}async function vI(e,t,r){var s;if(!(t!=null&&(s=t.gltf)!==null&&s!==void 0&&s.decompressMeshes))return;const i=new ut(e),n=[];for(const A of Za(i))i.getObjectExtension(A,re)&&n.push(xI(i,A,t,r));await Promise.all(n),i.removeExtension(re)}function LI(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const r=new ut(e);for(const s of r.json.meshes||[])UI(s,t),r.addRequiredExtension(re)}async function xI(e,t,r,s){const i=e.getObjectExtension(t,re);if(!i)return;const n=e.getTypedArrayForBufferView(i.bufferView),A=Gi(n.buffer,n.byteOffset),o={...r};delete o["3d-tiles"];const a=await ir(A,Ta,o,s),c=TI(a.attributes);for(const[h,u]of Object.entries(c))if(h in t.attributes){const g=t.attributes[h],l=e.getAccessor(g);l!=null&&l.min&&l!==null&&l!==void 0&&l.max&&(u.min=l.min,u.max=l.max)}t.attributes=c,a.indices&&(t.indices=za(a.indices)),e.removeObjectExtension(t,re),OI(t)}function UI(e,t){var r;let s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:4,i=arguments.length>3?arguments[3]:void 0,n=arguments.length>4?arguments[4]:void 0;if(!i.DracoWriter)throw new Error("options.gltf.DracoWriter not provided");const A=i.DracoWriter.encodeSync({attributes:e}),o=n==null||(r=n.parseSync)===null||r===void 0?void 0:r.call(n,{attributes:e}),a=i._addFauxAttributes(o.attributes),c=i.addBufferView(A);return{primitives:[{attributes:a,mode:s,extensions:{[re]:{bufferView:c,attributes:a}}}]}}function OI(e){if(!e.attributes&&Object.keys(e.attributes).length>0)throw new Error("glTF: Empty primitive detected: Draco decompression failure?")}function*Za(e){for(const t of e.json.meshes||[])for(const r of t.primitives)yield r}const NI=Object.freeze(Object.defineProperty({__proto__:null,decode:vI,encode:LI,name:FI,preprocess:GI},Symbol.toStringTag,{value:"Module"})),sn="KHR_texture_transform",PI=sn,Dr=new f,HI=new Z,JI=new Z;async function kI(e,t){var r;if(!new ut(e).hasExtension(sn)||!((r=t.gltf)!==null&&r!==void 0&&r.loadBuffers))return;const s=e.json.materials||[];for(let i=0;i<s.length;i++)qI(i,e)}function qI(e,t){var r,s,i;const n=[],A=(r=t.json.materials)===null||r===void 0?void 0:r[e],o=A==null||(s=A.pbrMetallicRoughness)===null||s===void 0?void 0:s.baseColorTexture;o&&Ue(t,e,o,n);const a=A==null?void 0:A.emissiveTexture;a&&Ue(t,e,a,n);const c=A==null?void 0:A.normalTexture;c&&Ue(t,e,c,n);const h=A==null?void 0:A.occlusionTexture;h&&Ue(t,e,h,n);const u=A==null||(i=A.pbrMetallicRoughness)===null||i===void 0?void 0:i.metallicRoughnessTexture;u&&Ue(t,e,u,n)}function Ue(e,t,r,s){const i=KI(r,s);if(!i)return;const n=e.json.meshes||[];for(const A of n)for(const o of A.primitives){const a=o.material;Number.isFinite(a)&&t===a&&jI(e,o,i)}}function KI(e,t){var r;const s=(r=e.extensions)===null||r===void 0?void 0:r[sn],{texCoord:i=0}=e,{texCoord:n=i}=s;if(t.findIndex(A=>{let[o,a]=A;return o===i&&a===n})===-1){const A=WI(s);return i!==n&&(e.texCoord=n),t.push([i,n]),{originalTexCoord:i,texCoord:n,matrix:A}}return null}function jI(e,t,r){const{originalTexCoord:s,texCoord:i,matrix:n}=r,A=t.attributes[`TEXCOORD_${s}`];if(Number.isFinite(A)){var o;const c=(o=e.json.accessors)===null||o===void 0?void 0:o[A];if(c&&c.bufferView){var a;const h=(a=e.json.bufferViews)===null||a===void 0?void 0:a[c.bufferView];if(h){const{arrayBuffer:u,byteOffset:g}=e.buffers[h.buffer],l=(g||0)+(c.byteOffset||0)+(h.byteOffset||0),{ArrayType:B,length:d}=zi(c,h),C=Ua[c.componentType],m=xa[c.type],w=h.byteStride||C*m,E=new Float32Array(d);for(let p=0;p<c.count;p++){const R=new B(u,l+p*w,2);Dr.set(R[0],R[1],1),Dr.transformByMatrix3(n),E.set([Dr[0],Dr[1]],p*m)}s===i?VI(c,h,e.buffers,E):YI(i,c,t,e,E)}}}}function VI(e,t,r,s){e.componentType=5126,r.push({arrayBuffer:s.buffer,byteOffset:0,byteLength:s.buffer.byteLength}),t.buffer=r.length-1,t.byteLength=s.buffer.byteLength,t.byteOffset=0,delete t.byteStride}function YI(e,t,r,s,i){s.buffers.push({arrayBuffer:i.buffer,byteOffset:0,byteLength:i.buffer.byteLength});const n=s.json.bufferViews;if(!n)return;n.push({buffer:s.buffers.length-1,byteLength:i.buffer.byteLength,byteOffset:0});const A=s.json.accessors;A&&(A.push({bufferView:(n==null?void 0:n.length)-1,byteOffset:0,componentType:5126,count:t.count,type:"VEC2"}),r.attributes[`TEXCOORD_${e}`]=A.length-1)}function WI(e){const{offset:t=[0,0],rotation:r=0,scale:s=[1,1]}=e,i=new Z().set(1,0,0,0,1,0,t[0],t[1],1),n=HI.set(Math.cos(r),Math.sin(r),0,-Math.sin(r),Math.cos(r),0,0,0,1),A=JI.set(s[0],0,0,0,s[1],0,0,0,1);return i.multiplyRight(n).multiplyRight(A)}const XI=Object.freeze(Object.defineProperty({__proto__:null,decode:kI,name:PI},Symbol.toStringTag,{value:"Module"})),Ae="KHR_lights_punctual",zI=Ae;async function ZI(e){const t=new ut(e),{json:r}=t,s=t.getExtension(Ae);s&&(t.json.lights=s.lights,t.removeExtension(Ae));for(const i of r.nodes||[]){const n=t.getObjectExtension(i,Ae);n&&(i.light=n.light),t.removeObjectExtension(i,Ae)}}async function $I(e){const t=new ut(e),{json:r}=t;if(r.lights){const s=t.addExtension(Ae);wt(!s.lights),s.lights=r.lights,delete r.lights}if(t.json.lights){for(const s of t.json.lights){const i=s.node;t.addObjectExtension(i,Ae,s)}delete t.json.lights}}const tE=Object.freeze(Object.defineProperty({__proto__:null,decode:ZI,encode:$I,name:zI},Symbol.toStringTag,{value:"Module"})),Ze="KHR_materials_unlit",eE=Ze;async function rE(e){const t=new ut(e),{json:r}=t;for(const s of r.materials||[])s.extensions&&s.extensions.KHR_materials_unlit&&(s.unlit=!0),t.removeObjectExtension(s,Ze);t.removeExtension(Ze)}function sE(e){const t=new ut(e),{json:r}=t;if(t.materials)for(const s of r.materials||[])s.unlit&&(delete s.unlit,t.addObjectExtension(s,Ze,{}),t.addExtension(Ze))}const iE=Object.freeze(Object.defineProperty({__proto__:null,decode:rE,encode:sE,name:eE},Symbol.toStringTag,{value:"Module"})),Je="KHR_techniques_webgl",nE=Je;async function AE(e){const t=new ut(e),{json:r}=t,s=t.getExtension(Je);if(s){const i=aE(s,t);for(const n of r.materials||[]){const A=t.getObjectExtension(n,Je);A&&(n.technique=Object.assign({},A,i[A.technique]),n.technique.values=cE(n.technique,t)),t.removeObjectExtension(n,Je)}t.removeExtension(Je)}}async function oE(e,t){}function aE(e,t){const{programs:r=[],shaders:s=[],techniques:i=[]}=e,n=new TextDecoder;return s.forEach(A=>{if(Number.isFinite(A.bufferView))A.code=n.decode(t.getTypedArrayForBufferView(A.bufferView));else throw new Error("KHR_techniques_webgl: no shader code")}),r.forEach(A=>{A.fragmentShader=s[A.fragmentShader],A.vertexShader=s[A.vertexShader]}),i.forEach(A=>{A.program=r[A.program]}),i}function cE(e,t){const r=Object.assign({},e.values);return Object.keys(e.uniforms||{}).forEach(s=>{e.uniforms[s].value&&!(s in r)&&(r[s]=e.uniforms[s].value)}),Object.keys(r).forEach(s=>{typeof r[s]=="object"&&r[s].index!==void 0&&(r[s].texture=t.getTexture(r[s].index))}),r}const hE=Object.freeze(Object.defineProperty({__proto__:null,decode:AE,encode:oE,name:nE},Symbol.toStringTag,{value:"Module"})),$a=[CC,$f,yI,bI,SI,NI,tE,iE,hE,XI,vC];function uE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const s=$a.filter(n=>tc(n.name,t));for(const n of s){var i;(i=n.preprocess)===null||i===void 0||i.call(n,e,t,r)}}async function lE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const s=$a.filter(n=>tc(n.name,t));for(const n of s){var i;await((i=n.decode)===null||i===void 0?void 0:i.call(n,e,t,r))}}function tc(e,t){var r;const s=(t==null||(r=t.gltf)===null||r===void 0?void 0:r.excludeExtensions)||{};return!(e in s&&!s[e])}const qs="KHR_binary_glTF";function gE(e){const t=new ut(e),{json:r}=t;for(const s of r.images||[]){const i=t.getObjectExtension(s,qs);i&&Object.assign(s,i),t.removeObjectExtension(s,qs)}r.buffers&&r.buffers[0]&&delete r.buffers[0].uri,t.removeExtension(qs)}const SA={accessors:"accessor",animations:"animation",buffers:"buffer",bufferViews:"bufferView",images:"image",materials:"material",meshes:"mesh",nodes:"node",samplers:"sampler",scenes:"scene",skins:"skin",textures:"texture"},BE={accessor:"accessors",animations:"animation",buffer:"buffers",bufferView:"bufferViews",image:"images",material:"materials",mesh:"meshes",node:"nodes",sampler:"samplers",scene:"scenes",skin:"skins",texture:"textures"};class dE{constructor(){this.idToIndexMap={animations:{},accessors:{},buffers:{},bufferViews:{},images:{},materials:{},meshes:{},nodes:{},samplers:{},scenes:{},skins:{},textures:{}},this.json=void 0}normalize(t,r){this.json=t.json;const s=t.json;switch(s.asset&&s.asset.version){case"2.0":return;case void 0:case"1.0":break;default:console.warn(`glTF: Unknown version ${s.asset.version}`);return}if(!r.normalize)throw new Error("glTF v1 is not supported.");console.warn("Converting glTF v1 to glTF v2 format. This is experimental and may fail."),this._addAsset(s),this._convertTopLevelObjectsToArrays(s),gE(t),this._convertObjectIdsToArrayIndices(s),this._updateObjects(s),this._updateMaterial(s)}_addAsset(t){t.asset=t.asset||{},t.asset.version="2.0",t.asset.generator=t.asset.generator||"Normalized to glTF 2.0 by loaders.gl"}_convertTopLevelObjectsToArrays(t){for(const r in SA)this._convertTopLevelObjectToArray(t,r)}_convertTopLevelObjectToArray(t,r){const s=t[r];if(!(!s||Array.isArray(s))){t[r]=[];for(const i in s){const n=s[i];n.id=n.id||i;const A=t[r].length;t[r].push(n),this.idToIndexMap[r][i]=A}}}_convertObjectIdsToArrayIndices(t){for(const r in SA)this._convertIdsToIndices(t,r);"scene"in t&&(t.scene=this._convertIdToIndex(t.scene,"scene"));for(const r of t.textures)this._convertTextureIds(r);for(const r of t.meshes)this._convertMeshIds(r);for(const r of t.nodes)this._convertNodeIds(r);for(const r of t.scenes)this._convertSceneIds(r)}_convertTextureIds(t){t.source&&(t.source=this._convertIdToIndex(t.source,"image"))}_convertMeshIds(t){for(const r of t.primitives){const{attributes:s,indices:i,material:n}=r;for(const A in s)s[A]=this._convertIdToIndex(s[A],"accessor");i&&(r.indices=this._convertIdToIndex(i,"accessor")),n&&(r.material=this._convertIdToIndex(n,"material"))}}_convertNodeIds(t){t.children&&(t.children=t.children.map(r=>this._convertIdToIndex(r,"node"))),t.meshes&&(t.meshes=t.meshes.map(r=>this._convertIdToIndex(r,"mesh")))}_convertSceneIds(t){t.nodes&&(t.nodes=t.nodes.map(r=>this._convertIdToIndex(r,"node")))}_convertIdsToIndices(t,r){t[r]||(console.warn(`gltf v1: json doesn't contain attribute ${r}`),t[r]=[]);for(const s of t[r])for(const i in s){const n=s[i],A=this._convertIdToIndex(n,i);s[i]=A}}_convertIdToIndex(t,r){const s=BE[r];if(s in this.idToIndexMap){const i=this.idToIndexMap[s][t];if(!Number.isFinite(i))throw new Error(`gltf v1: failed to resolve ${r} with id ${t}`);return i}return t}_updateObjects(t){for(const r of this.json.buffers)delete r.type}_updateMaterial(t){for(const n of t.materials){var r,s,i;n.pbrMetallicRoughness={baseColorFactor:[1,1,1,1],metallicFactor:1,roughnessFactor:1};const A=((r=n.values)===null||r===void 0?void 0:r.tex)||((s=n.values)===null||s===void 0?void 0:s.texture2d_0)||((i=n.values)===null||i===void 0?void 0:i.diffuseTex),o=t.textures.findIndex(a=>a.id===A);o!==-1&&(n.pbrMetallicRoughness.baseColorTexture={index:o})}}}function fE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new dE().normalize(e,t)}async function CE(e,t){var r,s,i;let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,A=arguments.length>3?arguments[3]:void 0,o=arguments.length>4?arguments[4]:void 0;return IE(e,t,n,A),fE(e,{normalize:A==null||(r=A.gltf)===null||r===void 0?void 0:r.normalize}),uE(e,A,o),A!=null&&(s=A.gltf)!==null&&s!==void 0&&s.loadBuffers&&e.json.buffers&&await EE(e,A,o),A!=null&&(i=A.gltf)!==null&&i!==void 0&&i.loadImages&&await mE(e,A,o),await lE(e,A,o),e}function IE(e,t,r,s){if(s.uri&&(e.baseUri=s.uri),t instanceof ArrayBuffer&&!sI(t,r,s)&&(t=new TextDecoder().decode(t)),typeof t=="string")e.json=du(t);else if(t instanceof ArrayBuffer){const A={};r=iI(A,t,r,s.glb),wt(A.type==="glTF",`Invalid GLB magic string ${A.type}`),e._glb=A,e.json=A.json}else wt(!1,"GLTF: must be ArrayBuffer or string");const i=e.json.buffers||[];if(e.buffers=new Array(i.length).fill(null),e._glb&&e._glb.header.hasBinChunk){const{binChunks:A}=e._glb;e.buffers[0]={arrayBuffer:A[0].arrayBuffer,byteOffset:A[0].byteOffset,byteLength:A[0].byteLength}}const n=e.json.images||[];e.images=new Array(n.length).fill({})}async function EE(e,t,r){const s=e.json.buffers||[];for(let A=0;A<s.length;++A){const o=s[A];if(o.uri){var i,n;const{fetch:a}=r;wt(a);const c=Xa(o.uri,t),h=await(r==null||(i=r.fetch)===null||i===void 0?void 0:i.call(r,c)),u=await(h==null||(n=h.arrayBuffer)===null||n===void 0?void 0:n.call(h));e.buffers[A]={arrayBuffer:u,byteOffset:0,byteLength:u.byteLength},delete o.uri}else e.buffers[A]===null&&(e.buffers[A]={arrayBuffer:new ArrayBuffer(o.byteLength),byteOffset:0,byteLength:o.byteLength})}}async function mE(e,t,r){const s=pE(e),i=e.json.images||[],n=[];for(const A of s)n.push(yE(e,i[A],A,t,r));return await Promise.all(n)}function pE(e){const t=new Set,r=e.json.textures||[];for(const s of r)s.source!==void 0&&t.add(s.source);return Array.from(t).sort()}async function yE(e,t,r,s,i){let n;if(t.uri&&!t.hasOwnProperty("bufferView")){const o=Xa(t.uri,s),{fetch:a}=i;n=await(await a(o)).arrayBuffer(),t.bufferView={data:n}}if(Number.isFinite(t.bufferView)){const o=kf(e.json,e.buffers,t.bufferView);n=Gi(o.buffer,o.byteOffset,o.byteLength)}wt(n,"glTF image has no data");let A=await ir(n,[Ff,XC],{...s,mimeType:t.mimeType,basis:s.basis||{format:Wa()}},i);A&&A[0]&&(A={compressed:!0,mipmaps:!1,width:A[0].width,height:A[0].height,data:A[0]}),e.images=e.images||[],e.images[r]=A}const Vr={name:"glTF",id:"gltf",module:"gltf",version:LC,extensions:["gltf","glb"],mimeTypes:["model/gltf+json","model/gltf-binary"],text:!0,binary:!0,tests:["glTF"],parse:QE,options:{gltf:{normalize:!0,loadBuffers:!0,loadImages:!0,decompressMeshes:!0},log:console}};async function QE(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;t={...Vr.options,...t},t.gltf={...Vr.options.gltf,...t.gltf};const{byteOffset:s=0}=t;return await CE({},e,s,t,r)}const wE={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},bE={5120:1,5121:1,5122:2,5123:2,5125:4,5126:4},bt={TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,REPEAT:10497,LINEAR:9729,NEAREST_MIPMAP_LINEAR:9986},DE={magFilter:bt.TEXTURE_MAG_FILTER,minFilter:bt.TEXTURE_MIN_FILTER,wrapS:bt.TEXTURE_WRAP_S,wrapT:bt.TEXTURE_WRAP_T},RE={[bt.TEXTURE_MAG_FILTER]:bt.LINEAR,[bt.TEXTURE_MIN_FILTER]:bt.NEAREST_MIPMAP_LINEAR,[bt.TEXTURE_WRAP_S]:bt.REPEAT,[bt.TEXTURE_WRAP_T]:bt.REPEAT};function SE(){return{id:"default-sampler",parameters:RE}}function TE(e){return bE[e]}function _E(e){return wE[e]}class ME{constructor(){this.baseUri="",this.jsonUnprocessed=void 0,this.json=void 0,this.buffers=[],this.images=[]}postProcess(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{json:s,buffers:i=[],images:n=[]}=t,{baseUri:A=""}=t;return wt(s),this.baseUri=A,this.buffers=i,this.images=n,this.jsonUnprocessed=s,this.json=this._resolveTree(t.json,r),this.json}_resolveTree(t){const r={...t};return this.json=r,t.bufferViews&&(r.bufferViews=t.bufferViews.map((s,i)=>this._resolveBufferView(s,i))),t.images&&(r.images=t.images.map((s,i)=>this._resolveImage(s,i))),t.samplers&&(r.samplers=t.samplers.map((s,i)=>this._resolveSampler(s,i))),t.textures&&(r.textures=t.textures.map((s,i)=>this._resolveTexture(s,i))),t.accessors&&(r.accessors=t.accessors.map((s,i)=>this._resolveAccessor(s,i))),t.materials&&(r.materials=t.materials.map((s,i)=>this._resolveMaterial(s,i))),t.meshes&&(r.meshes=t.meshes.map((s,i)=>this._resolveMesh(s,i))),t.nodes&&(r.nodes=t.nodes.map((s,i)=>this._resolveNode(s,i)),r.nodes=r.nodes.map((s,i)=>this._resolveNodeChildren(s))),t.skins&&(r.skins=t.skins.map((s,i)=>this._resolveSkin(s,i))),t.scenes&&(r.scenes=t.scenes.map((s,i)=>this._resolveScene(s,i))),typeof this.json.scene=="number"&&r.scenes&&(r.scene=r.scenes[this.json.scene]),r}getScene(t){return this._get(this.json.scenes,t)}getNode(t){return this._get(this.json.nodes,t)}getSkin(t){return this._get(this.json.skins,t)}getMesh(t){return this._get(this.json.meshes,t)}getMaterial(t){return this._get(this.json.materials,t)}getAccessor(t){return this._get(this.json.accessors,t)}getCamera(t){return this._get(this.json.cameras,t)}getTexture(t){return this._get(this.json.textures,t)}getSampler(t){return this._get(this.json.samplers,t)}getImage(t){return this._get(this.json.images,t)}getBufferView(t){return this._get(this.json.bufferViews,t)}getBuffer(t){return this._get(this.json.buffers,t)}_get(t,r){if(typeof r=="object")return r;const s=t&&t[r];return s||console.warn(`glTF file error: Could not find ${t}[${r}]`),s}_resolveScene(t,r){return{...t,id:t.id||`scene-${r}`,nodes:(t.nodes||[]).map(s=>this.getNode(s))}}_resolveNode(t,r){const s={...t,id:(t==null?void 0:t.id)||`node-${r}`};return t.mesh!==void 0&&(s.mesh=this.getMesh(t.mesh)),t.camera!==void 0&&(s.camera=this.getCamera(t.camera)),t.skin!==void 0&&(s.skin=this.getSkin(t.skin)),t.meshes!==void 0&&t.meshes.length&&(s.mesh=t.meshes.reduce((i,n)=>{const A=this.getMesh(n);return i.id=A.id,i.primitives=i.primitives.concat(A.primitives),i},{primitives:[]})),s}_resolveNodeChildren(t){return t.children&&(t.children=t.children.map(r=>this.getNode(r))),t}_resolveSkin(t,r){const s=typeof t.inverseBindMatrices=="number"?this.getAccessor(t.inverseBindMatrices):void 0;return{...t,id:t.id||`skin-${r}`,inverseBindMatrices:s}}_resolveMesh(t,r){const s={...t,id:t.id||`mesh-${r}`,primitives:[]};return t.primitives&&(s.primitives=t.primitives.map(i=>{const n={...i,attributes:{},indices:void 0,material:void 0},A=i.attributes;for(const o in A)n.attributes[o]=this.getAccessor(A[o]);return i.indices!==void 0&&(n.indices=this.getAccessor(i.indices)),i.material!==void 0&&(n.material=this.getMaterial(i.material)),n})),s}_resolveMaterial(t,r){const s={...t,id:t.id||`material-${r}`};if(s.normalTexture&&(s.normalTexture={...s.normalTexture},s.normalTexture.texture=this.getTexture(s.normalTexture.index)),s.occlusionTexture&&(s.occlusionTexture={...s.occlusionTexture},s.occlusionTexture.texture=this.getTexture(s.occlusionTexture.index)),s.emissiveTexture&&(s.emissiveTexture={...s.emissiveTexture},s.emissiveTexture.texture=this.getTexture(s.emissiveTexture.index)),s.emissiveFactor||(s.emissiveFactor=s.emissiveTexture?[1,1,1]:[0,0,0]),s.pbrMetallicRoughness){s.pbrMetallicRoughness={...s.pbrMetallicRoughness};const i=s.pbrMetallicRoughness;i.baseColorTexture&&(i.baseColorTexture={...i.baseColorTexture},i.baseColorTexture.texture=this.getTexture(i.baseColorTexture.index)),i.metallicRoughnessTexture&&(i.metallicRoughnessTexture={...i.metallicRoughnessTexture},i.metallicRoughnessTexture.texture=this.getTexture(i.metallicRoughnessTexture.index))}return s}_resolveAccessor(t,r){const s=TE(t.componentType),i=_E(t.type),n=s*i,A={...t,id:t.id||`accessor-${r}`,bytesPerComponent:s,components:i,bytesPerElement:n,value:void 0,bufferView:void 0,sparse:void 0};if(t.bufferView!==void 0&&(A.bufferView=this.getBufferView(t.bufferView)),A.bufferView){const o=A.bufferView.buffer,{ArrayType:a,byteLength:c}=zi(A,A.bufferView),h=(A.bufferView.byteOffset||0)+(A.byteOffset||0)+o.byteOffset;let u=o.arrayBuffer.slice(h,h+c);A.bufferView.byteStride&&(u=this._getValueFromInterleavedBuffer(o,h,A.bufferView.byteStride,A.bytesPerElement,A.count)),A.value=new a(u)}return A}_getValueFromInterleavedBuffer(t,r,s,i,n){const A=new Uint8Array(n*i);for(let o=0;o<n;o++){const a=r+o*s;A.set(new Uint8Array(t.arrayBuffer.slice(a,a+i)),o*i)}return A.buffer}_resolveTexture(t,r){return{...t,id:t.id||`texture-${r}`,sampler:typeof t.sampler=="number"?this.getSampler(t.sampler):SE(),source:typeof t.source=="number"?this.getImage(t.source):void 0}}_resolveSampler(t,r){const s={id:t.id||`sampler-${r}`,...t,parameters:{}};for(const i in s){const n=this._enumSamplerParameter(i);n!==void 0&&(s.parameters[n]=s[i])}return s}_enumSamplerParameter(t){return DE[t]}_resolveImage(t,r){const s={...t,id:t.id||`image-${r}`,image:null,bufferView:t.bufferView!==void 0?this.getBufferView(t.bufferView):void 0},i=this.images[r];return i&&(s.image=i),s}_resolveBufferView(t,r){const s=t.buffer,i=this.buffers[s].arrayBuffer;let n=this.buffers[s].byteOffset||0;return t.byteOffset&&(n+=t.byteOffset),{id:`bufferView-${r}`,...t,buffer:this.buffers[s],data:new Uint8Array(i,n,t.byteLength)}}_resolveCamera(t,r){const s={...t,id:t.id||`camera-${r}`};return s.perspective,s.orthographic,s}}function ec(e,t){return new ME().postProcess(e,t)}const Ci={URI:0,EMBEDDED:1};function rc(e,t,r,s){e.rotateYtoZ=!0;const i=(e.byteOffset||0)+(e.byteLength||0)-r;if(i===0)throw new Error("glTF byte length must be greater than 0.");return e.gltfUpAxis=s!=null&&s["3d-tiles"]&&s["3d-tiles"].assetGltfUpAxis?s["3d-tiles"].assetGltfUpAxis:"Y",e.gltfArrayBuffer=Gi(t,r,i),e.gltfByteOffset=0,e.gltfByteLength=i,r%4===0||console.warn(`${e.type}: embedded glb is not aligned to a 4-byte boundary.`),(e.byteOffset||0)+(e.byteLength||0)}async function sc(e,t,r,s){const i=(r==null?void 0:r["3d-tiles"])||{};if(FE(e,t),i.loadGLTF){if(!s)return;if(e.gltfUrl){const{fetch:n}=s,A=await n(e.gltfUrl,r);e.gltfArrayBuffer=await A.arrayBuffer(),e.gltfByteOffset=0}if(e.gltfArrayBuffer){const n=await ir(e.gltfArrayBuffer,Vr,r,s);e.gltf=ec(n),e.gpuMemoryUsageInBytes=Na(e.gltf),delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength}}}function FE(e,t,r){switch(t){case Ci.URI:if(e.gltfArrayBuffer){const s=new Uint8Array(e.gltfArrayBuffer,e.gltfByteOffset),i=new TextDecoder().decode(s);e.gltfUrl=i.replace(/[\s\0]+$/,"")}delete e.gltfArrayBuffer,delete e.gltfByteOffset,delete e.gltfByteLength;break;case Ci.EMBEDDED:break;default:throw new Error("b3dm: Illegal glTF format field")}}async function GE(e,t,r,s,i){var n;r=vE(e,t,r,s),await sc(e,Ci.EMBEDDED,s,i);const A=e==null||(n=e.gltf)===null||n===void 0?void 0:n.extensions;return A&&A.CESIUM_RTC&&(e.rtcCenter=A.CESIUM_RTC.center),r}function vE(e,t,r,s,i){r=ns(e,t,r),r=ji(e,t,r),r=Vi(e,t,r),r=rc(e,t,r,s);const n=new Ki(e.featureTableJson,e.featureTableBinary);return e.rtcCenter=n.getGlobalProperty("RTC_CENTER",U.FLOAT,3),r}async function LE(e,t,r,s,i){return r=xE(e,t,r,s),await sc(e,e.gltfFormat||0,s,i),r}function xE(e,t,r,s,i){var n;if(r=ns(e,t,r),e.version!==1)throw new Error(`Instanced 3D Model version ${e.version} is not supported`);r=ji(e,t,r);const A=new DataView(t);if(e.gltfFormat=A.getUint32(r,!0),r+=4,r=Vi(e,t,r),r=rc(e,t,r,s),!(e!=null&&(n=e.header)!==null&&n!==void 0&&n.featureTableJsonByteLength)||e.header.featureTableJsonByteLength===0)throw new Error("i3dm parser: featureTableJsonByteLength is zero.");const o=new Ki(e.featureTableJson,e.featureTableBinary),a=o.getGlobalProperty("INSTANCES_LENGTH");if(o.featuresLength=a,!Number.isFinite(a))throw new Error("i3dm parser: INSTANCES_LENGTH must be defined");e.eastNorthUp=o.getGlobalProperty("EAST_NORTH_UP"),e.rtcCenter=o.getGlobalProperty("RTC_CENTER",U.FLOAT,3);const c=new Ma(e.batchTableJson,e.batchTableBinary,a);return UE(e,o,c,a),r}function UE(e,t,r,s){const i=new Array(s),n=new f;new f,new f,new f;const A=new Z,o=new Hr,a=new f,c={},h=new k,u=[],g=[],l=[],B=[];for(let d=0;d<s;d++){let C;if(t.hasProperty("POSITION"))C=t.getProperty("POSITION",U.FLOAT,3,d,n);else if(t.hasProperty("POSITION_QUANTIZED")){C=t.getProperty("POSITION_QUANTIZED",U.UNSIGNED_SHORT,3,d,n);const y=t.getGlobalProperty("QUANTIZED_VOLUME_OFFSET",U.FLOAT,3);if(!y)throw new Error("i3dm parser: QUANTIZED_VOLUME_OFFSET must be defined for quantized positions.");const T=t.getGlobalProperty("QUANTIZED_VOLUME_SCALE",U.FLOAT,3);if(!T)throw new Error("i3dm parser: QUANTIZED_VOLUME_SCALE must be defined for quantized positions.");const G=65535;for(let _=0;_<3;_++)C[_]=C[_]/G*T[_]+y[_]}if(!C)throw new Error("i3dm: POSITION or POSITION_QUANTIZED must be defined for each instance.");if(n.copy(C),c.translation=n,e.normalUp=t.getProperty("NORMAL_UP",U.FLOAT,3,d,u),e.normalRight=t.getProperty("NORMAL_RIGHT",U.FLOAT,3,d,g),e.normalUp){if(!e.normalRight)throw new Error("i3dm: Custom orientation requires both NORMAL_UP and NORMAL_RIGHT.");e.hasCustomOrientation=!0}else{if(e.octNormalUp=t.getProperty("NORMAL_UP_OCT32P",U.UNSIGNED_SHORT,2,d,u),e.octNormalRight=t.getProperty("NORMAL_RIGHT_OCT32P",U.UNSIGNED_SHORT,2,d,g),e.octNormalUp)throw e.octNormalRight?new Error("i3dm: oct-encoded orientation not implemented"):new Error("i3dm: oct-encoded orientation requires NORMAL_UP_OCT32P and NORMAL_RIGHT_OCT32P");e.eastNorthUp?(J.WGS84.eastNorthUpToFixedFrame(n,h),h.getRotationMatrix3(A)):A.identity()}o.fromMatrix3(A),c.rotation=o,a.set(1,1,1);const m=t.getProperty("SCALE",U.FLOAT,1,d,l);Number.isFinite(m)&&a.multiplyByScalar(m);const w=t.getProperty("SCALE_NON_UNIFORM",U.FLOAT,3,d,u);w&&a.scale(w),c.scale=a;let E=t.getProperty("BATCH_ID",U.UNSIGNED_SHORT,1,d,B);E===void 0&&(E=d);const p=new k().fromQuaternion(c.rotation);h.identity(),h.translate(c.translation),h.multiplyRight(p),h.scale(c.scale);const R=h.clone();i[d]={modelMatrix:R,batchId:E}}e.instances=i}async function OE(e,t,r,s,i,n){r=ns(e,t,r);const A=new DataView(t);for(e.tilesLength=A.getUint32(r,!0),r+=4,e.tiles=[];e.tiles.length<e.tilesLength&&(e.byteLength||0)-r>12;){const o={shape:"tile3d"};e.tiles.push(o),r=await n(t,r,s,i,o)}return r}async function NE(e,t,r,s){var i,n;if(e.rotateYtoZ=!0,e.gltfUpAxis=r!=null&&(i=r["3d-tiles"])!==null&&i!==void 0&&i.assetGltfUpAxis?r["3d-tiles"].assetGltfUpAxis:"Y",r!=null&&(n=r["3d-tiles"])!==null&&n!==void 0&&n.loadGLTF){if(!s)return t.byteLength;const A=await ir(t,Vr,r,s);e.gltf=ec(A),e.gpuMemoryUsageInBytes=Na(e.gltf)}else e.gltfArrayBuffer=t;return t.byteLength}async function ic(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,s=arguments.length>3?arguments[3]:void 0,i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{shape:"tile3d"};switch(i.byteOffset=t,i.type=Ad(e,t),i.type){case ve.COMPOSITE:return await OE(i,e,t,r,s,ic);case ve.BATCHED_3D_MODEL:return await GE(i,e,t,r,s);case ve.GLTF:return await NE(i,e,r,s);case ve.INSTANCED_3D_MODEL:return await LE(i,e,t,r,s);case ve.POINT_CLOUD:return await qd(i,e,t,r,s);default:throw new Error(`3DTileLoader: unknown type ${i.type}`)}}const PE=1952609651,HE=1;async function JE(e,t,r){if(new Uint32Array(e.slice(0,4))[0]!==PE)throw new Error("Wrong subtree file magic number");if(new Uint32Array(e.slice(4,8))[0]!==HE)throw new Error("Wrong subtree file verson, must be 1");const s=TA(e.slice(8,16)),i=new Uint8Array(e,24,s),n=new TextDecoder("utf8").decode(i),A=JSON.parse(n),o=TA(e.slice(16,24));let a=new ArrayBuffer(0);if(o&&(a=e.slice(24+s)),await Rr(A,A.tileAvailability,a,r),Array.isArray(A.contentAvailability))for(const c of A.contentAvailability)await Rr(A,c,a,r);else await Rr(A,A.contentAvailability,a,r);return await Rr(A,A.childSubtreeAvailability,a,r),A}async function Rr(e,t,r,s){const i=Number.isFinite(t.bitstream)?t.bitstream:t.bufferView;if(typeof i!="number")return;const n=e.bufferViews[i],A=e.buffers[n.buffer];if(!(s!=null&&s.baseUrl))throw new Error("Url is not provided");if(!s.fetch)throw new Error("fetch is not provided");if(A.uri){const a=`${(s==null?void 0:s.baseUrl)||""}/${A.uri}`,c=await(await s.fetch(a)).arrayBuffer();t.explicitBitstream=new Uint8Array(c,n.byteOffset,n.byteLength);return}const o=e.buffers.slice(0,n.buffer).reduce((a,c)=>a+c.byteLength,0);t.explicitBitstream=new Uint8Array(r.slice(o,o+A.byteLength),n.byteOffset,n.byteLength)}function TA(e){const t=new DataView(e),r=t.getUint32(0,!0),s=t.getUint32(4,!0);return r+2**32*s}const nc={id:"3d-tiles-subtree",name:"3D Tiles Subtree",module:"3d-tiles",version:Da,extensions:["subtree"],mimeTypes:["application/octet-stream"],tests:["subtree"],parse:JE,options:{}};/**
 * @license
 * Copyright 2009 The Closure Library Authors
 * Copyright 2020 Daniel Wirtz / The long.js Authors.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 */var St=null;try{St=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function H(e,t,r){this.low=e|0,this.high=t|0,this.unsigned=!!r}H.prototype.__isLong__;Object.defineProperty(H.prototype,"__isLong__",{value:!0});function lt(e){return(e&&e.__isLong__)===!0}function _A(e){var t=Math.clz32(e&-e);return e?31-t:t}H.isLong=lt;var MA={},FA={};function Be(e,t){var r,s,i;return t?(e>>>=0,(i=0<=e&&e<256)&&(s=FA[e],s)?s:(r=O(e,0,!0),i&&(FA[e]=r),r)):(e|=0,(i=-128<=e&&e<128)&&(s=MA[e],s)?s:(r=O(e,e<0?-1:0,!1),i&&(MA[e]=r),r))}H.fromInt=Be;function Tt(e,t){if(isNaN(e))return t?Yt:vt;if(t){if(e<0)return Yt;if(e>=Ac)return cc}else{if(e<=-vA)return mt;if(e+1>=vA)return ac}return e<0?Tt(-e,t).neg():O(e%Te|0,e/Te|0,t)}H.fromNumber=Tt;function O(e,t,r){return new H(e,t,r)}H.fromBits=O;var Yr=Math.pow;function nn(e,t,r){if(e.length===0)throw Error("empty string");if(typeof t=="number"?(r=t,t=!1):t=!!t,e==="NaN"||e==="Infinity"||e==="+Infinity"||e==="-Infinity")return t?Yt:vt;if(r=r||10,r<2||36<r)throw RangeError("radix");var s;if((s=e.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return nn(e.substring(1),t,r).neg();for(var i=Tt(Yr(r,8)),n=vt,A=0;A<e.length;A+=8){var o=Math.min(8,e.length-A),a=parseInt(e.substring(A,A+o),r);if(o<8){var c=Tt(Yr(r,o));n=n.mul(c).add(Tt(a))}else n=n.mul(i),n=n.add(Tt(a))}return n.unsigned=t,n}H.fromString=nn;function xt(e,t){return typeof e=="number"?Tt(e,t):typeof e=="string"?nn(e,t):O(e.low,e.high,typeof t=="boolean"?t:e.unsigned)}H.fromValue=xt;var GA=65536,kE=1<<24,Te=GA*GA,Ac=Te*Te,vA=Ac/2,LA=Be(kE),vt=Be(0);H.ZERO=vt;var Yt=Be(0,!0);H.UZERO=Yt;var Qe=Be(1);H.ONE=Qe;var oc=Be(1,!0);H.UONE=oc;var Ii=Be(-1);H.NEG_ONE=Ii;var ac=O(-1,2147483647,!1);H.MAX_VALUE=ac;var cc=O(-1,-1,!0);H.MAX_UNSIGNED_VALUE=cc;var mt=O(0,-2147483648,!1);H.MIN_VALUE=mt;var b=H.prototype;b.toInt=function(){return this.unsigned?this.low>>>0:this.low};b.toNumber=function(){return this.unsigned?(this.high>>>0)*Te+(this.low>>>0):this.high*Te+(this.low>>>0)};b.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(mt)){var t=Tt(e),r=this.div(t),s=r.mul(t).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var i=Tt(Yr(e,6),this.unsigned),n=this,A="";;){var o=n.div(i),a=n.sub(o.mul(i)).toInt()>>>0,c=a.toString(e);if(n=o,n.isZero())return c+A;for(;c.length<6;)c="0"+c;A=""+c+A}};b.getHighBits=function(){return this.high};b.getHighBitsUnsigned=function(){return this.high>>>0};b.getLowBits=function(){return this.low};b.getLowBitsUnsigned=function(){return this.low>>>0};b.getNumBitsAbs=function(){if(this.isNegative())return this.eq(mt)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&!(e&1<<t);t--);return this.high!=0?t+33:t+1};b.isZero=function(){return this.high===0&&this.low===0};b.eqz=b.isZero;b.isNegative=function(){return!this.unsigned&&this.high<0};b.isPositive=function(){return this.unsigned||this.high>=0};b.isOdd=function(){return(this.low&1)===1};b.isEven=function(){return(this.low&1)===0};b.equals=function(e){return lt(e)||(e=xt(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};b.eq=b.equals;b.notEquals=function(e){return!this.eq(e)};b.neq=b.notEquals;b.ne=b.notEquals;b.lessThan=function(e){return this.comp(e)<0};b.lt=b.lessThan;b.lessThanOrEqual=function(e){return this.comp(e)<=0};b.lte=b.lessThanOrEqual;b.le=b.lessThanOrEqual;b.greaterThan=function(e){return this.comp(e)>0};b.gt=b.greaterThan;b.greaterThanOrEqual=function(e){return this.comp(e)>=0};b.gte=b.greaterThanOrEqual;b.ge=b.greaterThanOrEqual;b.compare=function(e){if(lt(e)||(e=xt(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};b.comp=b.compare;b.negate=function(){return!this.unsigned&&this.eq(mt)?mt:this.not().add(Qe)};b.neg=b.negate;b.add=function(e){lt(e)||(e=xt(e));var t=this.high>>>16,r=this.high&65535,s=this.low>>>16,i=this.low&65535,n=e.high>>>16,A=e.high&65535,o=e.low>>>16,a=e.low&65535,c=0,h=0,u=0,g=0;return g+=i+a,u+=g>>>16,g&=65535,u+=s+o,h+=u>>>16,u&=65535,h+=r+A,c+=h>>>16,h&=65535,c+=t+n,c&=65535,O(u<<16|g,c<<16|h,this.unsigned)};b.subtract=function(e){return lt(e)||(e=xt(e)),this.add(e.neg())};b.sub=b.subtract;b.multiply=function(e){if(this.isZero())return this;if(lt(e)||(e=xt(e)),St){var t=St.mul(this.low,this.high,e.low,e.high);return O(t,St.get_high(),this.unsigned)}if(e.isZero())return this.unsigned?Yt:vt;if(this.eq(mt))return e.isOdd()?mt:vt;if(e.eq(mt))return this.isOdd()?mt:vt;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(LA)&&e.lt(LA))return Tt(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,i=this.low>>>16,n=this.low&65535,A=e.high>>>16,o=e.high&65535,a=e.low>>>16,c=e.low&65535,h=0,u=0,g=0,l=0;return l+=n*c,g+=l>>>16,l&=65535,g+=i*c,u+=g>>>16,g&=65535,g+=n*a,u+=g>>>16,g&=65535,u+=s*c,h+=u>>>16,u&=65535,u+=i*a,h+=u>>>16,u&=65535,u+=n*o,h+=u>>>16,u&=65535,h+=r*c+s*a+i*o+n*A,h&=65535,O(g<<16|l,h<<16|u,this.unsigned)};b.mul=b.multiply;b.divide=function(e){if(lt(e)||(e=xt(e)),e.isZero())throw Error("division by zero");if(St){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?St.div_u:St.div_s)(this.low,this.high,e.low,e.high);return O(t,St.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?Yt:vt;var r,s,i;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return Yt;if(e.gt(this.shru(1)))return oc;i=Yt}else{if(this.eq(mt)){if(e.eq(Qe)||e.eq(Ii))return mt;if(e.eq(mt))return Qe;var n=this.shr(1);return r=n.div(e).shl(1),r.eq(vt)?e.isNegative()?Qe:Ii:(s=this.sub(e.mul(r)),i=r.add(s.div(e)),i)}else if(e.eq(mt))return this.unsigned?Yt:vt;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();i=vt}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var A=Math.ceil(Math.log(r)/Math.LN2),o=A<=48?1:Yr(2,A-48),a=Tt(r),c=a.mul(e);c.isNegative()||c.gt(s);)r-=o,a=Tt(r,this.unsigned),c=a.mul(e);a.isZero()&&(a=Qe),i=i.add(a),s=s.sub(c)}return i};b.div=b.divide;b.modulo=function(e){if(lt(e)||(e=xt(e)),St){var t=(this.unsigned?St.rem_u:St.rem_s)(this.low,this.high,e.low,e.high);return O(t,St.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};b.mod=b.modulo;b.rem=b.modulo;b.not=function(){return O(~this.low,~this.high,this.unsigned)};b.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32};b.clz=b.countLeadingZeros;b.countTrailingZeros=function(){return this.low?_A(this.low):_A(this.high)+32};b.ctz=b.countTrailingZeros;b.and=function(e){return lt(e)||(e=xt(e)),O(this.low&e.low,this.high&e.high,this.unsigned)};b.or=function(e){return lt(e)||(e=xt(e)),O(this.low|e.low,this.high|e.high,this.unsigned)};b.xor=function(e){return lt(e)||(e=xt(e)),O(this.low^e.low,this.high^e.high,this.unsigned)};b.shiftLeft=function(e){return lt(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?O(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):O(0,this.low<<e-32,this.unsigned)};b.shl=b.shiftLeft;b.shiftRight=function(e){return lt(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?O(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):O(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};b.shr=b.shiftRight;b.shiftRightUnsigned=function(e){return lt(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?O(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):e===32?O(this.high,0,this.unsigned):O(this.high>>>e-32,0,this.unsigned)};b.shru=b.shiftRightUnsigned;b.shr_u=b.shiftRightUnsigned;b.rotateLeft=function(e){var t;return lt(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?O(this.high,this.low,this.unsigned):e<32?(t=32-e,O(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,O(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))};b.rotl=b.rotateLeft;b.rotateRight=function(e){var t;return lt(e)&&(e=e.toInt()),(e&=63)===0?this:e===32?O(this.high,this.low,this.unsigned):e<32?(t=32-e,O(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,O(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))};b.rotr=b.rotateRight;b.toSigned=function(){return this.unsigned?O(this.low,this.high,!1):this};b.toUnsigned=function(){return this.unsigned?this:O(this.low,this.high,!0)};b.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};b.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};b.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};H.fromBytes=function(e,t,r){return r?H.fromBytesLE(e,t):H.fromBytesBE(e,t)};H.fromBytesLE=function(e,t){return new H(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};H.fromBytesBE=function(e,t){return new H(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const qE=16;function hc(e){e==="X"&&(e="");const t=e.padEnd(qE,"0");return H.fromString(t,!0,16)}function KE(e){if(e.isZero())return"X";let t=e.countTrailingZeros();const r=t%4;t=(t-r)/4;const s=t;t*=4;const i=e.shiftRightUnsigned(t).toString(16).replace(/0+$/,"");return Array(17-s-i.length).join("0")+i}function jE(e,t){const r=VE(e).shiftRightUnsigned(2);return e.add(H.fromNumber(2*t+1-4).multiply(r))}function VE(e){return e.and(e.not().add(1))}const YE=3,WE=30,XE=2*WE+1,xA=180/Math.PI;function zE(e){if(e.length===0)throw new Error(`Invalid Hilbert quad key ${e}`);const t=e.split("/"),r=parseInt(t[0],10),s=t[1],i=s.length;let n=0;const A=[0,0];for(let o=i-1;o>=0;o--){n=i-o;const a=s[o];let c=0,h=0;a==="1"?h=1:a==="2"?(c=1,h=1):a==="3"&&(c=1);const u=Math.pow(2,n-1);$E(u,A,c,h),A[0]+=u*c,A[1]+=u*h}if(r%2===1){const o=A[0];A[0]=A[1],A[1]=o}return{face:r,ij:A,level:n}}function ZE(e){if(e.isZero())return"";let t=e.toString(2);for(;t.length<YE+XE;)t="0"+t;const r=t.lastIndexOf("1"),s=t.substring(0,3),i=t.substring(3,r),n=i.length/2,A=H.fromString(s,!0,2).toString(10);let o="";if(n!==0)for(o=H.fromString(i,!0,2).toString(4);o.length<n;)o="0"+o;return`${A}/${o}`}function uc(e,t,r){const s=1<<t;return[(e[0]+r[0])/s,(e[1]+r[1])/s]}function UA(e){return e>=.5?1/3*(4*e*e-1):1/3*(1-4*(1-e)*(1-e))}function lc(e){return[UA(e[0]),UA(e[1])]}function gc(e,t){let[r,s]=t;switch(e){case 0:return[1,r,s];case 1:return[-r,1,s];case 2:return[-r,-s,1];case 3:return[-1,-s,-r];case 4:return[s,-1,-r];case 5:return[s,r,-1];default:throw new Error("Invalid face")}}function Bc(e){let[t,r,s]=e;const i=Math.atan2(s,Math.sqrt(t*t+r*r));return[Math.atan2(r,t)*xA,i*xA]}function $E(e,t,r,s){if(s===0){r===1&&(t[0]=e-1-t[0],t[1]=e-1-t[1]);const i=t[0];t[0]=t[1],t[1]=i}}function tm(e){const t=uc(e.ij,e.level,[.5,.5]),r=lc(t),s=gc(e.face,r);return Bc(s)}const em=100;function OA(e){const{face:t,ij:r,level:s}=e,i=[[0,0],[0,1],[1,1],[1,0],[0,0]],n=Math.max(1,Math.ceil(em*Math.pow(2,-s))),A=new Float64Array(4*n*2+2);let o=0,a=0;for(let c=0;c<4;c++){const h=i[c].slice(0),u=i[c+1],g=(u[0]-h[0])/n,l=(u[1]-h[1])/n;for(let B=0;B<n;B++){h[0]+=g,h[1]+=l;const d=uc(r,s,h),C=lc(d),m=gc(t,C),w=Bc(m);Math.abs(w[1])>89.999&&(w[0]=a);const E=w[0]-a;w[0]+=E>180?-360:E<-180?360:0,A[o++]=w[0],A[o++]=w[1],a=w[0]}}return A[o++]=A[0],A[o++]=A[1],A}function An(e){const t=rm(e);return zE(t)}function rm(e){if(e.indexOf("/")>0)return e;const t=hc(e);return ZE(t)}function sm(e){const t=An(e);return tm(t)}function im(e){let t;if(e.face===2||e.face===5){let r=null,s=0;for(let i=0;i<4;i++){const n=`${e.face}/${i}`,A=An(n),o=OA(A);(typeof r>"u"||r===null)&&(r=new Float64Array(4*o.length)),r.set(o,s),s+=o.length}t=NA(r)}else{const r=OA(e);t=NA(r)}return t}function NA(e){if(e.length%2!==0)throw new Error("Invalid corners");const t=[],r=[];for(let s=0;s<e.length;s+=2)t.push(e[s]),r.push(e[s+1]);return t.sort((s,i)=>s-i),r.sort((s,i)=>s-i),{west:t[0],east:t[t.length-1],north:r[r.length-1],south:r[0]}}function nm(e,t){const r=(t==null?void 0:t.minimumHeight)||0,s=(t==null?void 0:t.maximumHeight)||0,i=An(e),n=im(i),A=n.west,o=n.south,a=n.east,c=n.north,h=[];return h.push(new f(A,c,r)),h.push(new f(a,c,r)),h.push(new f(a,o,r)),h.push(new f(A,o,r)),h.push(new f(A,c,s)),h.push(new f(a,c,s)),h.push(new f(a,o,s)),h.push(new f(A,o,s)),h}function dc(e){const t=e.token,r={minimumHeight:e.minimumHeight,maximumHeight:e.maximumHeight},s=nm(t,r),i=sm(t),n=i[0],A=i[1],o=J.WGS84.cartographicToCartesian([n,A,r.maximumHeight]),a=new f(o[0],o[1],o[2]);s.push(a);const c=id(s);return[...c.center,...c.halfAxes]}const Am=4,om=8,am={QUADTREE:Am,OCTREE:om};function cm(e,t,r){if(e!=null&&e.box){const s=hc(e.s2VolumeInfo.token),i=jE(s,t),n=KE(i),A={...e.s2VolumeInfo};switch(A.token=n,r){case"OCTREE":const o=e.s2VolumeInfo,a=o.maximumHeight-o.minimumHeight,c=a/2,h=o.minimumHeight+a/2;o.minimumHeight=h-c,o.maximumHeight=h+c;break}return{box:dc(A),s2VolumeInfo:A}}}async function fc(e){const{implicitOptions:t,parentData:r={mortonIndex:0,x:0,y:0,z:0},childIndex:s=0,s2VolumeBox:i,loaderOptions:n}=e;let{subtree:A,level:o=0,globalData:a={level:0,mortonIndex:0,x:0,y:0,z:0}}=e;const{subdivisionScheme:c,subtreeLevels:h,maximumLevel:u,contentUrlTemplate:g,subtreesUriTemplate:l,basePath:B}=t,d={children:[],lodMetricValue:0,contentUrl:""};if(!u)return ra.once(`Missing 'maximumLevel' or 'availableLevels' property. The subtree ${g} won't be loaded...`),d;const C=o+a.level;if(C>u)return d;const m=am[c],w=Math.log2(m),E=s&1,p=s>>1&1,R=s>>2&1,y=(m**o-1)/(m-1);let T=se(r.mortonIndex,s,w),G=y+T,_=se(r.x,E,1),v=se(r.y,p,1),N=se(r.z,R,1),q=!1;o>=h&&(q=Ks(A.childSubtreeAvailability,T));const K=se(a.x,_,o),L=se(a.y,v,o),$=se(a.z,N,o);if(q){const V=`${B}/${l}`,At=Ei(V,C,K,L,$);A=await Re(At,nc,n),a={mortonIndex:T,x:_,y:v,z:N,level:o},T=0,G=0,_=0,v=0,N=0,o=0}if(!Ks(A.tileAvailability,G))return d;Ks(A.contentAvailability,G)&&(d.contentUrl=Ei(g,C,K,L,$));const ct=o+1,j={mortonIndex:T,x:_,y:v,z:N};for(let V=0;V<m;V++){const At=cm(i,V,c),tt=await fc({subtree:A,implicitOptions:t,loaderOptions:n,parentData:j,childIndex:V,level:ct,globalData:{...a},s2VolumeBox:At});if(tt.contentUrl||tt.children.length){const Bt=C+1,_t=hm(tt,Bt,{childTileX:_,childTileY:v,childTileZ:N},t,i);d.children.push(_t)}}return d}function Ks(e,t){let r;return Array.isArray(e)?(r=e[0],e.length>1&&ra.once('Not supported extension "3DTILES_multiple_contents" has been detected')):r=e,"constant"in r?!!r.constant:r.explicitBitstream?gm(t,r.explicitBitstream):!1}function hm(e,t,r,s,i){const{basePath:n,refine:A,getRefine:o,lodMetricType:a,getTileType:c,rootLodMetricValue:h,rootBoundingVolume:u}=s,g=e.contentUrl&&e.contentUrl.replace(`${n}/`,""),l=h/2**t,B=i!=null&&i.box?{box:i.box}:u,d=um(t,B,r);return{children:e.children,contentUrl:e.contentUrl,content:{uri:g},id:e.contentUrl,refine:o(A),type:c(e),lodMetricType:a,lodMetricValue:l,geometricError:l,transform:e.transform,boundingVolume:d}}function um(e,t,r){if(t.region){const{childTileX:s,childTileY:i,childTileZ:n}=r,[A,o,a,c,h,u]=t.region,g=2**e,l=(a-A)/g,B=(c-o)/g,d=(u-h)/g,[C,m]=[A+l*s,A+l*(s+1)],[w,E]=[o+B*i,o+B*(i+1)],[p,R]=[h+d*n,h+d*(n+1)];return{region:[C,w,m,E,p,R]}}if(t.box)return t;throw new Error(`Unsupported bounding volume type ${t}`)}function se(e,t,r){return(e<<r)+t}function Ei(e,t,r,s,i){const n=lm({level:t,x:r,y:s,z:i});return e.replace(/{level}|{x}|{y}|{z}/gi,A=>n[A])}function lm(e){const t={};for(const r in e)t[`{${r}}`]=e[r];return t}function gm(e,t){const r=Math.floor(e/8),s=e%8;return(t[r]>>s&1)===1}function on(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";if(!t)return Qr.EMPTY;const r=t.split("?")[0].split(".").pop();switch(r){case"pnts":return Qr.POINTCLOUD;case"i3dm":case"b3dm":case"glb":case"gltf":return Qr.SCENEGRAPH;default:return r||Qr.EMPTY}}function an(e){switch(e){case"REPLACE":case"replace":return nA.REPLACE;case"ADD":case"add":return nA.ADD;default:return e}}function mi(e,t){if(/^[a-z][0-9a-z+.-]*:/i.test(t)){const r=new URL(e,`${t}/`);return decodeURI(r.toString())}else if(e.startsWith("/"))return e;return bu(t,e)}function PA(e,t){if(!e)return null;let r;if(e.content){var s;const i=e.content.uri||((s=e.content)===null||s===void 0?void 0:s.url);typeof i<"u"&&(r=mi(i,t))}return{...e,id:r,contentUrl:r,lodMetricType:is.GEOMETRIC_ERROR,lodMetricValue:e.geometricError,transformMatrix:e.transform,type:on(e,r),refine:an(e.refine)}}async function Bm(e,t,r){let s=null;const i=JA(e.root);i&&e.root?s=await HA(e.root,e,t,i,r):s=PA(e.root,t);const n=[];for(n.push(s);n.length>0;){const A=n.pop()||{},o=A.children||[],a=[];for(const c of o){const h=JA(c);let u;h?u=await HA(c,e,t,h,r):u=PA(c,t),u&&(a.push(u),n.push(u))}A.children=a}return s}async function HA(e,t,r,s,i){var n,A,o;const{subdivisionScheme:a,maximumLevel:c,availableLevels:h,subtreeLevels:u,subtrees:{uri:g}}=s,l=Ei(g,0,0,0,0),B=mi(l,r),d=await Re(B,nc,i),C=(n=e.content)===null||n===void 0?void 0:n.uri,m=C?mi(C,r):"",w=t==null||(A=t.root)===null||A===void 0?void 0:A.refine,E=e.geometricError,p=(o=e.boundingVolume.extensions)===null||o===void 0?void 0:o["3DTILES_bounding_volume_S2"];if(p){const T={box:dc(p),s2VolumeInfo:p};e.boundingVolume=T}const R=e.boundingVolume,y={contentUrlTemplate:m,subtreesUriTemplate:g,subdivisionScheme:a,subtreeLevels:u,maximumLevel:Number.isFinite(h)?h-1:c,refine:w,basePath:r,lodMetricType:is.GEOMETRIC_ERROR,rootLodMetricValue:E,rootBoundingVolume:R,getTileType:on,getRefine:an};return await dm(e,r,d,y,i)}async function dm(e,t,r,s,i){if(!e)return null;const{children:n,contentUrl:A}=await fc({subtree:r,implicitOptions:s,loaderOptions:i});let o,a=null;return A&&(o=A,a={uri:A.replace(`${t}/`,"")}),{...e,id:o,contentUrl:o,lodMetricType:is.GEOMETRIC_ERROR,lodMetricValue:e.geometricError,transformMatrix:e.transform,type:on(e,o),refine:an(e.refine),content:a||e.content,children:n}}function JA(e){var t;return(e==null||(t=e.extensions)===null||t===void 0?void 0:t["3DTILES_implicit_tiling"])||(e==null?void 0:e.implicitTiling)}const Ve={id:"3d-tiles",name:"3D Tiles",module:"3d-tiles",version:Da,extensions:["cmpt","pnts","b3dm","i3dm"],mimeTypes:["application/octet-stream"],tests:["cmpt","pnts","b3dm","i3dm"],parse:fm,options:{"3d-tiles":{loadGLTF:!0,decodeQuantizedPositions:!1,isTileset:"auto",assetGltfUpAxis:null}}};async function fm(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;const s=t["3d-tiles"]||{};let i;return s.isTileset==="auto"?i=(r==null?void 0:r.url)&&r.url.indexOf(".json")!==-1:i=s.isTileset,i?Cm(e,t,r):Im(e,t,r)}async function Cm(e,t,r){var s;const i=JSON.parse(new TextDecoder().decode(e)),n=(r==null?void 0:r.url)||"",A=Em(n),o=await Bm(i,A,t||{});return{...i,shape:"tileset3d",loader:Ve,url:n,queryString:(r==null?void 0:r.queryString)||"",basePath:A,root:o||i.root,type:nd.TILES3D,lodMetricType:is.GEOMETRIC_ERROR,lodMetricValue:((s=i.root)===null||s===void 0?void 0:s.geometricError)||0}}async function Im(e,t,r){const s={content:{shape:"tile3d",featureIds:null}};return await ic(e,0,t,r,s.content),s.content}function Em(e){return Xo(e)}const Cc="https://api.cesium.com/v1/assets";async function mm(e,t){if(!t){const n=await pm(e);for(const A of n.items)A.type==="3DTILES"&&(t=A.id)}const r=await ym(e,t),{type:s,url:i}=r;return X(s==="3DTILES"&&i),r.headers={Authorization:`Bearer ${r.accessToken}`},r}async function pm(e){X(e);const t=Cc,r={Authorization:`Bearer ${e}`},s=await Xe(t,{headers:r});if(!s.ok)throw new Error(s.statusText);return await s.json()}async function ym(e,t){X(e,t);const r={Authorization:`Bearer ${e}`},s=`${Cc}/${t}`;let i=await Xe(`${s}`,{headers:r});if(!i.ok)throw new Error(i.statusText);let n=await i.json();if(i=await Xe(`${s}/endpoint`,{headers:r}),!i.ok)throw new Error(i.statusText);const A=await i.json();return n={...n,...A},n}async function Qm(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};t=t["cesium-ion"]||{};const{accessToken:r}=t;let s=t.assetId;if(!Number.isFinite(s)){const i=e.match(/\/([0-9]+)\/tileset.json/);s=i&&i[1]}return mm(r,s)}const Ic={...Ve,id:"cesium-ion",name:"Cesium Ion",preload:Qm,parse:async(e,t,r)=>(t={...t},t["3d-tiles"]=t["cesium-ion"],t.loader=Ic,Ve.parse(e,t,r)),options:{"cesium-ion":{...Ve.options["3d-tiles"],accessToken:null}}},kA=100;class wm{constructor(t,r){if(this.schema=void 0,this.options=void 0,this.shape=void 0,this.length=0,this.rows=null,this.cursor=0,this._headers=[],this.options=r,this.schema=t,!Array.isArray(t)){this._headers=[];for(const s in t)this._headers[t[s].index]=t[s].name}}rowCount(){return this.length}addArrayRow(t,r){Number.isFinite(r)&&(this.cursor=r),this.shape="array-row-table",this.rows=this.rows||new Array(kA),this.rows[this.length]=t,this.length++}addObjectRow(t,r){Number.isFinite(r)&&(this.cursor=r),this.shape="object-row-table",this.rows=this.rows||new Array(kA),this.rows[this.length]=t,this.length++}getBatch(){let t=this.rows;return t?(t=t.slice(0,this.length),this.rows=null,{shape:this.shape||"array-row-table",batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}}function bm(e,t){if(!e)throw new Error("null row");const r={};if(t)for(let s=0;s<t.length;s++)r[t[s]]=e[s];else for(let s=0;s<e.length;s++){const i=`column-${s}`;r[i]=e[s]}return r}function Dm(e,t){if(!e)throw new Error("null row");if(t){const r=new Array(t.length);for(let s=0;s<t.length;s++)r[s]=e[t[s]];return r}return Object.values(e)}function Rm(e){const t=[];for(let r=0;r<e.length;r++){const s=`column-${r}`;t.push(s)}return t}function Sm(e){return Object.keys(e)}const qA=100;class Tm{constructor(t,r){if(this.schema=void 0,this.options=void 0,this.length=0,this.objectRows=null,this.arrayRows=null,this.cursor=0,this._headers=null,this.options=r,this.schema=t,t){this._headers=[];for(const s in t)this._headers[t[s].index]=t[s].name}}rowCount(){return this.length}addArrayRow(t,r){switch(Number.isFinite(r)&&(this.cursor=r),this._headers||(this._headers=Rm(t)),this.options.shape){case"object-row-table":const s=bm(t,this._headers);this.addObjectRow(s,r);break;case"array-row-table":this.arrayRows=this.arrayRows||new Array(qA),this.arrayRows[this.length]=t,this.length++;break}}addObjectRow(t,r){switch(Number.isFinite(r)&&(this.cursor=r),this._headers||(this._headers=Sm(t)),this.options.shape){case"array-row-table":const s=Dm(t,this._headers);this.addArrayRow(s,r);break;case"object-row-table":this.objectRows=this.objectRows||new Array(qA),this.objectRows[this.length]=t,this.length++;break}}getBatch(){let t=this.arrayRows||this.objectRows;return t?(t=t.slice(0,this.length),this.arrayRows=null,this.objectRows=null,{shape:this.options.shape,batchType:"data",data:t,length:this.length,schema:this.schema,cursor:this.cursor}):null}}const _m=100;class Mm{constructor(t,r){this.schema=void 0,this.length=0,this.allocated=0,this.columns={},this.schema=t,this._reallocateColumns()}rowCount(){return this.length}addArrayRow(t){this._reallocateColumns();let r=0;for(const s in this.columns)this.columns[s][this.length]=t[r++];this.length++}addObjectRow(t){this._reallocateColumns();for(const r in t)this.columns[r][this.length]=t[r];this.length++}getBatch(){this._pruneColumns();const t=Array.isArray(this.schema)?this.columns:{};if(!Array.isArray(this.schema))for(const r in this.schema){const s=this.schema[r];t[s.name]=this.columns[s.index]}return this.columns={},{shape:"columnar-table",batchType:"data",data:t,schema:this.schema,length:this.length}}_reallocateColumns(){if(!(this.length<this.allocated)){this.allocated=this.allocated>0?this.allocated*=2:_m,this.columns={};for(const t in this.schema){const r=this.schema[t],s=r.type||Float32Array,i=this.columns[r.index];if(i&&ArrayBuffer.isView(i)){const n=new s(this.allocated);n.set(i),this.columns[r.index]=n}else i?(i.length=this.allocated,this.columns[r.index]=i):this.columns[r.index]=new s(this.allocated)}}}_pruneColumns(){for(const[t,r]of Object.entries(this.columns))this.columns[t]=r.slice(0,this.length)}}const Fm={shape:void 0,batchSize:"auto",batchDebounceMs:0,limit:0,_limitMB:0},Gm="TableBatchBuilder";class $e{constructor(t,r){this.schema=void 0,this.options=void 0,this.aggregator=null,this.batchCount=0,this.bytesUsed=0,this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),this.totalLength=0,this.totalBytes=0,this.rowBytes=0,this.schema=t,this.options={...Fm,...r}}limitReached(){var t,r;return!!(!((t=this.options)===null||t===void 0)&&t.limit&&this.totalLength>=this.options.limit||!((r=this.options)===null||r===void 0)&&r._limitMB&&this.totalBytes/1e6>=this.options._limitMB)}addRow(t){this.limitReached()||(this.totalLength++,this.rowBytes=this.rowBytes||this._estimateRowMB(t),this.totalBytes+=this.rowBytes,Array.isArray(t)?this.addArrayRow(t):this.addObjectRow(t))}addArrayRow(t){if(!this.aggregator){const r=this._getTableBatchType();this.aggregator=new r(this.schema,this.options)}this.aggregator.addArrayRow(t)}addObjectRow(t){if(!this.aggregator){const r=this._getTableBatchType();this.aggregator=new r(this.schema,this.options)}this.aggregator.addObjectRow(t)}chunkComplete(t){t instanceof ArrayBuffer&&(this.bytesUsed+=t.byteLength),typeof t=="string"&&(this.bytesUsed+=t.length),this.isChunkComplete=!0}getFullBatch(t){return this._isFull()?this._getBatch(t):null}getFinalBatch(t){return this._getBatch(t)}_estimateRowMB(t){return Array.isArray(t)?t.length*8:Object.keys(t).length*8}_isFull(){if(!this.aggregator||this.aggregator.rowCount()===0)return!1;if(this.options.batchSize==="auto"){if(!this.isChunkComplete)return!1}else if(this.options.batchSize>this.aggregator.rowCount())return!1;return this.options.batchDebounceMs>Date.now()-this.lastBatchEmittedMs?!1:(this.isChunkComplete=!1,this.lastBatchEmittedMs=Date.now(),!0)}_getBatch(t){if(!this.aggregator)return null;t!=null&&t.bytesUsed&&(this.bytesUsed=t.bytesUsed);const r=this.aggregator.getBatch();return r.count=this.batchCount,r.bytesUsed=this.bytesUsed,Object.assign(r,t),this.batchCount++,this.aggregator=null,r}_getTableBatchType(){switch(this.options.shape){case"array-row-table":case"object-row-table":return Tm;case"columnar-table":return Mm;case"arrow-table":if(!$e.ArrowBatch)throw new Error(Gm);return $e.ArrowBatch;default:return wm}}}$e.ArrowBatch=void 0;function vm(e){try{let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return async function*(){const r=new TextDecoder(void 0,t);for await(const s of e)yield typeof s=="string"?s:r.decode(s,{stream:!0})}()}catch(t){return Promise.reject(t)}}const pi=Number.MAX_SAFE_INTEGER;var S=function(e){return e[e.BEGIN=0]="BEGIN",e[e.VALUE=1]="VALUE",e[e.OPEN_OBJECT=2]="OPEN_OBJECT",e[e.CLOSE_OBJECT=3]="CLOSE_OBJECT",e[e.OPEN_ARRAY=4]="OPEN_ARRAY",e[e.CLOSE_ARRAY=5]="CLOSE_ARRAY",e[e.TEXT_ESCAPE=6]="TEXT_ESCAPE",e[e.STRING=7]="STRING",e[e.BACKSLASH=8]="BACKSLASH",e[e.END=9]="END",e[e.OPEN_KEY=10]="OPEN_KEY",e[e.CLOSE_KEY=11]="CLOSE_KEY",e[e.TRUE=12]="TRUE",e[e.TRUE2=13]="TRUE2",e[e.TRUE3=14]="TRUE3",e[e.FALSE=15]="FALSE",e[e.FALSE2=16]="FALSE2",e[e.FALSE3=17]="FALSE3",e[e.FALSE4=18]="FALSE4",e[e.NULL=19]="NULL",e[e.NULL2=20]="NULL2",e[e.NULL3=21]="NULL3",e[e.NUMBER_DECIMAL_POINT=22]="NUMBER_DECIMAL_POINT",e[e.NUMBER_DIGIT=23]="NUMBER_DIGIT",e}(S||{});const M={tab:9,lineFeed:10,carriageReturn:13,space:32,doubleQuote:34,plus:43,comma:44,minus:45,period:46,_0:48,_9:57,colon:58,E:69,openBracket:91,backslash:92,closeBracket:93,a:97,b:98,e:101,f:102,l:108,n:110,r:114,s:115,t:116,u:117,openBrace:123,closeBrace:125},KA=/[\\"\n]/g,jA={onready:()=>{},onopenobject:()=>{},onkey:()=>{},oncloseobject:()=>{},onopenarray:()=>{},onclosearray:()=>{},onvalue:()=>{},onerror:()=>{},onend:()=>{},onchunkparsed:()=>{}};class Lm{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.options=jA,this.bufferCheckPosition=pi,this.q="",this.c="",this.p="",this.closed=!1,this.closedRoot=!1,this.sawRoot=!1,this.error=null,this.state=S.BEGIN,this.stack=[],this.position=0,this.column=0,this.line=1,this.slashed=!1,this.unicodeI=0,this.unicodeS=null,this.depth=0,this.textNode=void 0,this.numberNode=void 0,this.options={...jA,...t},this.textNode=void 0,this.numberNode="",this.emit("onready")}end(){return(this.state!==S.VALUE||this.depth!==0)&&this._error("Unexpected end"),this._closeValue(),this.c="",this.closed=!0,this.emit("onend"),this}resume(){return this.error=null,this}close(){return this.write(null)}emit(t,r){var s,i;(s=(i=this.options)[t])===null||s===void 0||s.call(i,r,this)}emitNode(t,r){this._closeValue(),this.emit(t,r)}write(t){if(this.error)throw this.error;if(this.closed)return this._error("Cannot write after close. Assign an onready handler.");if(t===null)return this.end();let r=0,s=t.charCodeAt(0),i=this.p;for(;s&&(i=s,this.c=s=t.charCodeAt(r++),i!==s?this.p=i:i=this.p,!!s);)switch(this.position++,s===M.lineFeed?(this.line++,this.column=0):this.column++,this.state){case S.BEGIN:s===M.openBrace?this.state=S.OPEN_OBJECT:s===M.openBracket?this.state=S.OPEN_ARRAY:Oe(s)||this._error("Non-whitespace before {[.");continue;case S.OPEN_KEY:case S.OPEN_OBJECT:if(Oe(s))continue;if(this.state===S.OPEN_KEY)this.stack.push(S.CLOSE_KEY);else if(s===M.closeBrace){this.emit("onopenobject"),this.depth++,this.emit("oncloseobject"),this.depth--,this.state=this.stack.pop()||S.VALUE;continue}else this.stack.push(S.CLOSE_OBJECT);s===M.doubleQuote?this.state=S.STRING:this._error('Malformed object key should start with "');continue;case S.CLOSE_KEY:case S.CLOSE_OBJECT:if(Oe(s))continue;s===M.colon?(this.state===S.CLOSE_OBJECT?(this.stack.push(S.CLOSE_OBJECT),this._closeValue("onopenobject"),this.depth++):this._closeValue("onkey"),this.state=S.VALUE):s===M.closeBrace?(this.emitNode("oncloseobject"),this.depth--,this.state=this.stack.pop()||S.VALUE):s===M.comma?(this.state===S.CLOSE_OBJECT&&this.stack.push(S.CLOSE_OBJECT),this._closeValue(),this.state=S.OPEN_KEY):this._error("Bad object");continue;case S.OPEN_ARRAY:case S.VALUE:if(Oe(s))continue;if(this.state===S.OPEN_ARRAY)if(this.emit("onopenarray"),this.depth++,this.state=S.VALUE,s===M.closeBracket){this.emit("onclosearray"),this.depth--,this.state=this.stack.pop()||S.VALUE;continue}else this.stack.push(S.CLOSE_ARRAY);s===M.doubleQuote?this.state=S.STRING:s===M.openBrace?this.state=S.OPEN_OBJECT:s===M.openBracket?this.state=S.OPEN_ARRAY:s===M.t?this.state=S.TRUE:s===M.f?this.state=S.FALSE:s===M.n?this.state=S.NULL:s===M.minus?this.numberNode+="-":M._0<=s&&s<=M._9?(this.numberNode+=String.fromCharCode(s),this.state=S.NUMBER_DIGIT):this._error("Bad value");continue;case S.CLOSE_ARRAY:if(s===M.comma)this.stack.push(S.CLOSE_ARRAY),this._closeValue("onvalue"),this.state=S.VALUE;else if(s===M.closeBracket)this.emitNode("onclosearray"),this.depth--,this.state=this.stack.pop()||S.VALUE;else{if(Oe(s))continue;this._error("Bad array")}continue;case S.STRING:this.textNode===void 0&&(this.textNode="");let n=r-1,A=this.slashed,o=this.unicodeI;t:for(;;){for(;o>0;)if(this.unicodeS+=String.fromCharCode(s),s=t.charCodeAt(r++),this.position++,o===4?(this.textNode+=String.fromCharCode(parseInt(this.unicodeS,16)),o=0,n=r-1):o++,!s)break t;if(s===M.doubleQuote&&!A){this.state=this.stack.pop()||S.VALUE,this.textNode+=t.substring(n,r-1),this.position+=r-1-n;break}if(s===M.backslash&&!A&&(A=!0,this.textNode+=t.substring(n,r-1),this.position+=r-1-n,s=t.charCodeAt(r++),this.position++,!s))break;if(A){if(A=!1,s===M.n?this.textNode+=`
`:s===M.r?this.textNode+="\r":s===M.t?this.textNode+="	":s===M.f?this.textNode+="\f":s===M.b?this.textNode+="\b":s===M.u?(o=1,this.unicodeS=""):this.textNode+=String.fromCharCode(s),s=t.charCodeAt(r++),this.position++,n=r-1,s)continue;break}KA.lastIndex=r;const a=KA.exec(t);if(a===null){r=t.length+1,this.textNode+=t.substring(n,r-1),this.position+=r-1-n;break}if(r=a.index+1,s=t.charCodeAt(a.index),!s){this.textNode+=t.substring(n,r-1),this.position+=r-1-n;break}}this.slashed=A,this.unicodeI=o;continue;case S.TRUE:s===M.r?this.state=S.TRUE2:this._error(`Invalid true started with t${s}`);continue;case S.TRUE2:s===M.u?this.state=S.TRUE3:this._error(`Invalid true started with tr${s}`);continue;case S.TRUE3:s===M.e?(this.emit("onvalue",!0),this.state=this.stack.pop()||S.VALUE):this._error(`Invalid true started with tru${s}`);continue;case S.FALSE:s===M.a?this.state=S.FALSE2:this._error(`Invalid false started with f${s}`);continue;case S.FALSE2:s===M.l?this.state=S.FALSE3:this._error(`Invalid false started with fa${s}`);continue;case S.FALSE3:s===M.s?this.state=S.FALSE4:this._error(`Invalid false started with fal${s}`);continue;case S.FALSE4:s===M.e?(this.emit("onvalue",!1),this.state=this.stack.pop()||S.VALUE):this._error(`Invalid false started with fals${s}`);continue;case S.NULL:s===M.u?this.state=S.NULL2:this._error(`Invalid null started with n${s}`);continue;case S.NULL2:s===M.l?this.state=S.NULL3:this._error(`Invalid null started with nu${s}`);continue;case S.NULL3:s===M.l?(this.emit("onvalue",null),this.state=this.stack.pop()||S.VALUE):this._error(`Invalid null started with nul${s}`);continue;case S.NUMBER_DECIMAL_POINT:s===M.period?(this.numberNode+=".",this.state=S.NUMBER_DIGIT):this._error("Leading zero not followed by .");continue;case S.NUMBER_DIGIT:M._0<=s&&s<=M._9?this.numberNode+=String.fromCharCode(s):s===M.period?(this.numberNode.indexOf(".")!==-1&&this._error("Invalid number has two dots"),this.numberNode+="."):s===M.e||s===M.E?((this.numberNode.indexOf("e")!==-1||this.numberNode.indexOf("E")!==-1)&&this._error("Invalid number has two exponential"),this.numberNode+="e"):s===M.plus||s===M.minus?(i===M.e||i===M.E||this._error("Invalid symbol in number"),this.numberNode+=String.fromCharCode(s)):(this._closeNumber(),r--,this.state=this.stack.pop()||S.VALUE);continue;default:this._error(`Unknown state: ${this.state}`)}return this.position>=this.bufferCheckPosition&&xm(this),this.emit("onchunkparsed"),this}_closeValue(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"onvalue";this.textNode!==void 0&&this.emit(t,this.textNode),this.textNode=void 0}_closeNumber(){this.numberNode&&this.emit("onvalue",parseFloat(this.numberNode)),this.numberNode=""}_error(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";this._closeValue(),t+=`
Line: ${this.line}
Column: ${this.column}
Char: ${this.c}`;const r=new Error(t);this.error=r,this.emit("onerror",r)}}function Oe(e){return e===M.carriageReturn||e===M.lineFeed||e===M.space||e===M.tab}function xm(e){const t=Math.max(pi,10);let r=0;for(const s of["textNode","numberNode"]){const i=e[s]===void 0?0:e[s].length;if(i>t)switch(s){case"text":break;default:e._error(`Max buffer length exceeded: ${s}`)}r=Math.max(r,i)}e.bufferCheckPosition=pi-r+e.position}class ce{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(this.path=void 0,this.path=["$"],t instanceof ce){this.path=[...t.path];return}if(Array.isArray(t)){this.path.push(...t);return}if(typeof t=="string"&&(this.path=t.split("."),this.path[0]!=="$"))throw new Error("JSONPaths must start with $")}clone(){return new ce(this)}toString(){return this.path.join(".")}push(t){this.path.push(t)}pop(){return this.path.pop()}set(t){this.path[this.path.length-1]=t}equals(t){if(!this||!t||this.path.length!==t.path.length)return!1;for(let r=0;r<this.path.length;++r)if(this.path[r]!==t.path[r])return!1;return!0}setFieldAtPath(t,r){const s=[...this.path];s.shift();const i=s.pop();for(const n of s)t=t[n];t[i]=r}getFieldAtPath(t){const r=[...this.path];r.shift();const s=r.pop();for(const i of r)t=t[i];return t[s]}}class Um{constructor(t){this.parser=void 0,this.result=void 0,this.previousStates=[],this.currentState=Object.freeze({container:[],key:null}),this.jsonpath=new ce,this.reset(),this.parser=new Lm({onready:()=>{this.jsonpath=new ce,this.previousStates.length=0,this.currentState.container.length=0},onopenobject:r=>{this._openObject({}),typeof r<"u"&&this.parser.emit("onkey",r)},onkey:r=>{this.jsonpath.set(r),this.currentState.key=r},oncloseobject:()=>{this._closeObject()},onopenarray:()=>{this._openArray()},onclosearray:()=>{this._closeArray()},onvalue:r=>{this._pushOrSet(r)},onerror:r=>{throw r},onend:()=>{this.result=this.currentState.container.pop()},...t})}reset(){this.result=void 0,this.previousStates=[],this.currentState=Object.freeze({container:[],key:null}),this.jsonpath=new ce}write(t){this.parser.write(t)}close(){this.parser.close()}_pushOrSet(t){const{container:r,key:s}=this.currentState;s!==null?(r[s]=t,this.currentState.key=null):r.push(t)}_openArray(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];this.jsonpath.push(null),this._pushOrSet(t),this.previousStates.push(this.currentState),this.currentState={container:t,isArray:!0,key:null}}_closeArray(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}_openObject(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.jsonpath.push(null),this._pushOrSet(t),this.previousStates.push(this.currentState),this.currentState={container:t,isArray:!1,key:null}}_closeObject(){this.jsonpath.pop(),this.currentState=this.previousStates.pop()}}class Om extends Um{constructor(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super({onopenarray:()=>{if(!this.streamingArray&&this._matchJSONPath()){this.streamingJsonPath=this.getJsonPath().clone(),this.streamingArray=[],this._openArray(this.streamingArray);return}this._openArray()},onopenobject:s=>{this.topLevelObject?this._openObject({}):(this.topLevelObject={},this._openObject(this.topLevelObject)),typeof s<"u"&&this.parser.emit("onkey",s)}}),this.jsonPaths=void 0,this.streamingJsonPath=null,this.streamingArray=null,this.topLevelObject=null;const r=t.jsonpaths||[];this.jsonPaths=r.map(s=>new ce(s))}write(t){super.write(t);let r=[];return this.streamingArray&&(r=[...this.streamingArray],this.streamingArray.length=0),r}getPartialResult(){return this.topLevelObject}getStreamingJsonPath(){return this.streamingJsonPath}getStreamingJsonPathAsString(){return this.streamingJsonPath&&this.streamingJsonPath.toString()}getJsonPath(){return this.jsonpath}_matchJSONPath(){const t=this.getJsonPath();if(this.jsonPaths.length===0)return!0;for(const r of this.jsonPaths)if(r.equals(t))return!0;return!1}}async function*Nm(e,t){const r=vm(e),{metadata:s}=t,{jsonpaths:i}=t.json||{};let n=!0;const A=null,o=new $e(A,t),a=new Om({jsonpaths:i});for await(const g of r){const l=a.write(g),B=l.length>0&&a.getStreamingJsonPathAsString();if(l.length>0&&n){if(s){var c;yield{shape:(t==null||(c=t.json)===null||c===void 0?void 0:c.shape)||"array-row-table",batchType:"partial-result",data:[],length:0,bytesUsed:0,container:a.getPartialResult(),jsonpath:B}}n=!1}for(const C of l){o.addRow(C);const m=o.getFullBatch({jsonpath:B});m&&(yield m)}o.chunkComplete(g);const d=o.getFullBatch({jsonpath:B});d&&(yield d)}const h=a.getStreamingJsonPathAsString(),u=o.getFinalBatch({jsonpath:h});u&&(yield u),s&&(yield{shape:"json",batchType:"final-result",container:a.getPartialResult(),jsonpath:a.getStreamingJsonPathAsString(),data:[],length:0})}const Wr={x:0,y:1,z:2};function Ec(e,t={}){const{start:r=0,end:s=e.length,plane:i="xy"}=t,n=t.size||2;let A=0;const o=Wr[i[0]],a=Wr[i[1]];for(let c=r,h=s-n;c<s;c+=n)A+=(e[c+o]-e[h+o])*(e[c+a]+e[h+a]),h=c;return A/2}function Pm(e,t,r=2,s,i="xy"){const n=t&&t.length,A=n?t[0]*r:e.length;let o=mc(e,0,A,r,!0,s&&s[0],i);const a=[];if(!o||o.next===o.prev)return a;let c,h,u,g,l,B,d;if(n&&(o=Km(e,t,o,r,s,i)),e.length>80*r){g=h=e[0],l=u=e[1];for(let C=r;C<A;C+=r)B=e[C],d=e[C+1],B<g&&(g=B),d<l&&(l=d),B>h&&(h=B),d>u&&(u=d);c=Math.max(h-g,u-l),c=c!==0?32767/c:0}return tr(o,a,r,g,l,c,0),a}function mc(e,t,r,s,i,n,A){let o,a;n===void 0&&(n=Ec(e,{start:t,end:r,size:s,plane:A}));let c=Wr[A[0]],h=Wr[A[1]];if(i===n<0)for(o=t;o<r;o+=s)a=VA(o,e[o+c],e[o+h],a);else for(o=r-s;o>=t;o-=s)a=VA(o,e[o+c],e[o+h],a);return a&&as(a,a.next)&&(rr(a),a=a.next),a}function ue(e,t){if(!e)return e;t||(t=e);let r=e,s;do if(s=!1,!r.steiner&&(as(r,r.next)||z(r.prev,r,r.next)===0)){if(rr(r),r=t=r.prev,r===r.next)break;s=!0}else r=r.next;while(s||r!==t);return t}function tr(e,t,r,s,i,n,A){if(!e)return;!A&&n&&Xm(e,s,i,n);let o=e,a,c;for(;e.prev!==e.next;){if(a=e.prev,c=e.next,n?Jm(e,s,i,n):Hm(e)){t.push(a.i/r|0),t.push(e.i/r|0),t.push(c.i/r|0),rr(e),e=c.next,o=c.next;continue}if(e=c,e===o){A?A===1?(e=km(ue(e),t,r),tr(e,t,r,s,i,n,2)):A===2&&qm(e,t,r,s,i,n):tr(ue(e),t,r,s,i,n,1);break}}}function Hm(e){const t=e.prev,r=e,s=e.next;if(z(t,r,s)>=0)return!1;const i=t.x,n=r.x,A=s.x,o=t.y,a=r.y,c=s.y,h=i<n?i<A?i:A:n<A?n:A,u=o<a?o<c?o:c:a<c?a:c,g=i>n?i>A?i:A:n>A?n:A,l=o>a?o>c?o:c:a>c?a:c;let B=s.next;for(;B!==t;){if(B.x>=h&&B.x<=g&&B.y>=u&&B.y<=l&&we(i,o,n,a,A,c,B.x,B.y)&&z(B.prev,B,B.next)>=0)return!1;B=B.next}return!0}function Jm(e,t,r,s){const i=e.prev,n=e,A=e.next;if(z(i,n,A)>=0)return!1;const o=i.x,a=n.x,c=A.x,h=i.y,u=n.y,g=A.y,l=o<a?o<c?o:c:a<c?a:c,B=h<u?h<g?h:g:u<g?u:g,d=o>a?o>c?o:c:a>c?a:c,C=h>u?h>g?h:g:u>g?u:g,m=yi(l,B,t,r,s),w=yi(d,C,t,r,s);let E=e.prevZ,p=e.nextZ;for(;E&&E.z>=m&&p&&p.z<=w;){if(E.x>=l&&E.x<=d&&E.y>=B&&E.y<=C&&E!==i&&E!==A&&we(o,h,a,u,c,g,E.x,E.y)&&z(E.prev,E,E.next)>=0||(E=E.prevZ,p.x>=l&&p.x<=d&&p.y>=B&&p.y<=C&&p!==i&&p!==A&&we(o,h,a,u,c,g,p.x,p.y)&&z(p.prev,p,p.next)>=0))return!1;p=p.nextZ}for(;E&&E.z>=m;){if(E.x>=l&&E.x<=d&&E.y>=B&&E.y<=C&&E!==i&&E!==A&&we(o,h,a,u,c,g,E.x,E.y)&&z(E.prev,E,E.next)>=0)return!1;E=E.prevZ}for(;p&&p.z<=w;){if(p.x>=l&&p.x<=d&&p.y>=B&&p.y<=C&&p!==i&&p!==A&&we(o,h,a,u,c,g,p.x,p.y)&&z(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function km(e,t,r){let s=e;do{const i=s.prev,n=s.next.next;!as(i,n)&&pc(i,s,s.next,n)&&er(i,n)&&er(n,i)&&(t.push(i.i/r|0),t.push(s.i/r|0),t.push(n.i/r|0),rr(s),rr(s.next),s=e=n),s=s.next}while(s!==e);return ue(s)}function qm(e,t,r,s,i,n){let A=e;do{let o=A.next.next;for(;o!==A.prev;){if(A.i!==o.i&&$m(A,o)){let a=yc(A,o);A=ue(A,A.next),a=ue(a,a.next),tr(A,t,r,s,i,n,0),tr(a,t,r,s,i,n,0);return}o=o.next}A=A.next}while(A!==e)}function Km(e,t,r,s,i,n){const A=[];let o,a,c,h,u;for(o=0,a=t.length;o<a;o++)c=t[o]*s,h=o<a-1?t[o+1]*s:e.length,u=mc(e,c,h,s,!1,i&&i[o+1],n),u===u.next&&(u.steiner=!0),A.push(Zm(u));for(A.sort(jm),o=0;o<A.length;o++)r=Vm(A[o],r);return r}function jm(e,t){return e.x-t.x}function Vm(e,t){const r=Ym(e,t);if(!r)return t;const s=yc(r,e);return ue(s,s.next),ue(r,r.next)}function Ym(e,t){let r=t;const s=e.x,i=e.y;let n=-1/0,A;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){const g=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(g<=s&&g>n&&(n=g,A=r.x<r.next.x?r:r.next,g===s))return A}r=r.next}while(r!==t);if(!A)return null;const o=A,a=A.x,c=A.y;let h=1/0,u;r=A;do s>=r.x&&r.x>=a&&s!==r.x&&we(i<c?s:n,i,a,c,i<c?n:s,i,r.x,r.y)&&(u=Math.abs(i-r.y)/(s-r.x),er(r,e)&&(u<h||u===h&&(r.x>A.x||r.x===A.x&&Wm(A,r)))&&(A=r,h=u)),r=r.next;while(r!==o);return A}function Wm(e,t){return z(e.prev,e,t.prev)<0&&z(t.next,e,e.next)<0}function Xm(e,t,r,s){let i=e;do i.z===0&&(i.z=yi(i.x,i.y,t,r,s)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,zm(i)}function zm(e){let t,r,s=1,i,n,A,o,a,c;do{for(n=e,e=null,c=null,i=0;n;){for(i++,o=n,A=0,r=0;r<s&&(A++,o=o.nextZ,!!o);r++);for(a=s;A>0||a>0&&o;)A!==0&&(a===0||!o||n.z<=o.z)?(t=n,n=n.nextZ,A--):(t=o,o=o.nextZ,a--),c?c.nextZ=t:e=t,t.prevZ=c,c=t;n=o}c.nextZ=null,s*=2}while(i>1);return e}function yi(e,t,r,s,i){return e=(e-r)*i|0,t=(t-s)*i|0,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function Zm(e){let t=e,r=e;do(t.x<r.x||t.x===r.x&&t.y<r.y)&&(r=t),t=t.next;while(t!==e);return r}function we(e,t,r,s,i,n,A,o){return(i-A)*(t-o)>=(e-A)*(n-o)&&(e-A)*(s-o)>=(r-A)*(t-o)&&(r-A)*(n-o)>=(i-A)*(s-o)}function $m(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!t0(e,t)&&(er(e,t)&&er(t,e)&&e0(e,t)&&(z(e.prev,e,t.prev)||z(e,t.prev,t))||as(e,t)&&z(e.prev,e,e.next)>0&&z(t.prev,t,t.next)>0)}function z(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function as(e,t){return e.x===t.x&&e.y===t.y}function pc(e,t,r,s){const i=Tr(z(e,t,r)),n=Tr(z(e,t,s)),A=Tr(z(r,s,e)),o=Tr(z(r,s,t));return!!(i!==n&&A!==o||i===0&&Sr(e,r,t)||n===0&&Sr(e,s,t)||A===0&&Sr(r,e,s)||o===0&&Sr(r,t,s))}function Sr(e,t,r){return t.x<=Math.max(e.x,r.x)&&t.x>=Math.min(e.x,r.x)&&t.y<=Math.max(e.y,r.y)&&t.y>=Math.min(e.y,r.y)}function Tr(e){return e>0?1:e<0?-1:0}function t0(e,t){let r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&pc(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function er(e,t){return z(e.prev,e,e.next)<0?z(e,t,e.next)>=0&&z(e,e.prev,t)>=0:z(e,t,e.prev)<0||z(e,e.next,t)<0}function e0(e,t){let r=e,s=!1;const i=(e.x+t.x)/2,n=(e.y+t.y)/2;do r.y>n!=r.next.y>n&&r.next.y!==r.y&&i<(r.next.x-r.x)*(n-r.y)/(r.next.y-r.y)+r.x&&(s=!s),r=r.next;while(r!==e);return s}function yc(e,t){const r=new Qi(e.i,e.x,e.y),s=new Qi(t.i,t.x,t.y),i=e.next,n=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,s.next=r,r.prev=s,n.next=s,s.prev=n,s}function VA(e,t,r,s){const i=new Qi(e,t,r);return s?(i.next=s.next,i.prev=s,s.next.prev=i,s.next=i):(i.prev=i,i.next=i),i}function rr(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}class Qi{constructor(t,r,s){this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1,this.i=t,this.x=r,this.y=s}}function r0(e,t,r){const s=s0(e),i=Object.keys(s).filter(n=>s[n]!==Array);return i0(e,{propArrayTypes:s,...t},{numericPropKeys:r&&r.numericPropKeys||i,PositionDataType:r?r.PositionDataType:Float32Array,triangulate:r?r.triangulate:!0})}function s0(e){const t={};for(const r of e)if(r.properties)for(const s in r.properties){const i=r.properties[s];t[s]=h0(i,t[s])}return t}function i0(e,t,r){const{pointPositionsCount:s,pointFeaturesCount:i,linePositionsCount:n,linePathsCount:A,lineFeaturesCount:o,polygonPositionsCount:a,polygonObjectsCount:c,polygonRingsCount:h,polygonFeaturesCount:u,propArrayTypes:g,coordLength:l}=t,{numericPropKeys:B=[],PositionDataType:d=Float32Array,triangulate:C=!0}=r,m=e[0]&&"id"in e[0],w=e.length>65535?Uint32Array:Uint16Array,E={type:"Point",positions:new d(s*l),globalFeatureIds:new w(s),featureIds:i>65535?new Uint32Array(s):new Uint16Array(s),numericProps:{},properties:[],fields:[]},p={type:"LineString",pathIndices:n>65535?new Uint32Array(A+1):new Uint16Array(A+1),positions:new d(n*l),globalFeatureIds:new w(n),featureIds:o>65535?new Uint32Array(n):new Uint16Array(n),numericProps:{},properties:[],fields:[]},R={type:"Polygon",polygonIndices:a>65535?new Uint32Array(c+1):new Uint16Array(c+1),primitivePolygonIndices:a>65535?new Uint32Array(h+1):new Uint16Array(h+1),positions:new d(a*l),globalFeatureIds:new w(a),featureIds:u>65535?new Uint32Array(a):new Uint16Array(a),numericProps:{},properties:[],fields:[]};C&&(R.triangles=[]);for(const T of[E,p,R])for(const G of B){const _=g[G];T.numericProps[G]=new _(T.positions.length/l)}p.pathIndices[A]=n,R.polygonIndices[c]=a,R.primitivePolygonIndices[h]=a;const y={pointPosition:0,pointFeature:0,linePosition:0,linePath:0,lineFeature:0,polygonPosition:0,polygonObject:0,polygonRing:0,polygonFeature:0,feature:0};for(const T of e){const G=T.geometry,_=T.properties||{};switch(G.type){case"Point":n0(G,E,y,l,_),E.properties.push(Vs(_,B)),m&&E.fields.push({id:T.id}),y.pointFeature++;break;case"LineString":A0(G,p,y,l,_),p.properties.push(Vs(_,B)),m&&p.fields.push({id:T.id}),y.lineFeature++;break;case"Polygon":o0(G,R,y,l,_),R.properties.push(Vs(_,B)),m&&R.fields.push({id:T.id}),y.polygonFeature++;break;default:throw new Error("Invalid geometry type")}y.feature++}return c0(E,p,R,l)}function n0(e,t,r,s,i){t.positions.set(e.data,r.pointPosition*s);const n=e.data.length/s;cn(t,i,r.pointPosition,n),t.globalFeatureIds.fill(r.feature,r.pointPosition,r.pointPosition+n),t.featureIds.fill(r.pointFeature,r.pointPosition,r.pointPosition+n),r.pointPosition+=n}function A0(e,t,r,s,i){t.positions.set(e.data,r.linePosition*s);const n=e.data.length/s;cn(t,i,r.linePosition,n),t.globalFeatureIds.fill(r.feature,r.linePosition,r.linePosition+n),t.featureIds.fill(r.lineFeature,r.linePosition,r.linePosition+n);for(let A=0,o=e.indices.length;A<o;++A){const a=e.indices[A],c=A===o-1?e.data.length:e.indices[A+1];t.pathIndices[r.linePath++]=r.linePosition,r.linePosition+=(c-a)/s}}function o0(e,t,r,s,i){t.positions.set(e.data,r.polygonPosition*s);const n=e.data.length/s;cn(t,i,r.polygonPosition,n),t.globalFeatureIds.fill(r.feature,r.polygonPosition,r.polygonPosition+n),t.featureIds.fill(r.polygonFeature,r.polygonPosition,r.polygonPosition+n);for(let A=0,o=e.indices.length;A<o;++A){const a=r.polygonPosition;t.polygonIndices[r.polygonObject++]=a;const c=e.areas[A],h=e.indices[A],u=e.indices[A+1];for(let l=0,B=h.length;l<B;++l){const d=h[l],C=l===B-1?u===void 0?e.data.length:u[0]:h[l+1];t.primitivePolygonIndices[r.polygonRing++]=r.polygonPosition,r.polygonPosition+=(C-d)/s}const g=r.polygonPosition;a0(t,c,h,{startPosition:a,endPosition:g,coordLength:s})}}function a0(e,t,r,s){let{startPosition:i,endPosition:n,coordLength:A}=s;if(!e.triangles)return;const o=i*A,a=n*A,c=e.positions.subarray(o,a),h=r[0],u=r.slice(1).map(l=>(l-h)/A),g=Pm(c,u,A,t);for(let l=0,B=g.length;l<B;++l)e.triangles.push(i+g[l])}function js(e,t){const r={};for(const s in e)r[s]={value:e[s],size:t};return r}function c0(e,t,r,s){const i={shape:"binary-feature-collection",points:{...e,positions:{value:e.positions,size:s},globalFeatureIds:{value:e.globalFeatureIds,size:1},featureIds:{value:e.featureIds,size:1},numericProps:js(e.numericProps,1)},lines:{...t,positions:{value:t.positions,size:s},pathIndices:{value:t.pathIndices,size:1},globalFeatureIds:{value:t.globalFeatureIds,size:1},featureIds:{value:t.featureIds,size:1},numericProps:js(t.numericProps,1)},polygons:{...r,positions:{value:r.positions,size:s},polygonIndices:{value:r.polygonIndices,size:1},primitivePolygonIndices:{value:r.primitivePolygonIndices,size:1},globalFeatureIds:{value:r.globalFeatureIds,size:1},featureIds:{value:r.featureIds,size:1},numericProps:js(r.numericProps,1)}};return i.polygons&&r.triangles&&(i.polygons.triangles={value:new Uint32Array(r.triangles),size:1}),i}function cn(e,t,r,s){for(const i in e.numericProps)if(i in t){const n=t[i];e.numericProps[i].fill(n,r,r+s)}}function Vs(e,t){const r={};for(const s in e)t.includes(s)||(r[s]=e[s]);return r}function h0(e,t){return t===Array||!Number.isFinite(e)?Array:t===Float64Array||Math.fround(e)!==e?Float64Array:Float32Array}function u0(e){let t=0,r=0,s=0,i=0,n=0,A=0,o=0,a=0,c=0;const h=new Set;for(const u of e){const g=u.geometry;switch(g.type){case"Point":r++,t++,h.add(g.coordinates.length);break;case"MultiPoint":r++,t+=g.coordinates.length;for(const B of g.coordinates)h.add(B.length);break;case"LineString":n++,s+=g.coordinates.length,i++;for(const B of g.coordinates)h.add(B.length);break;case"MultiLineString":n++;for(const B of g.coordinates){s+=B.length,i++;for(const d of B)h.add(d.length)}break;case"Polygon":c++,o++,a+=g.coordinates.length;const l=g.coordinates.flat();A+=l.length;for(const B of l)h.add(B.length);break;case"MultiPolygon":c++;for(const B of g.coordinates){o++,a+=B.length;const d=B.flat();A+=d.length;for(const C of d)h.add(C.length)}break;default:throw new Error(`Unsupported geometry type: ${g.type}`)}}return{coordLength:h.size>0?Math.max(...h):2,pointPositionsCount:t,pointFeaturesCount:r,linePositionsCount:s,linePathsCount:i,lineFeaturesCount:n,polygonPositionsCount:A,polygonObjectsCount:o,polygonRingsCount:a,polygonFeaturesCount:c}}function l0(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{coordLength:2,fixRingWinding:!0};return e.map(r=>g0(r,t))}function YA(e,t,r,s){r.push(t.length),t.push(...e);for(let i=e.length;i<s.coordLength;i++)t.push(0)}function wi(e,t,r,s){r.push(t.length);for(const i of e){t.push(...i);for(let n=i.length;n<s.coordLength;n++)t.push(0)}}function WA(e,t,r,s,i){let n=0;const A=[],o=[];for(const a of e){const c=a.map(g=>g.slice(0,2));let h=Ec(c.flat());const u=h<0;i.fixRingWinding&&(n===0&&!u||n>0&&u)&&(a.reverse(),h=-h),A.push(h),wi(a,t,o,i),n++}n>0&&(s.push(A),r.push(o))}function g0(e,t){const{geometry:r}=e;if(r.type==="GeometryCollection")throw new Error("GeometryCollection type not supported");const s=[],i=[];let n,A;switch(r.type){case"Point":A="Point",YA(r.coordinates,s,i,t);break;case"MultiPoint":A="Point",r.coordinates.map(o=>YA(o,s,i,t));break;case"LineString":A="LineString",wi(r.coordinates,s,i,t);break;case"MultiLineString":A="LineString",r.coordinates.map(o=>wi(o,s,i,t));break;case"Polygon":A="Polygon",n=[],WA(r.coordinates,s,i,n,t);break;case"MultiPolygon":A="Polygon",n=[],r.coordinates.map(o=>WA(o,s,i,n,t));break;default:throw new Error(`Unknown type: ${A}`)}return{...e,geometry:{type:A,indices:i,data:s,areas:n}}}function Qc(e){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{fixRingWinding:!0,triangulate:!0};const r=u0(e),s=r.coordLength,{fixRingWinding:i}=t,n=l0(e,{coordLength:s,fixRingWinding:i});return r0(n,r,{numericPropKeys:t.numericPropKeys,PositionDataType:t.PositionDataType||Float32Array,triangulate:t.triangulate})}const B0="4.1.4",d0={name:"GeoJSON",id:"geojson",module:"geojson",version:B0,worker:!0,extensions:["geojson"],mimeTypes:["application/geo+json"],category:"geometry",text:!0,options:{geojson:{shape:"object-row-table"},json:{shape:"object-row-table",jsonpaths:["$","$.features"]},gis:{format:"geojson"}}},sr={...d0,parse:f0,parseTextSync:wc,parseInBatches:C0};async function f0(e,t){return wc(new TextDecoder().decode(e),t)}function wc(e,t){var r;t={...sr.options,...t},t.geojson={...sr.options.geojson,...t.geojson},t.gis=t.gis||{};let s;try{s=JSON.parse(e)}catch{s={}}const i={shape:"geojson-table",type:"FeatureCollection",features:((r=s)===null||r===void 0?void 0:r.features)||[]};switch(t.gis.format){case"binary":return Qc(i.features);default:return i}}function C0(e,t){t={...sr.options,...t},t.json={...sr.options.geojson,...t.geojson};const r=Nm(e,t);switch(t.gis.format){case"binary":return I0(r);default:return r}}async function*I0(e){for await(const t of e)t.data=Qc(t.data),yield t}function oe(e,t){if(!e)throw new Error(t||"loader assertion failed.")}const E0="Queued Requests",m0="Active Requests",p0="Cancelled Requests",y0="Queued Requests Ever",Q0="Active Requests Ever",w0={id:"request-scheduler",throttleRequests:!0,maxRequests:6,debounceTime:0};class b0{constructor(t={}){I(this,"props"),I(this,"stats"),I(this,"activeRequestCount",0),I(this,"requestQueue",[]),I(this,"requestMap",new Map),I(this,"updateTimer",null),this.props={...w0,...t},this.stats=new Vo({id:this.props.id}),this.stats.get(E0),this.stats.get(m0),this.stats.get(p0),this.stats.get(y0),this.stats.get(Q0)}scheduleRequest(t,r=()=>0){if(!this.props.throttleRequests)return Promise.resolve({done:()=>{}});if(this.requestMap.has(t))return this.requestMap.get(t);const s={handle:t,priority:0,getPriority:r},i=new Promise(n=>(s.resolve=n,s));return this.requestQueue.push(s),this.requestMap.set(t,i),this._issueNewRequests(),i}_issueRequest(t){const{handle:r,resolve:s}=t;let i=!1;const n=()=>{i||(i=!0,this.requestMap.delete(r),this.activeRequestCount--,this._issueNewRequests())};return this.activeRequestCount++,s?s({done:n}):Promise.resolve({done:n})}_issueNewRequests(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>this._issueNewRequestsAsync(),this.props.debounceTime)}_issueNewRequestsAsync(){this.updateTimer!==null&&clearTimeout(this.updateTimer),this.updateTimer=null;const t=Math.max(this.props.maxRequests-this.activeRequestCount,0);if(t!==0){this._updateAllRequests();for(let r=0;r<t;++r){const s=this.requestQueue.shift();s&&this._issueRequest(s)}}}_updateAllRequests(){const t=this.requestQueue;for(let r=0;r<t.length;++r){const s=t[r];this._updateRequest(s)||(t.splice(r,1),this.requestMap.delete(s.handle),r--)}t.sort((r,s)=>r.priority-s.priority)}_updateRequest(t){return t.priority=t.getPriority(t.handle),t.priority<0?(t.resolve(null),!1):!0}}function D0(e){const t=e?e.lastIndexOf("/"):-1;return t>=0?e.substr(0,t):""}class R0{constructor(t,r,s){I(this,"item"),I(this,"previous"),I(this,"next"),this.item=t,this.previous=r,this.next=s}}class S0{constructor(){I(this,"head",null),I(this,"tail",null),I(this,"_length",0)}get length(){return this._length}add(t){const r=new R0(t,this.tail,null);return this.tail?(this.tail.next=r,this.tail=r):(this.head=r,this.tail=r),++this._length,r}remove(t){t&&(t.previous&&t.next?(t.previous.next=t.next,t.next.previous=t.previous):t.previous?(t.previous.next=null,this.tail=t.previous):t.next?(t.next.previous=null,this.head=t.next):(this.head=null,this.tail=null),t.next=null,t.previous=null,--this._length)}splice(t,r){t!==r&&(this.remove(r),this._insert(t,r))}_insert(t,r){const s=t.next;t.next=r,this.tail===t?this.tail=r:s.previous=r,r.next=s,r.previous=t,++this._length}}class T0{constructor(){I(this,"_list"),I(this,"_sentinel"),I(this,"_trimTiles"),this._list=new S0,this._sentinel=this._list.add("sentinel"),this._trimTiles=!1}reset(){this._list.splice(this._list.tail,this._sentinel)}touch(t){const r=t._cacheNode;r&&this._list.splice(this._sentinel,r)}add(t,r,s){r._cacheNode||(r._cacheNode=this._list.add(r),s&&s(t,r))}unloadTile(t,r,s){const i=r._cacheNode;i&&(this._list.remove(i),r._cacheNode=null,s&&s(t,r))}unloadTiles(t,r){const s=this._trimTiles;this._trimTiles=!1;const i=this._list,n=t.maximumMemoryUsage*1024*1024,A=this._sentinel;let o=i.head;for(;o!==A&&(t.gpuMemoryUsageInBytes>n||s);){const a=o.item;o=o.next,this.unloadTile(t,a,r)}}trim(){this._trimTiles=!0}}function _0(e,t){oe(e),oe(t);const{rtcCenter:r,gltfUpAxis:s}=t,{computedTransform:i,boundingVolume:{center:n}}=e;let A=new k(i);switch(r&&A.translate(r),s){case"Z":break;case"Y":const h=new k().rotateX(Math.PI/2);A=A.multiplyRight(h);break;case"X":const u=new k().rotateY(-Math.PI/2);A=A.multiplyRight(u);break}t.isQuantized&&A.translate(t.quantizedVolumeOffset).scale(t.quantizedVolumeScale);const o=new f(n);t.cartesianModelMatrix=A,t.cartesianOrigin=o;const a=J.WGS84.cartesianToCartographic(o,new f),c=J.WGS84.eastNorthUpToFixedFrame(o).invert();t.cartographicModelMatrix=c.multiplyRight(A),t.cartographicOrigin=a,t.coordinateSystem||(t.modelMatrix=t.cartographicModelMatrix)}const XA=new f,Ys=new f,bi=new Et([new at,new at,new at,new at,new at,new at]);function M0(e,t){const{cameraDirection:r,cameraUp:s,height:i}=e,{metersPerUnit:n}=e.distanceScales,A=Lr(e,e.center),o=J.WGS84.eastNorthUpToFixedFrame(A),a=e.unprojectPosition(e.cameraPosition),c=J.WGS84.cartographicToCartesian(a,new f),h=new f(o.transformAsVector(new f(r).scale(n))).normalize(),u=new f(o.transformAsVector(new f(s).scale(n))).normalize();G0(e);const g=e.constructor,{longitude:l,latitude:B,width:d,bearing:C,zoom:m}=e,w=new g({longitude:l,latitude:B,height:i,width:d,bearing:C,zoom:m,pitch:0});return{camera:{position:c,direction:h,up:u},viewport:e,topDownViewport:w,height:i,cullingVolume:bi,frameNumber:t,sseDenominator:1.15}}function F0(e,t,r){if(r===0||e.length<=r)return[e,[]];const s=[],{longitude:i,latitude:n}=t.viewport;for(const[c,h]of e.entries()){const[u,g]=h.header.mbs,l=Math.abs(i-u),B=Math.abs(n-g),d=Math.sqrt(B*B+l*l);s.push([c,d])}const A=s.sort((c,h)=>c[1]-h[1]),o=[];for(let c=0;c<r;c++)o.push(e[A[c][0]]);const a=[];for(let c=r;c<A.length;c++)a.push(e[A[c][0]]);return[o,a]}function G0(e){const t=e.getFrustumPlanes(),r=zA(t.near,e.cameraPosition),s=Lr(e,r),i=Lr(e,e.cameraPosition,Ys);let n=0;bi.planes[n++].fromPointNormal(s,XA.copy(s).subtract(i));for(const A in t){if(A==="near")continue;const o=t[A],a=zA(o,r,Ys),c=Lr(e,a,Ys);bi.planes[n++].fromPointNormal(c,XA.copy(s).subtract(c))}}function zA(e,t,r=new f){const s=e.normal.dot(t);return r.copy(e.normal).scale(e.distance-s).add(t),r}function Lr(e,t,r=new f){const s=e.unprojectPosition(t);return J.WGS84.cartographicToCartesian(s,r)}const v0=6378137,L0=6378137,Di=6356752314245179e-9,be=new f;function x0(e,t){if(e instanceof ar){const{halfAxes:r}=e,s=O0(r);return Math.log2(Di/(s+t[2]))}else if(e instanceof or){const{radius:r}=e;return Math.log2(Di/(r+t[2]))}else if(e.width&&e.height){const{width:r,height:s}=e,i=Math.log2(v0/r),n=Math.log2(L0/s);return(i+n)/2}return 1}function bc(e,t,r){J.WGS84.cartographicToCartesian([e.xmax,e.ymax,e.zmax],be);const s=Math.sqrt(Math.pow(be[0]-r[0],2)+Math.pow(be[1]-r[1],2)+Math.pow(be[2]-r[2],2));return Math.log2(Di/(s+t[2]))}function U0(e,t,r){const[s,i,n,A]=e;return bc({xmin:s,xmax:n,ymin:i,ymax:A,zmin:0,zmax:0},t,r)}function O0(e){e.getColumn(0,be);const t=e.getColumn(1),r=e.getColumn(2);return be.add(t).add(r).len()}const ft={UNLOADED:0,LOADING:1,PROCESSING:2,READY:3,EXPIRED:4,FAILED:5};var Wt;(function(e){e[e.ADD=1]="ADD",e[e.REPLACE=2]="REPLACE"})(Wt||(Wt={}));var Ye;(function(e){e.EMPTY="empty",e.SCENEGRAPH="scenegraph",e.POINTCLOUD="pointcloud",e.MESH="mesh"})(Ye||(Ye={}));var yt;(function(e){e.I3S="I3S",e.TILES3D="TILES3D"})(yt||(yt={}));var ZA;(function(e){e.GEOMETRIC_ERROR="geometricError",e.MAX_SCREEN_THRESHOLD="maxScreenThreshold"})(ZA||(ZA={}));const N0={NOT_COMPUTED:-1,USE_OPTIMIZATION:1,SKIP_OPTIMIZATION:0};function Dc(e){return e!=null}const ht=new f,xr=new f,P0=new f,H0=new f,ie=new f,$A=new f,to=new f,eo=new f;function Ws(e,t,r){if(oe(e,"3D Tile: boundingVolume must be defined"),e.box)return Rc(e.box,t,r);if(e.region)return q0(e.region);if(e.sphere)return k0(e.sphere,t,r);throw new Error("3D Tile: boundingVolume must contain a sphere, region, or box")}function J0(e,t){if(e.box)return K0(t);if(e.region){const[r,s,i,n,A,o]=e.region;return[[Ft(r),Ft(s),A],[Ft(i),Ft(n),o]]}if(e.sphere)return j0(t);throw new Error("Unkown boundingVolume type")}function Rc(e,t,r){const s=new f(e[0],e[1],e[2]);t.transform(s,s);let i=[];if(e.length===10){const c=e.slice(3,6),h=new Hr;h.fromArray(e,6);const u=new f([1,0,0]),g=new f([0,1,0]),l=new f([0,0,1]);u.transformByQuaternion(h),u.scale(c[0]),g.transformByQuaternion(h),g.scale(c[1]),l.transformByQuaternion(h),l.scale(c[2]),i=[...u.toArray(),...g.toArray(),...l.toArray()]}else i=[...e.slice(3,6),...e.slice(6,9),...e.slice(9,12)];const n=t.transformAsVector(i.slice(0,3)),A=t.transformAsVector(i.slice(3,6)),o=t.transformAsVector(i.slice(6,9)),a=new Z([n[0],n[1],n[2],A[0],A[1],A[2],o[0],o[1],o[2]]);return Dc(r)?(r.center=s,r.halfAxes=a,r):new ar(s,a)}function k0(e,t,r){const s=new f(e[0],e[1],e[2]);t.transform(s,s);const i=t.getScale(xr),n=Math.max(Math.max(i[0],i[1]),i[2]),A=e[3]*n;return Dc(r)?(r.center=s,r.radius=A,r):new or(s,A)}function q0(e){const[t,r,s,i,n,A]=e,o=J.WGS84.cartographicToCartesian([Ft(t),Ft(i),n],P0),a=J.WGS84.cartographicToCartesian([Ft(s),Ft(r),A],H0),c=new f().addVectors(o,a).multiplyByScalar(.5);return J.WGS84.cartesianToCartographic(c,ie),J.WGS84.cartographicToCartesian([Ft(s),ie[1],ie[2]],$A),J.WGS84.cartographicToCartesian([ie[0],Ft(i),ie[2]],to),J.WGS84.cartographicToCartesian([ie[0],ie[1],A],eo),Rc([...c,...$A.subtract(c),...to.subtract(c),...eo.subtract(c)],new k)}function K0(e){const t=Sc(),{halfAxes:r}=e,s=new f(r.getColumn(0)),i=new f(r.getColumn(1)),n=new f(r.getColumn(2));for(let A=0;A<2;A++){for(let o=0;o<2;o++){for(let a=0;a<2;a++)ht.copy(e.center),ht.add(s),ht.add(i),ht.add(n),Tc(t,ht),n.negate();i.negate()}s.negate()}return t}function j0(e){const t=Sc(),{center:r,radius:s}=e,i=J.WGS84.scaleToGeodeticSurface(r,ht);let n;i?n=J.WGS84.geodeticSurfaceNormal(i):n=new f(0,0,1);let A=new f(n[2],-n[1],0);A.len()>0?A.normalize():A=new f(0,1,0);const o=A.clone().cross(n);for(const a of[A,o,n]){xr.copy(a).scale(s);for(let c=0;c<2;c++)ht.copy(r),ht.add(xr),Tc(t,ht),xr.negate()}return t}function Sc(){return[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]]}function Tc(e,t){J.WGS84.cartesianToCartographic(t,ht),e[0][0]=Math.min(e[0][0],ht[0]),e[0][1]=Math.min(e[0][1],ht[1]),e[0][2]=Math.min(e[0][2],ht[2]),e[1][0]=Math.max(e[1][0],ht[0]),e[1][1]=Math.max(e[1][1],ht[1]),e[1][2]=Math.max(e[1][2],ht[2])}new f;new f;new k;new f;new f;new f;function V0(e,t){const r=e*t;return 1-Math.exp(-(r*r))}function Y0(e,t){if(e.dynamicScreenSpaceError&&e.dynamicScreenSpaceErrorComputedDensity){const r=e.dynamicScreenSpaceErrorComputedDensity,s=e.dynamicScreenSpaceErrorFactor;return V0(t,r)*s}return 0}function W0(e,t,r){const s=e.tileset,i=e.parent&&e.parent.lodMetricValue||e.lodMetricValue,n=r?i:e.lodMetricValue;if(n===0)return 0;const A=Math.max(e._distanceToCamera,1e-7),{height:o,sseDenominator:a}=t,{viewDistanceScale:c}=s.options;let h=n*o*(c||1)/(A*a);return h-=Y0(s,A),h}const Xs=new f,ro=new f,$t=new f,so=new f,X0=new f,zs=new k,io=new k;function z0(e,t){if(e.lodMetricValue===0||isNaN(e.lodMetricValue))return"DIG";const r=2*_c(e,t);return r<2?"OUT":!e.header.children||r<=e.lodMetricValue?"DRAW":e.header.children?"DIG":"OUT"}function _c(e,t){const{topDownViewport:r}=t,s=e.header.mbs[1],i=e.header.mbs[0],n=e.header.mbs[2],A=e.header.mbs[3],o=[...e.boundingVolume.center],a=r.unprojectPosition(r.cameraPosition);J.WGS84.cartographicToCartesian(a,Xs),ro.copy(Xs).subtract(o).normalize(),J.WGS84.eastNorthUpToFixedFrame(o,zs),io.copy(zs).invert(),$t.copy(Xs).transform(io);const c=Math.sqrt($t[0]*$t[0]+$t[1]*$t[1]),h=c*c/$t[2];so.copy([$t[0],$t[1],h]);const u=so.transform(zs).subtract(o).normalize(),g=ro.cross(u).normalize().scale(A).add(o),l=J.WGS84.cartesianToCartographic(g),B=r.project([i,s,n]),d=r.project(l);return X0.copy(B).subtract(d).magnitude()}function Z0(e){return{assetGltfUpAxis:e.asset&&e.asset.gltfUpAxis||"Y"}}class no{constructor(t=0){I(this,"_map",new Map),I(this,"_array"),I(this,"_length"),this._array=new Array(t),this._length=t}get length(){return this._length}set length(t){this._length=t,t>this._array.length&&(this._array.length=t)}get values(){return this._array}get(t){return oe(t<this._array.length),this._array[t]}set(t,r){oe(t>=0),t>=this.length&&(this.length=t+1),this._map.has(this._array[t])&&this._map.delete(this._array[t]),this._array[t]=r,this._map.set(r,t)}delete(t){const r=this._map.get(t);r>=0&&(this._array.splice(r,1),this._map.delete(t),this.length--)}peek(){return this._array[this._length-1]}push(t){if(!this._map.has(t)){const r=this.length++;this._array[r]=t,this._map.set(t,r)}}pop(){const t=this._array[--this.length];return this._map.delete(t),t}reserve(t){oe(t>=0),t>this._array.length&&(this._array.length=t)}resize(t){oe(t>=0),this.length=t}trim(t){t==null&&(t=this.length),this._array.length=t}reset(){this._array=[],this._map=new Map,this._length=0}find(t){return this._map.has(t)}}const $0={loadSiblings:!1,skipLevelOfDetail:!1,updateTransforms:!0,onTraversalEnd:()=>{},viewportTraversersMap:{},basePath:""};class cs{constructor(t){I(this,"options"),I(this,"root",null),I(this,"selectedTiles",{}),I(this,"requestedTiles",{}),I(this,"emptyTiles",{}),I(this,"lastUpdate",new Date().getTime()),I(this,"updateDebounceTime",1e3),I(this,"_traversalStack",new no),I(this,"_emptyTraversalStack",new no),I(this,"_frameNumber",null),this.options={...$0,...t}}traversalFinished(t){return!0}traverse(t,r,s){this.root=t,this.options={...this.options,...s},this.reset(),this.updateTile(t,r),this._frameNumber=r.frameNumber,this.executeTraversal(t,r)}reset(){this.requestedTiles={},this.selectedTiles={},this.emptyTiles={},this._traversalStack.reset(),this._emptyTraversalStack.reset()}executeTraversal(t,r){const s=this._traversalStack;for(t._selectionDepth=1,s.push(t);s.length>0;){const n=s.pop();let A=!1;this.canTraverse(n,r)&&(this.updateChildTiles(n,r),A=this.updateAndPushChildren(n,r,s,n.hasRenderContent?n._selectionDepth+1:n._selectionDepth));const o=n.parent,a=!!(!o||o._shouldRefine),c=!A;n.hasRenderContent?n.refine===Wt.ADD?(this.loadTile(n,r),this.selectTile(n,r)):n.refine===Wt.REPLACE&&(this.loadTile(n,r),c&&this.selectTile(n,r)):(this.emptyTiles[n.id]=n,this.loadTile(n,r),c&&this.selectTile(n,r)),this.touchTile(n,r),n._shouldRefine=A&&a}const i=new Date().getTime();(this.traversalFinished(r)||i-this.lastUpdate>this.updateDebounceTime)&&(this.lastUpdate=i,this.options.onTraversalEnd(r))}updateChildTiles(t,r){const s=t.children;for(const i of s)this.updateTile(i,r)}updateAndPushChildren(t,r,s,i){const{loadSiblings:n,skipLevelOfDetail:A}=this.options,o=t.children;o.sort(this.compareDistanceToCamera.bind(this));const a=t.refine===Wt.REPLACE&&t.hasRenderContent&&!A;let c=!1,h=!0;for(const u of o)if(u._selectionDepth=i,u.isVisibleAndInRequestVolume?(s.find(u)&&s.delete(u),s.push(u),c=!0):(a||n)&&(this.loadTile(u,r),this.touchTile(u,r)),a){let g;if(u._inRequestVolume?u.hasRenderContent?g=u.contentAvailable:g=this.executeEmptyTraversal(u,r):g=!1,h=h&&g,!h)return!1}return c||(h=!1),h}updateTile(t,r){this.updateTileVisibility(t,r)}selectTile(t,r){this.shouldSelectTile(t)&&(t._selectedFrame=r.frameNumber,this.selectedTiles[t.id]=t)}loadTile(t,r){this.shouldLoadTile(t)&&(t._requestedFrame=r.frameNumber,t._priority=t._getPriority(),this.requestedTiles[t.id]=t)}touchTile(t,r){t.tileset._cache.touch(t),t._touchedFrame=r.frameNumber}canTraverse(t,r){return t.hasChildren?t.hasTilesetContent?!t.contentExpired:this.shouldRefine(t,r):!1}shouldLoadTile(t){return t.hasUnloadedContent||t.contentExpired}shouldSelectTile(t){return t.contentAvailable&&!this.options.skipLevelOfDetail}shouldRefine(t,r,s=!1){let i=t._screenSpaceError;return s&&(i=t.getScreenSpaceError(r,!0)),i>t.tileset.memoryAdjustedScreenSpaceError}updateTileVisibility(t,r){const s=[];if(this.options.viewportTraversersMap)for(const i in this.options.viewportTraversersMap)this.options.viewportTraversersMap[i]===r.viewport.id&&s.push(i);else s.push(r.viewport.id);t.updateVisibility(r,s)}compareDistanceToCamera(t,r){return t._distanceToCamera-r._distanceToCamera}anyChildrenVisible(t,r){let s=!1;for(const i of t.children)i.updateVisibility(r),s=s||i.isVisibleAndInRequestVolume;return s}executeEmptyTraversal(t,r){let s=!0;const i=this._emptyTraversalStack;for(i.push(t);i.length>0;){const n=i.pop(),A=!n.hasRenderContent&&this.canTraverse(n,r),o=!n.hasRenderContent&&n.children.length===0;if(!A&&!n.contentAvailable&&!o&&(s=!1),this.updateTile(n,r),n.isVisibleAndInRequestVolume||(this.loadTile(n,r),this.touchTile(n,r)),A){const a=n.children;for(const c of a)i.push(c)}}return s}}const Ao=new f;function tp(e){return e!=null}class Ri{constructor(t,r,s,i=""){I(this,"tileset"),I(this,"header"),I(this,"id"),I(this,"url"),I(this,"parent"),I(this,"refine"),I(this,"type"),I(this,"contentUrl"),I(this,"lodMetricType","geometricError"),I(this,"lodMetricValue",0),I(this,"boundingVolume",null),I(this,"content",null),I(this,"contentState",ft.UNLOADED),I(this,"gpuMemoryUsageInBytes",0),I(this,"children",[]),I(this,"depth",0),I(this,"viewportIds",[]),I(this,"transform",new k),I(this,"extensions",null),I(this,"implicitTiling",null),I(this,"userData",{}),I(this,"computedTransform"),I(this,"hasEmptyContent",!1),I(this,"hasTilesetContent",!1),I(this,"traverser",new cs({})),I(this,"_cacheNode",null),I(this,"_frameNumber",null),I(this,"_expireDate",null),I(this,"_expiredContent",null),I(this,"_boundingBox"),I(this,"_distanceToCamera",0),I(this,"_screenSpaceError",0),I(this,"_visibilityPlaneMask"),I(this,"_visible"),I(this,"_contentBoundingVolume"),I(this,"_viewerRequestVolume"),I(this,"_initialTransform",new k),I(this,"_priority",0),I(this,"_selectedFrame",0),I(this,"_requestedFrame",0),I(this,"_selectionDepth",0),I(this,"_touchedFrame",0),I(this,"_centerZDepth",0),I(this,"_shouldRefine",!1),I(this,"_stackLength",0),I(this,"_visitedFrame",0),I(this,"_inRequestVolume",!1),I(this,"_lodJudge",null),this.header=r,this.tileset=t,this.id=i||r.id,this.url=r.url,this.parent=s,this.refine=this._getRefine(r.refine),this.type=r.type,this.contentUrl=r.contentUrl,this._initializeLodMetric(r),this._initializeTransforms(r),this._initializeBoundingVolumes(r),this._initializeContent(r),this._initializeRenderingState(r),Object.seal(this)}destroy(){this.header=null}isDestroyed(){return this.header===null}get selected(){return this._selectedFrame===this.tileset._frameNumber}get isVisible(){return this._visible}get isVisibleAndInRequestVolume(){return this._visible&&this._inRequestVolume}get hasRenderContent(){return!this.hasEmptyContent&&!this.hasTilesetContent}get hasChildren(){return this.children.length>0||this.header.children&&this.header.children.length>0}get contentReady(){return this.contentState===ft.READY||this.hasEmptyContent}get contentAvailable(){return!!(this.contentReady&&this.hasRenderContent||this._expiredContent&&!this.contentFailed)}get hasUnloadedContent(){return this.hasRenderContent&&this.contentUnloaded}get contentUnloaded(){return this.contentState===ft.UNLOADED}get contentExpired(){return this.contentState===ft.EXPIRED}get contentFailed(){return this.contentState===ft.FAILED}get distanceToCamera(){return this._distanceToCamera}get screenSpaceError(){return this._screenSpaceError}get boundingBox(){return this._boundingBox||(this._boundingBox=J0(this.header.boundingVolume,this.boundingVolume)),this._boundingBox}getScreenSpaceError(t,r){switch(this.tileset.type){case yt.I3S:return _c(this,t);case yt.TILES3D:return W0(this,t,r);default:throw new Error("Unsupported tileset type")}}unselect(){this._selectedFrame=0}_getGpuMemoryUsageInBytes(){return this.content.gpuMemoryUsageInBytes||this.content.byteLength||0}_getPriority(){const t=this.tileset._traverser,{skipLevelOfDetail:r}=t.options,s=this.refine===Wt.ADD||r;if(s&&!this.isVisible&&this._visible!==void 0||this.tileset._frameNumber-this._touchedFrame>=1||this.contentState===ft.UNLOADED)return-1;const i=this.parent,n=i&&(!s||this._screenSpaceError===0||i.hasTilesetContent)?i._screenSpaceError:this._screenSpaceError,A=t.root?t.root._screenSpaceError:0;return Math.max(A-n,0)}async loadContent(){if(this.hasEmptyContent)return!1;if(this.content)return!0;this.contentExpired&&(this._expireDate=null),this.contentState=ft.LOADING;const t=await this.tileset._requestScheduler.scheduleRequest(this.id,this._getPriority.bind(this));if(!t)return this.contentState=ft.UNLOADED,!1;try{const r=this.tileset.getTileUrl(this.contentUrl),s=this.tileset.loader,i={...this.tileset.loadOptions,[s.id]:{...this.tileset.loadOptions[s.id],isTileset:this.type==="json",...this._getLoaderSpecificOptions(s.id)}};return this.content=await Re(r,s,i),this.tileset.options.contentLoader&&await this.tileset.options.contentLoader(this),this._isTileset()&&this.tileset._initializeTileHeaders(this.content,this),this.contentState=ft.READY,this._onContentLoaded(),!0}catch(r){throw this.contentState=ft.FAILED,r}finally{t.done()}}unloadContent(){return this.content&&this.content.destroy&&this.content.destroy(),this.content=null,this.header.content&&this.header.content.destroy&&this.header.content.destroy(),this.header.content=null,this.contentState=ft.UNLOADED,!0}updateVisibility(t,r){if(this._frameNumber===t.frameNumber)return;const s=this.parent,i=s?s._visibilityPlaneMask:Et.MASK_INDETERMINATE;if(this.tileset._traverser.options.updateTransforms){const n=s?s.computedTransform:this.tileset.modelMatrix;this._updateTransform(n)}this._distanceToCamera=this.distanceToTile(t),this._screenSpaceError=this.getScreenSpaceError(t,!1),this._visibilityPlaneMask=this.visibility(t,i),this._visible=this._visibilityPlaneMask!==Et.MASK_OUTSIDE,this._inRequestVolume=this.insideViewerRequestVolume(t),this._frameNumber=t.frameNumber,this.viewportIds=r}visibility(t,r){const{cullingVolume:s}=t,{boundingVolume:i}=this;return s.computeVisibilityWithPlaneMask(i,r)}contentVisibility(){return!0}distanceToTile(t){const r=this.boundingVolume;return Math.sqrt(Math.max(r.distanceSquaredTo(t.camera.position),0))}cameraSpaceZDepth({camera:t}){const r=this.boundingVolume;return Ao.subVectors(r.center,t.position),t.direction.dot(Ao)}insideViewerRequestVolume(t){const r=this._viewerRequestVolume;return!r||r.distanceSquaredTo(t.camera.position)<=0}updateExpiration(){if(tp(this._expireDate)&&this.contentReady&&!this.hasEmptyContent){const t=Date.now();Date.lessThan(this._expireDate,t)&&(this.contentState=ft.EXPIRED,this._expiredContent=this.content)}}get extras(){return this.header.extras}_initializeLodMetric(t){"lodMetricType"in t?this.lodMetricType=t.lodMetricType:(this.lodMetricType=this.parent&&this.parent.lodMetricType||this.tileset.lodMetricType,console.warn("3D Tile: Required prop lodMetricType is undefined. Using parent lodMetricType")),"lodMetricValue"in t?this.lodMetricValue=t.lodMetricValue:(this.lodMetricValue=this.parent&&this.parent.lodMetricValue||this.tileset.lodMetricValue,console.warn("3D Tile: Required prop lodMetricValue is undefined. Using parent lodMetricValue"))}_initializeTransforms(t){this.transform=t.transform?new k(t.transform):new k;const r=this.parent,s=this.tileset,i=r&&r.computedTransform?r.computedTransform.clone():s.modelMatrix.clone();this.computedTransform=new k(i).multiplyRight(this.transform);const n=r&&r._initialTransform?r._initialTransform.clone():new k;this._initialTransform=new k(n).multiplyRight(this.transform)}_initializeBoundingVolumes(t){this._contentBoundingVolume=null,this._viewerRequestVolume=null,this._updateBoundingVolume(t)}_initializeContent(t){this.content={_tileset:this.tileset,_tile:this},this.hasEmptyContent=!0,this.contentState=ft.UNLOADED,this.hasTilesetContent=!1,t.contentUrl&&(this.content=null,this.hasEmptyContent=!1)}_initializeRenderingState(t){this.depth=t.level||(this.parent?this.parent.depth+1:0),this._shouldRefine=!1,this._distanceToCamera=0,this._centerZDepth=0,this._screenSpaceError=0,this._visibilityPlaneMask=Et.MASK_INDETERMINATE,this._visible=void 0,this._inRequestVolume=!1,this._stackLength=0,this._selectionDepth=0,this._frameNumber=0,this._touchedFrame=0,this._visitedFrame=0,this._selectedFrame=0,this._requestedFrame=0,this._priority=0}_getRefine(t){return t||this.parent&&this.parent.refine||Wt.REPLACE}_isTileset(){return this.contentUrl.indexOf(".json")!==-1}_onContentLoaded(){switch(this.content&&this.content.type){case"vctr":case"geom":this.tileset._traverser.disableSkipLevelOfDetail=!0;break}this._isTileset()?this.hasTilesetContent=!0:this.gpuMemoryUsageInBytes=this._getGpuMemoryUsageInBytes()}_updateBoundingVolume(t){this.boundingVolume=Ws(t.boundingVolume,this.computedTransform,this.boundingVolume);const r=t.content;r&&(r.boundingVolume&&(this._contentBoundingVolume=Ws(r.boundingVolume,this.computedTransform,this._contentBoundingVolume)),t.viewerRequestVolume&&(this._viewerRequestVolume=Ws(t.viewerRequestVolume,this.computedTransform,this._viewerRequestVolume)))}_updateTransform(t=new k){const r=t.clone().multiplyRight(this.transform);r.equals(this.computedTransform)||(this.computedTransform=r,this._updateBoundingVolume(this.header))}_getLoaderSpecificOptions(t){switch(t){case"i3s":return{...this.tileset.options.i3s,_tileOptions:{attributeUrls:this.header.attributeUrls,textureUrl:this.header.textureUrl,textureFormat:this.header.textureFormat,textureLoaderOptions:this.header.textureLoaderOptions,materialDefinition:this.header.materialDefinition,isDracoGeometry:this.header.isDracoGeometry,mbs:this.header.mbs},_tilesetOptions:{store:this.tileset.tileset.store,attributeStorageInfo:this.tileset.tileset.attributeStorageInfo,fields:this.tileset.tileset.fields},isTileHeader:!1};case"3d-tiles":case"cesium-ion":default:return Z0(this.tileset.tileset)}}}class ep extends cs{compareDistanceToCamera(t,r){return r._distanceToCamera===0&&t._distanceToCamera===0?r._centerZDepth-t._centerZDepth:r._distanceToCamera-t._distanceToCamera}updateTileVisibility(t,r){if(super.updateTileVisibility(t,r),!t.isVisibleAndInRequestVolume)return;const s=t.children.length>0;if(t.hasTilesetContent&&s){const A=t.children[0];this.updateTileVisibility(A,r),t._visible=A._visible;return}if(this.meetsScreenSpaceErrorEarly(t,r)){t._visible=!1;return}const i=t.refine===Wt.REPLACE,n=t._optimChildrenWithinParent===N0.USE_OPTIMIZATION;if(i&&n&&s&&!this.anyChildrenVisible(t,r)){t._visible=!1;return}}meetsScreenSpaceErrorEarly(t,r){const{parent:s}=t;return!s||s.hasTilesetContent||s.refine!==Wt.ADD?!1:!this.shouldRefine(t,r,!0)}}class rp{constructor(){I(this,"frameNumberMap",new Map)}register(t,r){const s=this.frameNumberMap.get(t)||new Map,i=s.get(r)||0;s.set(r,i+1),this.frameNumberMap.set(t,s)}deregister(t,r){const s=this.frameNumberMap.get(t);if(!s)return;const i=s.get(r)||1;s.set(r,i-1)}isZero(t,r){var s;return(((s=this.frameNumberMap.get(t))==null?void 0:s.get(r))||0)===0}}const Zs={REQUESTED:"REQUESTED",COMPLETED:"COMPLETED",ERROR:"ERROR"};class sp{constructor(){I(this,"_statusMap"),I(this,"pendingTilesRegister",new rp),this._statusMap={}}add(t,r,s,i){if(!this._statusMap[r]){const{frameNumber:n,viewport:{id:A}}=i;this._statusMap[r]={request:t,callback:s,key:r,frameState:i,status:Zs.REQUESTED},this.pendingTilesRegister.register(A,n),t().then(o=>{this._statusMap[r].status=Zs.COMPLETED;const{frameNumber:a,viewport:{id:c}}=this._statusMap[r].frameState;this.pendingTilesRegister.deregister(c,a),this._statusMap[r].callback(o,i)}).catch(o=>{this._statusMap[r].status=Zs.ERROR;const{frameNumber:a,viewport:{id:c}}=this._statusMap[r].frameState;this.pendingTilesRegister.deregister(c,a),s(o)})}}update(t,r){if(this._statusMap[t]){const{frameNumber:s,viewport:{id:i}}=this._statusMap[t].frameState;this.pendingTilesRegister.deregister(i,s);const{frameNumber:n,viewport:{id:A}}=r;this.pendingTilesRegister.register(A,n),this._statusMap[t].frameState=r}}find(t){return this._statusMap[t]}hasPendingTiles(t,r){return!this.pendingTilesRegister.isZero(t,r)}}class ip extends cs{constructor(t){super(t),I(this,"_tileManager"),this._tileManager=new sp}traversalFinished(t){return!this._tileManager.hasPendingTiles(t.viewport.id,this._frameNumber||0)}shouldRefine(t,r){return t._lodJudge=z0(t,r),t._lodJudge==="DIG"}updateChildTiles(t,r){const s=t.header.children||[],i=t.children,n=t.tileset;for(const A of s){const o=`${A.id}-${r.viewport.id}`,a=i&&i.find(c=>c.id===o);if(a)a&&this.updateTile(a,r);else{let c=()=>this._loadTile(A.id,n);this._tileManager.find(o)?this._tileManager.update(o,r):(n.tileset.nodePages&&(c=()=>n.tileset.nodePagesTile.formTileFromNodePages(A.id)),this._tileManager.add(c,o,h=>this._onTileLoad(h,t,o),r))}}return!1}async _loadTile(t,r){const{loader:s}=r,i=r.getTileUrl(`${r.url}/nodes/${t}`),n={...r.loadOptions,i3s:{...r.loadOptions.i3s,isTileHeader:!0}};return await Re(i,s,n)}_onTileLoad(t,r,s){const i=new Ri(r.tileset,t,r,s);r.children.push(i);const n=this._tileManager.find(i.id).frameState;this.updateTile(i,n),this._frameNumber===n.frameNumber&&(this.traversalFinished(n)||new Date().getTime()-this.lastUpdate>this.updateDebounceTime)&&this.executeTraversal(i,n)}}const np={description:"",ellipsoid:J.WGS84,modelMatrix:new k,throttleRequests:!0,maxRequests:64,maximumMemoryUsage:32,memoryCacheOverflow:1,maximumTilesSelected:0,debounceTime:0,onTileLoad:()=>{},onTileUnload:()=>{},onTileError:()=>{},onTraversalComplete:e=>e,contentLoader:void 0,viewDistanceScale:1,maximumScreenSpaceError:8,memoryAdjustedScreenSpaceError:!1,loadTiles:!0,updateTransforms:!0,viewportTraversersMap:null,loadOptions:{fetch:{}},attributions:[],basePath:"",i3s:{}},_r="Tiles In Tileset(s)",$s="Tiles In Memory",oo="Tiles In View",ao="Tiles To Render",co="Tiles Loaded",ti="Tiles Loading",ho="Tiles Unloaded",uo="Failed Tile Loads",lo="Points/Vertices",ei="Tile Memory Use",go="Maximum Screen Space Error";class Ap{constructor(t,r){I(this,"options"),I(this,"loadOptions"),I(this,"type"),I(this,"tileset"),I(this,"loader"),I(this,"url"),I(this,"basePath"),I(this,"modelMatrix"),I(this,"ellipsoid"),I(this,"lodMetricType"),I(this,"lodMetricValue"),I(this,"refine"),I(this,"root",null),I(this,"roots",{}),I(this,"asset",{}),I(this,"description",""),I(this,"properties"),I(this,"extras",null),I(this,"attributions",{}),I(this,"credits",{}),I(this,"stats"),I(this,"contentFormats",{draco:!1,meshopt:!1,dds:!1,ktx2:!1}),I(this,"cartographicCenter",null),I(this,"cartesianCenter",null),I(this,"zoom",1),I(this,"boundingVolume",null),I(this,"dynamicScreenSpaceErrorComputedDensity",0),I(this,"maximumMemoryUsage",32),I(this,"gpuMemoryUsageInBytes",0),I(this,"memoryAdjustedScreenSpaceError",0),I(this,"_cacheBytes",0),I(this,"_cacheOverflowBytes",0),I(this,"_frameNumber",0),I(this,"_queryParams",{}),I(this,"_extensionsUsed",[]),I(this,"_tiles",{}),I(this,"_pendingCount",0),I(this,"selectedTiles",[]),I(this,"traverseCounter",0),I(this,"geometricError",0),I(this,"lastUpdatedVieports",null),I(this,"_requestedTiles",[]),I(this,"_emptyTiles",[]),I(this,"frameStateData",{}),I(this,"_traverser"),I(this,"_cache",new T0),I(this,"_requestScheduler"),I(this,"updatePromise",null),I(this,"tilesetInitializationPromise"),this.options={...np,...r},this.tileset=t,this.loader=t.loader,this.type=t.type,this.url=t.url,this.basePath=t.basePath||D0(this.url),this.modelMatrix=this.options.modelMatrix,this.ellipsoid=this.options.ellipsoid,this.lodMetricType=t.lodMetricType,this.lodMetricValue=t.lodMetricValue,this.refine=t.root.refine,this.loadOptions=this.options.loadOptions||{},this._traverser=this._initializeTraverser(),this._requestScheduler=new b0({throttleRequests:this.options.throttleRequests,maxRequests:this.options.maxRequests}),this.memoryAdjustedScreenSpaceError=this.options.maximumScreenSpaceError,this._cacheBytes=this.options.maximumMemoryUsage*1024*1024,this._cacheOverflowBytes=this.options.memoryCacheOverflow*1024*1024,this.stats=new Vo({id:this.url}),this._initializeStats(),this.tilesetInitializationPromise=this._initializeTileSet(t)}destroy(){this._destroy()}isLoaded(){return this._pendingCount===0&&this._frameNumber!==0&&this._requestedTiles.length===0}get tiles(){return Object.values(this._tiles)}get frameNumber(){return this._frameNumber}get queryParams(){return new URLSearchParams(this._queryParams).toString()}setProps(t){this.options={...this.options,...t}}getTileUrl(t){if(t.startsWith("data:"))return t;let r=t;return this.queryParams.length&&(r=`${t}${t.includes("?")?"&":"?"}${this.queryParams}`),r}hasExtension(t){return this._extensionsUsed.indexOf(t)>-1}update(t=null){this.tilesetInitializationPromise.then(()=>{!t&&this.lastUpdatedVieports?t=this.lastUpdatedVieports:this.lastUpdatedVieports=t,t&&this.doUpdate(t)})}async selectTiles(t=null){return await this.tilesetInitializationPromise,t&&(this.lastUpdatedVieports=t),this.updatePromise||(this.updatePromise=new Promise(r=>{setTimeout(()=>{this.lastUpdatedVieports&&this.doUpdate(this.lastUpdatedVieports),r(this._frameNumber),this.updatePromise=null},this.options.debounceTime)})),this.updatePromise}adjustScreenSpaceError(){this.gpuMemoryUsageInBytes<this._cacheBytes?this.memoryAdjustedScreenSpaceError=Math.max(this.memoryAdjustedScreenSpaceError/1.02,this.options.maximumScreenSpaceError):this.gpuMemoryUsageInBytes>this._cacheBytes+this._cacheOverflowBytes&&(this.memoryAdjustedScreenSpaceError*=1.02)}doUpdate(t){if("loadTiles"in this.options&&!this.options.loadTiles||this.traverseCounter>0)return;const r=t instanceof Array?t:[t];this._cache.reset(),this._frameNumber++,this.traverseCounter=r.length;const s=[];for(const i of r){const n=i.id;this._needTraverse(n)?s.push(n):this.traverseCounter--}for(const i of r){const n=i.id;if(this.roots[n]||(this.roots[n]=this._initializeTileHeaders(this.tileset,null)),!s.includes(n))continue;const A=M0(i,this._frameNumber);this._traverser.traverse(this.roots[n],A,this.options)}}_needTraverse(t){let r=t;return this.options.viewportTraversersMap&&(r=this.options.viewportTraversersMap[t]),r===t}_onTraversalEnd(t){const r=t.viewport.id;this.frameStateData[r]||(this.frameStateData[r]={selectedTiles:[],_requestedTiles:[],_emptyTiles:[]});const s=this.frameStateData[r],i=Object.values(this._traverser.selectedTiles),[n,A]=F0(i,t,this.options.maximumTilesSelected);s.selectedTiles=n;for(const o of A)o.unselect();s._requestedTiles=Object.values(this._traverser.requestedTiles),s._emptyTiles=Object.values(this._traverser.emptyTiles),this.traverseCounter--,!(this.traverseCounter>0)&&this._updateTiles()}_updateTiles(){this.selectedTiles=[],this._requestedTiles=[],this._emptyTiles=[];for(const t in this.frameStateData){const r=this.frameStateData[t];this.selectedTiles=this.selectedTiles.concat(r.selectedTiles),this._requestedTiles=this._requestedTiles.concat(r._requestedTiles),this._emptyTiles=this._emptyTiles.concat(r._emptyTiles)}this.selectedTiles=this.options.onTraversalComplete(this.selectedTiles);for(const t of this.selectedTiles)this._tiles[t.id]=t;this._loadTiles(),this._unloadTiles(),this._updateStats()}_tilesChanged(t,r){if(t.length!==r.length)return!0;const s=new Set(t.map(A=>A.id)),i=new Set(r.map(A=>A.id));let n=t.filter(A=>!i.has(A.id)).length>0;return n=n||r.filter(A=>!s.has(A.id)).length>0,n}_loadTiles(){for(const t of this._requestedTiles)t.contentUnloaded&&this._loadTile(t)}_unloadTiles(){this._cache.unloadTiles(this,(t,r)=>t._unloadTile(r))}_updateStats(){let t=0,r=0;for(const s of this.selectedTiles)s.contentAvailable&&s.content&&(t++,s.content.pointCount?r+=s.content.pointCount:r+=s.content.vertexCount);this.stats.get(oo).count=this.selectedTiles.length,this.stats.get(ao).count=t,this.stats.get(lo).count=r,this.stats.get(go).count=this.memoryAdjustedScreenSpaceError}async _initializeTileSet(t){this.type===yt.I3S&&(this.calculateViewPropsI3S(),t.root=await t.root),this.root=this._initializeTileHeaders(t,null),this.type===yt.TILES3D&&(this._initializeTiles3DTileset(t),this.calculateViewPropsTiles3D()),this.type===yt.I3S&&this._initializeI3STileset()}calculateViewPropsI3S(){var t;const r=this.tileset.fullExtent;if(r){const{xmin:i,xmax:n,ymin:A,ymax:o,zmin:a,zmax:c}=r;this.cartographicCenter=new f(i+(n-i)/2,A+(o-A)/2,a+(c-a)/2),this.cartesianCenter=new f,J.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=bc(r,this.cartographicCenter,this.cartesianCenter);return}const s=(t=this.tileset.store)==null?void 0:t.extent;if(s){const[i,n,A,o]=s;this.cartographicCenter=new f(i+(A-i)/2,n+(o-n)/2,0),this.cartesianCenter=new f,J.WGS84.cartographicToCartesian(this.cartographicCenter,this.cartesianCenter),this.zoom=U0(s,this.cartographicCenter,this.cartesianCenter);return}console.warn("Extent is not defined in the tileset header"),this.cartographicCenter=new f,this.zoom=1}calculateViewPropsTiles3D(){const t=this.root,{center:r}=t.boundingVolume;if(!r){console.warn("center was not pre-calculated for the root tile"),this.cartographicCenter=new f,this.zoom=1;return}r[0]!==0||r[1]!==0||r[2]!==0?(this.cartographicCenter=new f,J.WGS84.cartesianToCartographic(r,this.cartographicCenter)):this.cartographicCenter=new f(0,0,-J.WGS84.radii[0]),this.cartesianCenter=r,this.zoom=x0(t.boundingVolume,this.cartographicCenter)}_initializeStats(){this.stats.get(_r),this.stats.get(ti),this.stats.get($s),this.stats.get(oo),this.stats.get(ao),this.stats.get(co),this.stats.get(ho),this.stats.get(uo),this.stats.get(lo),this.stats.get(ei,"memory"),this.stats.get(go)}_initializeTileHeaders(t,r){var s;const i=new Ri(this,t.root,r);if(r&&(r.children.push(i),i.depth=r.depth+1),this.type===yt.TILES3D){const n=[];for(n.push(i);n.length>0;){const A=n.pop();this.stats.get(_r).incrementCount();const o=A.header.children||[];for(const a of o){const c=new Ri(this,a,A);if((s=c.contentUrl)!=null&&s.includes("?session=")){const h=new URL(c.contentUrl).searchParams.get("session");h&&(this._queryParams.session=h)}A.children.push(c),c.depth=A.depth+1,n.push(c)}}}return i}_initializeTraverser(){let t;switch(this.type){case yt.TILES3D:t=ep;break;case yt.I3S:t=ip;break;default:t=cs}return new t({basePath:this.basePath,onTraversalEnd:this._onTraversalEnd.bind(this)})}_destroyTileHeaders(t){this._destroySubtree(t)}async _loadTile(t){let r;try{this._onStartTileLoading(),r=await t.loadContent()}catch(s){this._onTileLoadError(t,s instanceof Error?s:new Error("load failed"))}finally{this._onEndTileLoading(),this._onTileLoad(t,r)}}_onTileLoadError(t,r){this.stats.get(uo).incrementCount();const s=r.message||r.toString(),i=t.url;console.error(`A 3D tile failed to load: ${t.url} ${s}`),this.options.onTileError(t,s,i)}_onTileLoad(t,r){var s,i;if(r){if(this.type===yt.I3S){const n=((i=(s=this.tileset)==null?void 0:s.nodePagesTile)==null?void 0:i.nodesInNodePages)||0;this.stats.get(_r).reset(),this.stats.get(_r).addCount(n)}t&&t.content&&_0(t,t.content),this.updateContentTypes(t),this._addTileToCache(t),this.options.onTileLoad(t)}}updateContentTypes(t){var r;if(this.type===yt.I3S)switch(t.header.isDracoGeometry&&(this.contentFormats.draco=!0),t.header.textureFormat){case"dds":this.contentFormats.dds=!0;break;case"ktx2":this.contentFormats.ktx2=!0;break}else if(this.type===yt.TILES3D){const{extensionsRemoved:s=[]}=((r=t.content)==null?void 0:r.gltf)||{};s.includes("KHR_draco_mesh_compression")&&(this.contentFormats.draco=!0),s.includes("EXT_meshopt_compression")&&(this.contentFormats.meshopt=!0),s.includes("KHR_texture_basisu")&&(this.contentFormats.ktx2=!0)}}_onStartTileLoading(){this._pendingCount++,this.stats.get(ti).incrementCount()}_onEndTileLoading(){this._pendingCount--,this.stats.get(ti).decrementCount()}_addTileToCache(t){this._cache.add(this,t,r=>r._updateCacheStats(t))}_updateCacheStats(t){this.stats.get(co).incrementCount(),this.stats.get($s).incrementCount(),this.gpuMemoryUsageInBytes+=t.gpuMemoryUsageInBytes||0,this.stats.get(ei).count=this.gpuMemoryUsageInBytes,this.options.memoryAdjustedScreenSpaceError&&this.adjustScreenSpaceError()}_unloadTile(t){this.gpuMemoryUsageInBytes-=t.gpuMemoryUsageInBytes||0,this.stats.get($s).decrementCount(),this.stats.get(ho).incrementCount(),this.stats.get(ei).count=this.gpuMemoryUsageInBytes,this.options.onTileUnload(t),t.unloadContent()}_destroy(){const t=[];for(this.root&&t.push(this.root);t.length>0;){const r=t.pop();for(const s of r.children)t.push(s);this._destroyTile(r)}this.root=null}_destroySubtree(t){const r=t,s=[];for(s.push(r);s.length>0;){t=s.pop();for(const i of t.children)s.push(i);t!==r&&this._destroyTile(t)}r.children=[]}_destroyTile(t){this._cache.unloadTile(this,t),this._unloadTile(t),t.destroy()}_initializeTiles3DTileset(t){if(t.queryString){const r=new URLSearchParams(t.queryString),s=Object.fromEntries(r.entries());this._queryParams={...this._queryParams,...s}}if(this.asset=t.asset,!this.asset)throw new Error("Tileset must have an asset property.");if(this.asset.version!=="0.0"&&this.asset.version!=="1.0"&&this.asset.version!=="1.1")throw new Error("The tileset must be 3D Tiles version either 0.0 or 1.0 or 1.1.");"tilesetVersion"in this.asset&&(this._queryParams.v=this.asset.tilesetVersion),this.credits={attributions:this.options.attributions||[]},this.description=this.options.description||"",this.properties=t.properties,this.geometricError=t.geometricError,this._extensionsUsed=t.extensionsUsed||[],this.extras=t.extras}_initializeI3STileset(){this.loadOptions.i3s&&"token"in this.loadOptions.i3s&&(this._queryParams.token=this.loadOptions.i3s.token)}}function op(e){let t=0;for(const s in e.attributes){const i=e.getAttribute(s);t+=i.count*i.itemSize*i.array.BYTES_PER_ELEMENT}const r=e.getIndex();return t+=r?r.count*r.itemSize*r.array.BYTES_PER_ELEMENT:0,t}function Mc(e){const t=document.createElement("canvas");t.width=64,t.height=64;const r=t.getContext("2d");r.rect(0,0,64,64);const s=r.createLinearGradient(0,0,64,64);for(let n=0;n<e.length;n++){const A=e[n];s.addColorStop(A[0],"#"+A[1].getHexString())}r.fillStyle=s,r.fill();const i=new Ah(t);return i.needsUpdate=!0,i.minFilter=We,i.wrapS=fn,i.wrapT=fn,i.repeat.set(2,2),i}function Bo(e){e.updateMatrix(),e.updateMatrixWorld(),e.matrixWorldInverse.copy(e.matrixWorld).invert();const t=new oh;return t.setFromProjectionMatrix(new it().multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse)),t}function ap(e){const t=new Mr,r=new ah(10,5),s=new W(...e.projectPointOntoPlane([0,0,0])),i=new W(e.normal.x,e.normal.y,e.normal.z),n=new W().copy(s).add(i);r.lookAt(n),r.translate(s.x,s.y,s.z);const A=new si({color:65535,side:wo}),o=new ii(r,A),a=new ch(i,s,5,16776960);return t.add(a),t.add(o),t}function fo(e){const{boundingVolume:t}=e;let r=0;e.content&&(r=Math.min(e.content.byteLength/5e5,1));const s=new D(r,1,0),i=new hh(1,1,1),n=new it;t.halfAxes?n.copy(Fc(t.halfAxes)):t.radius&&i.scale(t.radius*2,t.radius*2,t.radius*2),i.applyMatrix4(n);const A=new uh(i),o=new lh(A,new gh({color:s}));return o.position.copy(new W(...t.center)),o}function Fc(e){const t=e;return new it().fromArray([t[0]*2,t[1]*2,t[2]*2,0,t[3]*2,t[4]*2,t[5]*2,0,t[6]*2,t[7]*2,t[8]*2,0,0,0,0,1])}function cp(e,t){const r=2*Math.PI*6378137/2,s=t*r/180;let i=Math.log(Math.tan((90+e)*Math.PI/360))/(Math.PI/180);return i=i*r/180,new bo(s,i)}function hp(e){let t=0;if((e==null?void 0:e.userData.mimeType)=="image/ktx2"&&e.mipmaps){for(let r=0;r<e.mipmaps.length;r++)t+=e.mipmaps[r].data.byteLength;return t}else if(e.image){const{image:r}=e,s=4;let i=[r.width,r.height];for(;i[0]>1||i[1]>1;)t+=i[0]*i[1]*s,i[0]=Math.max(Math.floor(i[0]/2),1),i[1]=Math.max(Math.floor(i[1]/2),1);return t+=1*1*s,t}else return}function Gc(e){return op(e)}let Ct=null,Gt=null,Xr=null,Ur=null;const Co={minHeight:0,maxHeight:300,samples:4,sampleStep:4,opacity:.5,blendingType:_i};function up(e,t,r,s=Co){Ct&&Ct.dispose(),Gt||(Gt=r);const i={...Co,...s};Ct=new Bh(e.width*e.devicePixelRatio,e.height*e.devicePixelRatio),Ct.texture.minFilter=Cn,Ct.texture.magFilter=Cn,Ct.stencilBuffer=!1,Ct.texture.format=ne,Ct.texture.type=De,Gt.setPixelRatio(devicePixelRatio),Gt.setSize(e.width,e.height),Gt.setRenderTarget(Ct),Xr=new Eo,Xr.overrideMaterial=Bp,Ur=t,te.uniforms.tPosition.value=Ct.texture,te.uniforms.minHeight.value=i.minHeight,te.uniforms.maxHeight.value=i.maxHeight,te.uniforms.samples.value=i.samples,te.uniforms.sampleStep.value=i.sampleStep,te.uniforms.opacity.value=i.opacity,te.blending=i.blendingType}function lp(e){Ct.setSize(e.width*e.devicePixelRatio,e.height*e.devicePixelRatio),Gt.setPixelRatio(devicePixelRatio),Gt.setSize(e.width,e.height)}function gp(e){if(Gt){const t=Ur.parent;Xr.add(Ur),Gt.setRenderTarget(Ct),Gt.render(Xr,e),t&&t.add(Ur),Gt.setRenderTarget(null)}}const zr=e=>e.toString(),Bp=new Ti({vertexShader:zr`
        varying vec3 vPosition;
        void main() {
            vPosition =  (modelMatrix * vec4(position, 1.0)).xyz;
            gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);
        }
    `,fragmentShader:zr`
        varying vec3 vPosition;
        void main() {
            gl_FragColor = vec4(vPosition, 1.0);
        }
    `,side:wo}),dp=zr`
    #include <packing>

    varying vec2 vUv;
    varying vec3 vColor;
    uniform sampler2D tPosition;
    uniform float minHeight;
    uniform float maxHeight;
    uniform int samples;
    uniform float sampleStep;

    mat4 MVP;

    // Convert to normalized screen coordinates
    vec4 toNSC(const in vec4 v) {
        return vec4(0.5 * (v.xyz / v.w) + 0.5, v.w);
    }
    vec4 vertexDraping(
        const in sampler2D positionTex, // Position G-Buffer
        const in vec4 Vin // Vertex to drape
    ) {
        float texSize = float(textureSize(positionTex, 0).x);
        float pixelSize = 1.0 / texSize;
        vec2 stepSize = vec2(sampleStep/texSize);
        vec4 VinWorld = modelMatrix * Vin;

        vec4 lineStart = projectionMatrix * viewMatrix * vec4(VinWorld.x, minHeight, VinWorld.z, 1.0);
        vec4 lineEnd = projectionMatrix * viewMatrix * vec4(VinWorld.x, maxHeight, VinWorld.z, 1.0);

        vec4 Vout = VinWorld;

        // Binary search for line-terrain intersection
        float first = 0.0, last = 1.0;
        while(first <= last) {
            // Compute mid-point
            float mid = first + (last-first) / 2.0;
            // Compute texture coordinates along line
            vec4 texCoords = toNSC(mix(lineStart, lineEnd, mid));
            vec4 texSample = vec4(0.0); // Sample terrain
            for(int s = -samples; s < samples; s++) {
                for(int t = -samples; t < samples; t++) {
                    texSample += texture(positionTex,
                    texCoords.st + vec2(s,t) * stepSize);
                }
            }
            // Smooth samples obtain from G-Buffer
            texSample = texSample / (float(samples) * float(samples) * 4.0);
            float terrainHeight = texSample.y;
            Vout.y = terrainHeight;
           
            if((last-first) < pixelSize) { // Termination criteria
                return Vout;
            }
            // Perform intersection test
            float depthScene = toNSC(projectionMatrix * viewMatrix * Vout).y;
            if(depthScene >= texCoords.y) {
                first = mid;
            }
            else
                last = mid;
        }
        return Vout;
    }

    void main() {
        vColor = color;
        vUv = uv;
        MVP = projectionMatrix * modelViewMatrix;
        vec4 inputVertex = vec4(position, 1.0);
        vec4 outputVertex = vertexDraping(tPosition, inputVertex);
        vec4 finalPosition = projectionMatrix * viewMatrix * outputVertex;
        gl_Position = finalPosition;
    }
`,fp=zr`
    varying vec3 vColor;
    uniform float opacity;

    void main() {
        gl_FragColor = vec4(vColor, opacity);
    }
`,te=new Ti({vertexShader:dp,fragmentShader:fp,uniforms:{tPosition:{value:null},minHeight:{value:0},maxHeight:{value:300},opacity:{value:.5},samples:{value:4},sampleStep:{value:4}},vertexColors:!0,transparent:!0,depthTest:!1,blending:_i}),vc={SPECTRAL:[[0,new D(.3686,.3098,.6353)],[.1,new D(.1961,.5333,.7412)],[.2,new D(.4,.7608,.6471)],[.3,new D(.6706,.8667,.6431)],[.4,new D(.902,.9608,.5961)],[.5,new D(1,1,.749)],[.6,new D(.9961,.8784,.5451)],[.7,new D(.9922,.6824,.3804)],[.8,new D(.9569,.4275,.2627)],[.9,new D(.8353,.2431,.3098)],[1,new D(.6196,.0039,.2588)]],PLASMA:[[0,new D(.241,.015,.61)],[.1,new D(.387,.001,.654)],[.2,new D(.524,.025,.653)],[.3,new D(.651,.125,.596)],[.4,new D(.752,.227,.513)],[.5,new D(.837,.329,.431)],[.6,new D(.907,.435,.353)],[.7,new D(.963,.554,.272)],[.8,new D(.992,.681,.195)],[.9,new D(.987,.822,.144)],[1,new D(.94,.975,.131)]],YELLOW_GREEN:[[0,new D(.1647,.2824,.3451)],[.1,new D(.1338,.3555,.4227)],[.2,new D(.061,.4319,.4864)],[.3,new D(0,.5099,.5319)],[.4,new D(0,.5881,.5569)],[.5,new D(.137,.665,.5614)],[.6,new D(.2906,.7395,.5477)],[.7,new D(.4453,.8099,.5201)],[.8,new D(.6102,.8748,.485)],[.9,new D(.7883,.9323,.4514)],[1,new D(.9804,.9804,.4314)]],VIRIDIS:[[0,new D(.267,.005,.329)],[.1,new D(.283,.141,.458)],[.2,new D(.254,.265,.53)],[.3,new D(.207,.372,.553)],[.4,new D(.164,.471,.558)],[.5,new D(.128,.567,.551)],[.6,new D(.135,.659,.518)],[.7,new D(.267,.749,.441)],[.8,new D(.478,.821,.318)],[.9,new D(.741,.873,.15)],[1,new D(.993,.906,.144)]],INFERNO:[[0,new D(.077,.042,.206)],[.1,new D(.225,.036,.388)],[.2,new D(.373,.074,.432)],[.3,new D(.522,.128,.42)],[.4,new D(.665,.182,.37)],[.5,new D(.797,.255,.287)],[.6,new D(.902,.364,.184)],[.7,new D(.969,.516,.063)],[.8,new D(.988,.683,.072)],[.9,new D(.961,.859,.298)],[1,new D(.988,.998,.645)]],GRAYSCALE:[[0,new D(0,0,0)],[1,new D(1,1,1)]],TURBO:[[0,new D(.18995,.07176,.23217)],[.07,new D(.25107,.25237,.63374)],[.13,new D(.27628,.42118,.89123)],[.2,new D(.25862,.57958,.99876)],[.27,new D(.15844,.73551,.92305)],[.33,new D(.09267,.86554,.7623)],[.4,new D(.19659,.94901,.59466)],[.47,new D(.42778,.99419,.38575)],[.53,new D(.64362,.98999,.23356)],[.6,new D(.80473,.92452,.20459)],[.67,new D(.93301,.81236,.22667)],[.73,new D(.99314,.67408,.20348)],[.8,new D(.9836,.49291,.12849)],[.87,new D(.92105,.31489,.05475)],[.93,new D(.81608,.18462,.01809)],[1,new D(.66449,.08436,.00424)]],RAINBOW:[[0,new D(.278,0,.714)],[1/6,new D(0,0,1)],[2/6,new D(0,1,1)],[3/6,new D(0,1,0)],[4/6,new D(1,1,0)],[5/6,new D(1,.64,0)],[1,new D(1,0,0)]],CONTOUR:[[0,new D(0,0,0)],[.03,new D(0,0,0)],[.04,new D(1,1,1)],[1,new D(1,1,1)]]},Cp=`
  varying vec3 vColor;
  uniform float alpha;

  void main() {
    if (vColor == vec3(0.0, 0.0, 0.0)) {
      discard;
    } else {
      gl_FragColor = vec4( vColor, alpha);
    }
  }
`,Ip=`
  varying vec3 vColor;
  uniform sampler2D gradient;
  uniform sampler2D grayscale;
  attribute float intensity;
  attribute float classification;
  uniform vec3 rootCenter;
  uniform vec3 rootNormal;
  uniform vec2 elevationRange;
  uniform int coloring;
  uniform bool hideGround;
  uniform float maxIntensity;
  uniform float intensityContrast;
  uniform float pointSize;

  #ifdef USE_COLOR
  vec3 getRGB() {
      vec3 rgb = color;
      return rgb;
  }
  #endif

  vec3 getElevation(){
    vec4 world = modelMatrix * vec4( position, 1.0 );
    float diff = abs(dot(rootNormal, (vec3(world) - rootCenter)));
    float w = max(diff - elevationRange.x,0.0) / max(elevationRange.y - elevationRange.x,1.0);
    vec3 cElevation = texture2D(gradient, vec2(w,1.0-w)).rgb;

    return cElevation;
  }

  vec3 getIntensity(){
    // TODO: real contrast enhancement. Check https://github.com/yuki-koyama/enhancer/blob/master/shaders/enhancer.fs
    float intmod = pow(intensity, intensityContrast);
    vec3 cIntensity = texture2D(grayscale, vec2(intmod / maxIntensity ,1.0-(intmod / maxIntensity))).rgb;
    return cIntensity;
  }

  vec3 getClassification(){
    float classNormalized = classification / 255.0;
    vec3 cClassification = texture2D(gradient, vec2(classNormalized * 5.0,1.0-classNormalized * 5.0)).rgb;
    return cClassification;
  }

  vec3 getColor(){
      vec3 color;
      if (hideGround && classification == 2.0) {
         return vec3(0.0, 0.0, 0.0);               
      }

      if (coloring == 1) {
        color = getIntensity();
      }
      else if (coloring == 2) {
        color = getClassification();
      } else if (coloring == 3) {
        color = getElevation();
      } 
      #ifdef USE_COLOR
      else if (coloring == 4) {
        color = getRGB();
      }
      #endif
      else {
        color = vec3(1.0, 1.0, 1.0);
      }
      return color;
  }

  void main() {
      vColor = getColor();

      gl_PointSize = pointSize;
      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
  }
`;var hn=(e=>(e[e.Intensity=1]="Intensity",e[e.Classification=2]="Classification",e[e.Elevation=3]="Elevation",e[e.RGB=4]="RGB",e[e.White=5]="White",e))(hn||{}),Zr=(e=>(e[e.FlatTexture=1]="FlatTexture",e[e.ShadedTexture=2]="ShadedTexture",e[e.ShadedNoTexture=3]="ShadedNoTexture",e))(Zr||{});const Ep=vc.RAINBOW,mp=typeof document<"u"?Mc(Ep):null,pp=vc.GRAYSCALE,yp=typeof document<"u"?Mc(pp):null,Qp={throttleRequests:!0,maxRequests:64,updateInterval:.1,maxConcurrency:1,maximumScreenSpaceError:16,memoryAdjustedScreenSpaceError:!0,maximumMemoryUsage:400,memoryCacheOverflow:128,viewDistanceScale:1,skipLevelOfDetail:!1,resetTransform:!1,updateTransforms:!0,shading:Zr.FlatTexture,transparent:!1,pointCloudColoring:hn.White,pointSize:1,worker:!0,wireframe:!1,debug:!1,gltfLoader:null,basisTranscoderPath:null,dracoDecoderPath:null,material:null,contentPostProcess:void 0,preloadTilesCount:null,collectAttributions:!1};class wp{static async load(t){const r={...Qp,...t.options},{url:s}=t;let{viewport:i,renderer:n}=t;const A=r.updateInterval,o=5,a={};if(r.cesiumIONToken){a["cesium-ion"]={accessToken:r.cesiumIONToken};const Q=await Ic.preload(s,a);a.fetch={headers:Q.headers}}r.googleApiKey&&(a.fetch={headers:{"X-GOOG-API-KEY":r.googleApiKey}},t.options.hasOwnProperty("collectAttributions")||(r.collectAttributions=!0)),t.loadingManager&&t.loadingManager.itemStart(s);const c=await Re(s,Ve,{...a}),h={},u={},g=[],l=new Mr,B=new Mr;r.debug||(B.visible=!1);const d={pointSize:{type:"f",value:r.pointSize},gradient:{type:"t",value:mp},grayscale:{type:"t",value:yp},rootCenter:{type:"vec3",value:new W},rootNormal:{type:"vec3",value:new W},coloring:{type:"i",value:r.pointCloudColoring},hideGround:{type:"b",value:!0},elevationRange:{type:"vec2",value:new bo(0,400)},maxIntensity:{type:"f",value:1},intensityContrast:{type:"f",value:1},alpha:{type:"f",value:1}},C=new Ti({uniforms:d,vertexShader:Ip,fragmentShader:Cp,transparent:r.transparent,vertexColors:!0});let m,w,E;r.gltfLoader?m=r.gltfLoader:(m=new Rh,r.basisTranscoderPath&&(w=new Rt,w.detectSupport(n??new mo),w.setTranscoderPath(r.basisTranscoderPath+"/"),w.setWorkerLimit(1),m.setKTX2Loader(w)),r.dracoDecoderPath&&(E=new Sh,E.setDecoderPath(r.dracoDecoderPath+"/"),E.setWorkerLimit(r.maxConcurrency),m.setDRACOLoader(E)));const p=new si({transparent:r.transparent}),R={maximumMemoryUsage:r.maximumMemoryUsage,maximumScreenSpaceError:r.maximumScreenSpaceError,memoryAdjustedScreenSpaceError:r.memoryAdjustedScreenSpaceError,memoryCacheOverflow:r.memoryCacheOverflow,viewDistanceScale:r.viewDistanceScale,skipLevelOfDetail:r.skipLevelOfDetail,updateTransforms:r.updateTransforms,throttleRequests:r.throttleRequests,maxRequests:r.maxRequests,contentLoader:async Q=>{let x=null;switch(Q.type){case Ye.POINTCLOUD:{x=Dp(Q,C,r,Bt);break}case Ye.SCENEGRAPH:case Ye.MESH:{x=await bp(m,Q,p,r,Bt);break}}if(x&&(x.visible=!1,h[Q.id]=x,l.add(h[Q.id]),r.debug)){const ot=fo(Q);B.add(ot),u[Q.id]=ot}},onTileLoad:async Q=>{y&&(r.resetTransform&&!v&&(Q==null?void 0:Q.depth)<=o&&_t(Q),ct=!0)},onTileUnload:Q=>{g.push(Q)},onTileError:(Q,x)=>{console.warn("Tile error",Q.id,x)},onTraversalComplete(Q){return r.collectAttributions&&(N=Sp(Q)),Q}},y=new Ap(c,{...R,loadOptions:{...a,maxConcurrency:r.maxConcurrency,worker:r.worker,gltf:{loadImages:!1},"3d-tiles":{loadGLTF:!1}}}),T=new it,G=new it,_=new W;let v=!1,N="";if(y.root.boundingVolume?(y.root.header.boundingVolume.region&&console.warn("Cannot apply a model matrix to bounding volumes of type region. Tileset stays in original geo-coordinates."),G.setPosition(y.root.boundingVolume.center[0],y.root.boundingVolume.center[1],y.root.boundingVolume.center[2])):console.warn("Bounding volume not found, no transformations applied"),r.debug){const Q=fo(y.root);B.add(Q),u[y.root.id]=Q}let q=!1,K=!1;d.rootCenter.value.copy(_),d.rootNormal.value.copy(new W(0,0,1).normalize()),y.stats.get("Loader concurrency").count=r.maxConcurrency,y.stats.get("Maximum mem usage").count=r.maximumMemoryUsage;let L=0,$=null,ct=!0,j=null;const V=new W(1/0,1/0,1/0);let At=null;l.updateMatrixWorld(!0);const tt=new it().copy(l.matrixWorld),Bt=new it().copy(tt).invert();r.resetTransform&&_t(y.root),r.debug&&(u[y.root.id].applyMatrix4(T),B.matrixWorld.copy(l.matrixWorld));function _t(Q){if(!Q.boundingVolume.halfAxes)return;const x=Q.boundingVolume.halfAxes,ot=new it().extractRotation(Fc(x)).premultiply(new it().extractRotation(Bt));if(!new Bs().setFromRotationMatrix(ot).equals(new Bs)){v=!0;const et=new W(G.elements[12],G.elements[13],G.elements[14]);G.extractRotation(ot),G.setPosition(et)}Ut()}function Ut(){T.copy(tt),r.resetTransform&&T.multiply(new it().copy(G).invert()),y.modelMatrix=new k(T.toArray())}function _e(Q,x,ot,et){if(q||!et)return;At||(At=new kr({fov:et.fov/180*Math.PI,aspectRatio:et.aspect,near:et.near,far:et.far}).sseDenominator,r.debug&&console.log("Updated sse denonimator:",At));const hs=Bo(et).planes.map(st=>new at(st.normal.toArray(),st.constant)),us=new Et(hs),un={camera:{position:V.toArray()},height:ot.height*ot.devicePixelRatio,frameNumber:Q._frameNumber,sseDenominator:At,cullingVolume:us,viewport:{id:0}};Q._cache.reset(),Q._traverser.traverse(Q.root,un,Q.options);for(const st of Q.tiles)st.selected?x[st.id]?x[st.id].visible=!0:console.error("TILE SELECTED BUT NOT LOADED!!",st.id):x[st.id]&&(x[st.id].visible=!1);for(;g.length>0;){const st=g.pop();x[st.id]&&st.contentState==ft.UNLOADED&&(l.remove(x[st.id]),ri(x[st.id]),delete x[st.id]),u[st.id]&&(ri(u[st.id]),B.remove(u[st.id]),delete u[st.id])}const ls=Q.stats.get("Tiles Loaded").count,ln=Q.stats.get("Tiles Loading").count;return t.onProgress&&t.onProgress(ls,ls+ln),t.loadingManager&&!K&&ln==0&&(r.preloadTilesCount==null||ls>=r.preloadTilesCount)&&(K=!0,t.loadingManager.itemEnd(t.url)),un}function Lc(Q){const x=new W,ot=new fh,et=new W;Q.decompose(x,ot,et),l.position.copy(x),l.quaternion.copy(ot),l.scale.copy(et),l.updateMatrix(),l.updateMatrixWorld(!0),tt.copy(l.matrixWorld),Bt.copy(tt).invert(),Ut()}return{model:l,runtime:{getTileset:()=>y,getStats:()=>y.stats,getDataAttributions:()=>N,showTiles:Q=>{B.visible=Q},setWireframe:Q=>{r.wireframe=Q,l.traverse(x=>{x instanceof ii&&(x.material.wireframe=Q)})},setDebug:Q=>{r.debug=Q,B.visible=Q},setShading:Q=>{r.shading=Q},getTileBoxes:()=>B,setViewDistanceScale:Q=>{y.options.viewDistanceScale=Q,y._frameNumber++,_e(y,h,i,j)},setMaximumScreenSpaceError:Q=>{y.options.maximumScreenSpaceError=Q,y._frameNumber++,_e(y,h,i,j)},setHideGround:Q=>{d.hideGround.value=Q},setPointCloudColoring:Q=>{d.coloring.value=Q},setElevationRange:Q=>{d.elevationRange.value.set(Q[0],Q[1])},setMaxIntensity:Q=>{d.maxIntensity.value=Q},setIntensityContrast:Q=>{d.intensityContrast.value=Q},setPointAlpha:Q=>{d.alpha.value=Q},getLatLongHeightFromPosition:Q=>{const x=y.ellipsoid.cartesianToCartographic(new W().copy(Q).applyMatrix4(new it().copy(T).invert()).toArray());return{lat:x[1],long:x[0],height:x[2]}},getPositionFromLatLongHeight:Q=>{const x=y.ellipsoid.cartographicToCartesian([Q.long,Q.lat,Q.height]);return new W(...x).applyMatrix4(T)},orientToGeocoord:Q=>{const x=[Q.long,Q.lat,Q.height],ot=y.ellipsoid.cartographicToCartesian(x),et=new it().fromArray(y.ellipsoid.eastNorthUpToFixedFrame(ot)),hs=new it().makeRotationFromEuler(new Bs(Math.PI/2,Math.PI/2,0)),us=new it().copy(et).multiply(hs).invert();Lc(us)},getWebMercatorCoord:Q=>cp(Q.lat,Q.long),getCameraFrustum:Q=>{const x=Bo(Q).planes.map(et=>new at(et.normal.toArray(),et.constant)).map(et=>ap(et)),ot=new Mr;for(const et of x)ot.add(et);return ot},overlayGeoJSON:(Q,x)=>{if(Q.applyMatrix4(T),Q.updateMatrixWorld(),!n)throw new Error("GeoJSON draping requires a renderer reference via LoaderProps");return up(i,l,n,x),Q.material.dispose(),Q.material=te,Q},setViewport:Q=>{i=Q,At=null,ct=!0,Ct&&lp(i)},setRenderer:Q=>{n=Q},update:function(Q,x){if(j=x,L+=Q,Ct&&gp(x),y&&L>=A){if(!tt.equals(l.matrixWorld)){L=0,tt.copy(l.matrixWorld),r.updateTransforms&&Ut();const ot=new W().setFromMatrixPosition(tt);d.rootCenter.value.copy(ot),d.rootNormal.value.copy(new W(0,0,1).applyMatrix4(tt).normalize()),Bt.copy(tt).invert(),r.debug&&(u[y.root.id].matrixWorld.copy(T),u[y.root.id].applyMatrix4(tt))}$==null?$=new it().copy(x.matrixWorld):(ct||Rp(x,$))&&(L=0,ct=!1,y._frameNumber++,x.getWorldPosition(V),$.copy(x.matrixWorld),_e(y,h,i,x))}},dispose:function(){for(q=!0,y._destroy();l.children.length>0;){const Q=l.children[0];ri(Q),l.remove(Q)}for(;B.children.length>0;){const Q=B.children[0];B.remove(Q),Q.geometry.dispose(),Q.material.dispose()}w&&w.dispose(),E&&E.dispose()}}}}static async loadGeoJSON(t){const{url:r,height:s,featureToColor:i}=t;return Re(r,sr,{worker:!1,gis:{format:"binary"}}).then(n=>{const A=n,o=new Do,a=A.polygons.positions.value.reduce((h,u,g,l)=>{if(g%2==0){const B=[u,l[g+1],s??0],d=J.WGS84.cartographicToCartesian(B);h.push(...d)}return h},[]);if(o.setAttribute("position",new Or(a,3)),i){const h=A.polygons.numericProps[i.feature].value.reduce((u,g,l,B)=>{const d=i.colorMap(g);return u[l*3]=d.r,u[l*3+1]=d.g,u[l*3+2]=d.b,u},[]);o.setAttribute("color",new Or(h,3))}o.setIndex(new Ro(A.polygons.triangles.value,1));const c=new si({transparent:!0,vertexColors:!0,opacity:.5,blending:_i});return new ii(o,c)})}}async function bp(e,t,r,s,i){return new Promise((n,A)=>{const o=new it().makeRotationAxis(new W(1,0,0),Math.PI/2),a=t.content.gltfUpAxis!=="Z",c=new it().fromArray(t.computedTransform).premultiply(i);a&&c.multiply(o),t.content.byteLength||(t.content.byteLength=t.content.gltfArrayBuffer.byteLength),e.parse(t.content.gltfArrayBuffer,t.contentUrl?t.contentUrl.substr(0,t.contentUrl.lastIndexOf("/")+1):null,h=>{t.userData.asset=h.asset;const u=h.scenes[0];u.applyMatrix4(c),t.content.texturesByteLength=0,t.content.geometriesByteLength=0,u.traverse(g=>{if(g.type=="Mesh"){const l=g;t.content.geometriesByteLength+=Gc(l.geometry);const B=l.material,d=B.map;if(d){const C=hp(d);C&&(t.content.texturesByteLength+=C)}s.material?(l.material=s.material.clone(),B.dispose()):s.shading==Zr.FlatTexture&&l.material.type!=="MeshBasicMaterial"&&(l.material=r.clone(),B.dispose()),s.shading!=Zr.ShadedNoTexture?l.material.type=="ShaderMaterial"?l.material.uniforms.map={value:d}:l.material.map=d:(d&&d.dispose(),l.material.map=null),l.material.wireframe=s.wireframe,s.contentPostProcess&&s.contentPostProcess(l)}}),t.content.gpuMemoryUsageInBytes=t.content.texturesByteLength+t.content.geometriesByteLength,n(u)},h=>{A(new Error(`error parsing gltf in tile ${t.id}: ${h}`))})})}function Dp(e,t,r,s){const i={rtc_center:e.content.rtcCenter,points:e.content.attributes.positions,intensities:e.content.attributes.intensity,classifications:e.content.attributes.classification,rgb:null,rgba:null},{colors:n}=e.content.attributes;n&&n.size===3&&(i.rgb=n.value),n&&n.size===4&&(i.rgba=n.value);const A=new Do;A.setAttribute("position",new Or(i.points,3));const o=new it().fromArray(e.computedTransform).premultiply(s);i.rgba?A.setAttribute("color",new Or(i.rgba,4)):i.rgb&&A.setAttribute("color",new In(i.rgb,3,!0)),i.intensities&&A.setAttribute("intensity",new Ro(i.intensities,1,!0)),i.classifications&&A.setAttribute("classification",new In(i.classifications,1,!1)),e.content.geometriesByteLength=Gc(A),e.content.gpuMemoryUsageInBytes=e.content.geometriesByteLength;const a=new dh(A,r.material||t);if(i.rtc_center){const c=i.rtc_center;o.multiply(new it().makeTranslation(c[0],c[1],c[2]))}return a.applyMatrix4(o),r.contentPostProcess&&r.contentPostProcess(a),a}function Io(e){var t,r,s,i;(t=e==null?void 0:e.uniforms)!=null&&t.map?(s=(r=e==null?void 0:e.uniforms)==null?void 0:r.map.value)==null||s.dispose():e.map&&((i=e.map)==null||i.dispose()),e.dispose()}function ri(e){e.traverse(t=>{if(t.isMesh)if(t.geometry.dispose(),t.material.isMaterial)Io(t.material);else for(const r of t.material)Io(r)});for(let t=e.children.length-1;t>=0;t--){const r=e.children[t];e.remove(r)}}function Rp(e,t){return!e.matrixWorld.equals(t)}function Sp(e){const t=new Map;return e.forEach(r=>{var s,i;const n=(i=(s=r==null?void 0:r.userData)==null?void 0:s.asset)==null?void 0:i.copyright;n&&n.split(/;/g).map(A=>A.trim()).forEach(A=>{A&&t.set(A,(t.get(A)||0)+1)})}),Array.from(t).sort((r,s)=>s[1]-r[1]).map(([r])=>r).join("; ")}const zt=Eh(Ih,Ch);zt.scale.setScalar(1e3);const Tp=zt.geo2world(new W(108,34,0)),_p=zt.geo2world(new W(108,30,1e3)),Dt=new Th("#map",{centerPostion:Tp,cameraPosition:_p});Dt.scene.add(zt);let Si;Dt.addEventListener("update",e=>{Si&&Si.update(e.delta,Dt.camera)});async function Mp(){const e=await wp.load({url:"https://assets.ion.cesium.com/69380/tileset.json",viewport:{width:Dt.width,height:Dt.height,devicePixelRatio:window.devicePixelRatio},options:{cesiumIONToken:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI3NjEwMjA4Ni00YmVkLTQyMjgtYjRmZS1lY2M3ZWFiMmFmNTYiLCJpZCI6MjYxMzMsImlhdCI6MTY3NTM2ODY4NX0.chGkGL6DkDNv5wYJQDMzWIvi9iDoVa27dgng_5ARDmo",dracoDecoderPath:"../lib/draco",resetTransform:!0,memoryAdjustedScreenSpaceError:!0,pointCloudColoring:hn.RGB}}),{model:t,runtime:r}=e;Si=r;const s=r.getTileset(),i=s.cartographicCenter[0],n=s.cartographicCenter[1],A=s.cartographicCenter[2],o=zt.geo2world(new W(i,n,0));t.position.copy(o),t.position.setY(200),t.scale.setScalar(1.3),t.rotation.set(-Math.PI/2,0,0),Dt.scene.add(t),Dt.scene.add(r.getTileBoxes());const a=new W(o.x-400,250,o.z-200);Dt.camera.position.copy(a),Dt.controls.target.copy(o),console.log(i,n,A);const c=document.getElementById("model-loading");c&&(c.style.display="none")}Mp();mh(zt);ph(zt);yh(Dt,zt);Qh(zt);wh(Dt);bh(Dt);
